(this.webpackJsonp=this.webpackJsonp||[]).push([[0],{211:function(e,t,n){"use strict";n.d(t,"a",(function(){return qt}));var r=n(5),a=n.n(r),o=n(48),i=n(213),l=n(0),c=n.n(l),s=n(318),u=n(2),m=n.n(u),d=n(3),p=n.n(d),f=n(308),h=n(315),y=n(148);function g(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function b(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?g(Object(n),!0).forEach((function(t){m()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):g(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var E=n(99);function v(){return Object(E.a)()}var x=n(40),w=n.n(x),O=n(25),S=n(313),j=n(309),P=n(310),C=n(121),T=n(314),k=n(109),z=n(18),B=n(8),L="web"===B.a.OS?function(){}:n(109).PlatformColor,_={light:"ios"===B.a.OS?I():{tint:"orange",secondaryTint:"purple",text:"#111",secondaryText:"#333",placeholderText:"#444",background:"#fff",secondaryBackground:"#eee",tertiaryBackground:"#ccc",tabIconDefault:"#ccc",tabIconSelected:"orange",red:"red",orange:"orange",yellow:"yellow",green:"green",teal:"eeal",blue:"blue",indigo:"indigo",purple:"purple"},dark:"ios"===B.a.OS?I():{tint:"orange",secondaryTint:"purple",text:"#fff",secondaryText:"#666",placeholderText:"#aaa",background:"#111",secondaryBackground:"#222",tertiaryBackground:"#222",tabIconDefault:"#ccc",tabIconSelected:"orange",red:"red",orange:"orange",yellow:"yellow",green:"green",teal:"eeal",blue:"#68f",indigo:"indigo",purple:"purple"}};function I(){return{tint:L("systemOrange"),secondaryTint:L("systemPurple"),text:L("label"),secondaryText:L("secondaryLabel"),placeholderText:L("placeholderText"),background:L("systemBackground"),secondaryBackground:L("secondarySystemBackground"),tertiaryBackground:L("tertiarySystemBackground"),tabIconDefault:L("secondaryLabel"),tabIconSelected:L("systemOrange"),red:L("systemRed"),orange:L("systemOrange"),yellow:L("systemYellow"),green:L("systemGreen"),teal:L("systemTeal"),blue:L("systemBlue"),indigo:L("systemIndigo"),purple:L("systemPurple")}}var H=n(125),R={prefixes:[H.a("/")],config:{screens:{Root:{screens:{TabOne:{screens:{TabOneScreen:"one"}},TabTwo:{screens:{TabTwoScreen:"two"}}}},Modal:"modal",NotFound:"*"}}},D=n(1),V=n(45),W=n(37),N=n(201),F=n(11),U=n.n(F),M=n(23),G=n(4),A=n(47);function $(){var e=v();return _[e]}var J=["style","lightColor","darkColor"],q=["style","lightColor","darkColor"],K=["style","placeholderTextColor"];function Y(e,t){var n=v(),r=e[n];return r||_[n][t]}function Q(e){var t=e.style,n=e.lightColor,r=e.darkColor,a=U()(e,J),o=Y({light:n,dark:r},"text");return l.createElement(M.a,w()({style:[{color:o},t]},a))}function X(e){var t=e.style,n=e.lightColor,r=e.darkColor,a=U()(e,q),o=Y({light:n,dark:r},"background");return l.createElement(G.a,w()({style:[{backgroundColor:o},t]},a))}function Z(e){var t=e.style,n=e.placeholderTextColor,r=U()(e,K),a=$(),o={backgroundColor:a.secondaryBackground,paddingHorizontal:10,paddingVertical:5,borderRadius:8,color:a.text};return l.createElement(A.a,w()({style:[o,t],placeholderTextColor:n||a.placeholderText},r))}function ee(e){return Object(l.useMemo)((function(){return function(e){var t=Math.round((Date.now()-Date.parse(e))/1e3),n=Math.round(t/60),r=Math.round(n/60),a=Math.round(r/24),o=Math.round(a/7);return n<60&&n+"m"||r<24&&r+"h"||a<7&&a+"d"||o+"w"}(e)}),[e])}function te(e){var t=ee(e.time);return c.a.createElement(Q,{style:ne.root},c.a.createElement(N.a,{name:"time-outline",size:14})," ",t)}var ne=D.a.create({root:{}}),re=n(33),ae=n(142),oe=n(89);function ie(e){return p.a.async((function(t){for(;;)switch(t.prev=t.next){case 0:if("web"!==B.a.OS){t.next=2;break}return t.abrupt("return");case 2:return t.next=4,p.a.awrap(ae.a(e));case 4:case"end":return t.stop()}}),null,null,null,Promise)}var le={apiUrl:"https://hoot.goldandblack.xyz/api/unstable",login:void 0},ce=Object(l.createContext)({ctx:le,setContext:function(e){}});function se(e,t,n,r){return p.a.async((function(a){for(;;)switch(a.prev=a.next){case 0:return a.abrupt("return",ve({apiUrl:e},"POST","users",{username:t,password:n,email_address:r,login:!0},!0).then((function(e){return e.json()})));case 1:case"end":return a.stop()}}),null,null,null,Promise)}function ue(e,t){return p.a.async((function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",ve(e,"GET","posts/"+t,void 0,!0).then((function(e){return e.json()})));case 1:case"end":return n.stop()}}),null,null,null,Promise)}function me(e,t){return p.a.async((function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",ve(e,"GET","comments/"+t,void 0,!0).then((function(e){return e.json()})));case 1:case"end":return n.stop()}}),null,null,null,Promise)}function de(e,t,n){return p.a.async((function(r){for(;;)switch(r.prev=r.next){case 0:return r.abrupt("return",ve(e,"GET","posts/"+t+"/replies?limit=10"+(n?"&page="+n:""),void 0,!0).then((function(e){return e.json()})));case 1:case"end":return r.stop()}}),null,null,null,Promise)}function pe(e,t,n){return p.a.async((function(r){for(;;)switch(r.prev=r.next){case 0:return r.abrupt("return",ve(e,"GET","comments/"+t+"/replies?limit=10"+(n?"&page="+n:""),void 0,!0).then((function(e){return e.json()})));case 1:case"end":return r.stop()}}),null,null,null,Promise)}function fe(e){var t,n,r=arguments;return p.a.async((function(a){for(;;)switch(a.prev=a.next){case 0:return t=r.length>1&&void 0!==r[1]&&r[1],n=r.length>2?r[2]:void 0,a.abrupt("return",ve(e,"GET","communities?include_your=true&limit=100"+(t?"&your_follow.accepted=true":"")+(n?"&page="+n:"")).then((function(e){return e.json()})).then((function(e){return e})));case 3:case"end":return a.stop()}}),null,null,null,Promise)}function he(e,t){return p.a.async((function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",ve(e,"GET","communities/"+t+"?include_your=true").then((function(e){return e.json()})));case 1:case"end":return n.stop()}}),null,null,null,Promise)}function ye(e,t){return p.a.async((function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",ve(e,"GET","users/"+t,void 0,!0).then((function(e){return e.json()})));case 1:case"end":return n.stop()}}),null,null,null,Promise)}function ge(e,t){return p.a.async((function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",ve(e,"POST","communities/"+t+"/follow",{try_wait_for_accept:!0}).then((function(e){return e.json()})));case 1:case"end":return n.stop()}}),null,null,null,Promise)}function be(e,t,n){return p.a.async((function(r){for(;;)switch(r.prev=r.next){case 0:return r.abrupt("return",ve(e,"PATCH","communities/"+t,{description:n}));case 1:case"end":return r.stop()}}),null,null,null,Promise)}function Ee(e){return p.a.async((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",ve(e,"GET","instance",void 0,!0).then((function(e){return e.json()})));case 1:case"end":return t.stop()}}),null,null,null,Promise)}function ve(e,t,n,r){var a,o=arguments;return p.a.async((function(i){for(;;)switch(i.prev=i.next){case 0:if(a=o.length>4&&void 0!==o[4]&&o[4],e.apiUrl){i.next=3;break}throw"No API url";case 3:if(a||void 0!=e.login){i.next=5;break}throw"Not logged in";case 5:return i.abrupt("return",fetch(e.apiUrl+"/"+n,{method:t,headers:xe(e),body:void 0!==r?JSON.stringify(r):void 0}).then((function(e){return p.a.async((function(t){for(;;)switch(t.prev=t.next){case 0:if(!e.ok){t.next=4;break}return t.abrupt("return",e);case 4:return t.next=6,p.a.awrap(e.text());case 6:throw t.sent;case 7:case"end":return t.stop()}}),null,null,null,Promise)})).catch((function(r){throw console.error("Lotide Service Error: "+t+" "+e.apiUrl+"/"+n+"\n"+r,e),r})));case 6:case"end":return i.stop()}}),null,null,null,Promise)}function xe(e){return void 0!==e.login?{Authorization:"Bearer "+e.login.token,"Content-Type":"application/json"}:void 0}function we(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Oe(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?we(Object(n),!0).forEach((function(t){m()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):we(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function Se(e){var t=Object(l.useState)(!1),n=a()(t,2),r=n[0],o=n[1],i=$(),s=Object(l.useContext)(ce).ctx,u=null!==e.post.your_vote&&void 0!==e.post.your_vote;function m(){ie(oe.a.Light),void 0!==s.login?r?function(e,t){return p.a.async((function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",ve(e,"DELETE","posts/"+t+"/your_vote"));case 1:case"end":return n.stop()}}),null,null,null,Promise)}(s,e.post.id).then((function(){return o(!1)})):function(e,t){return p.a.async((function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",ve(e,"PUT","posts/"+t+"/your_vote"));case 1:case"end":return n.stop()}}),null,null,null,Promise)}(s,e.post.id).then((function(){return o(!0)})):re.a.alert("Login to like","Leave a like when you login to a community")}Object(l.useEffect)((function(){return o(u)}),[e.post.your_vote]);var d=i.text;r&&(d=i.red);var f=r&&!u,h=!r&&u;return c.a.createElement(z.a,{onPress:function(){return m()},hitSlop:7},c.a.createElement(X,{style:je.root},c.a.createElement(N.a,{name:r?"heart":"heart-outline",color:d,size:25}),c.a.createElement(Q,{style:Oe(Oe({},je.score),{},{color:d})},"  "+(e.post.score+ +f-+h)+"  ")))}var je=D.a.create({root:{display:"flex",flexDirection:"row",alignItems:"center"},score:{fontSize:18,minWidth:28}}),Pe=n(119),Ce=n.n(Pe),Te=n(214);function ke(e){var t=$(),n=Object(l.useMemo)((function(){return e.contentHtml||(""===(t=e.contentMarkdown)||void 0===t?void 0:t.replace(/^### (.*$)/gim,"<h3>$1</h3>").replace(/^## (.*$)/gim,"<h2>$1</h2>").replace(/^# (.*$)/gim,"<h1>$1</h1>").replace(/^\> (.*$)/gim,"<blockquote>$1</blockquote>").replace(/\*\*(.*)\*\*/gim,"<b>$1</b>").replace(/\*(.*)\*/gim,"<i>$1</i>").replace(/!\[(.*?)\]\((.*?)\)/gim,"<img alt='$1' src='$2' />").replace(/\[(.*?)\]\((.*?)\)/gim,"<a href='$2'>$1</a>").replace(/\n$/gim,"<br />").trim())||"<p>"+e.contentText+"</p>";var t}),[e.contentHtml,e.contentMarkdown,e.contentText]);return c.a.createElement(Te.a,{RootComponent:M.a,value:n.replace(/\n/g,""),renderNode:ze(t),stylesheet:{a:{color:t.secondaryTint},cite:{fontStyle:"italic"},del:{textDecorationLine:"line-through",textDecorationStyle:"solid"},dfn:{fontStyle:"italic"},ins:{textDecorationLine:"underline"},samp:{fontFamily:"ios"===B.a.OS?"Menlo":"monospace"},small:{fontSize:10}},textComponentProps:{style:{color:t.text}},onLinkLongPress:function(e){return re.a.alert("Link",e)}})}var ze=function(e){return function(t,n,r,a,o){if(["iframe","script"].includes(t.name||""))return null;function i(){return o(t.children,a)}switch(t.name){case"abbr":return c.a.createElement(z.a,{key:n,onPress:function(){return re.a.alert("Abbr.",t.attribs.title)}},c.a.createElement(M.a,{style:{textDecorationLine:"underline",textDecorationStyle:"dotted"}},i()));case"blockquote":return c.a.createElement(M.a,{key:n},c.a.createElement(G.a,{style:{padding:10}},c.a.createElement(G.a,{style:{borderLeftWidth:2,borderColor:e.secondaryText,paddingLeft:10,paddingVertical:5}},i())),"\n");case"details":return c.a.createElement(Be,{key:n},i());case"dl":case"dt":case"dd":return c.a.createElement(M.a,{key:n},i(),"\n");case"figure":return c.a.createElement(G.a,{key:n},i());case"hr":return c.a.createElement(G.a,{key:n,style:{width:200,alignSelf:"stretch",borderBottomWidth:D.a.hairlineWidth||1,borderColor:e.secondaryText}});case"kbd":return c.a.createElement(M.a,{key:n,style:{backgroundColor:e.tertiaryBackground}}," ",i()," ");case"img":return c.a.createElement(M.a,{key:n},"[Image not displayed]");case"li":return c.a.createElement(M.a,{key:n},"\u2022 ",i(),"\n");case"sub":return c.a.createElement(M.a,{key:n,style:{fontSize:10}},i());case"summary":return c.a.createElement(M.a,{key:n},i());case"sup":return c.a.createElement(G.a,{key:n},c.a.createElement(M.a,{style:{fontSize:10}},i()));default:return}}};function Be(e){var t=e.children,n=Object(l.useState)(!1),r=a()(n,2),o=r[0],i=r[1],s=$(),u=t.filter((function(e){return""!==e.props.children.toString().trim()})),m=Ce()(u),d=m[0],p=m.slice(1);return c.a.createElement(G.a,null,c.a.createElement(z.a,{hitSlop:5,onPress:function(){return i((function(e){return!e}))}},c.a.createElement(M.a,{style:{color:s.secondaryTint}},o?c.a.createElement(O.a,{name:"chevron-down-outline"}):c.a.createElement(O.a,{name:"chevron-forward-outline"}),d)),o&&p)}function Le(e){var t=$(),n=e.colorize||"never",r=e.showHost||"only_foreign",a=function(e,t){return"always"===e||"never"!==e&&!t},o=a(n,e.local),i=a(r,e.local),l=o?{color:e.local?t.blue:t.green}:{};return c.a.createElement(Q,{style:[_e.root,e.style]},c.a.createElement(Q,{style:[_e.name,l,e.styleName]},e.name),i&&c.a.createElement(Q,{style:[_e.host,{color:t.secondaryText},e.styleHost]},e.newLine&&"\n",!e.newLine&&"@",e.host))}var _e=D.a.create({root:{},name:{fontWeight:"500"},host:{fontWeight:"200"}});function Ie(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function He(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Ie(Object(n),!0).forEach((function(t){m()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Ie(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function Re(e){var t=Object(l.useState)(1),n=a()(t,2),r=n[0],o=n[1],i=Object(l.useMemo)((function(){return!!(t=e.post.href)&&[".png",".jpg",".jpeg",".bmp",".gif",".webp"].some((function(e){return t.endsWith(e)}));var t}),[e.post.href]),s=$(),u=e.post;return c.a.createElement(X,null,c.a.createElement(Q,{style:De.title},e.post.sticky&&c.a.createElement(c.a.Fragment,null,c.a.createElement(O.a,{name:"pin",size:25,color:s.secondaryTint})," "),e.post.title),e.post.href&&(i?c.a.createElement(W.a,{style:He(He({},De.image),{},{aspectRatio:r,backgroundColor:s.secondaryBackground}),source:{uri:e.post.href},onLoad:function(e){return o(Math.max(e.nativeEvent.source.width/e.nativeEvent.source.height,.5))}}):c.a.createElement(z.a,{style:[De.link,{backgroundColor:s.secondaryBackground}],onPress:function(){ie(oe.a.Medium),e.post.href&&Object(H.b)(e.post.href)}},c.a.createElement(Q,null,e.post.href))),e.showHtmlContent&&!!e.post.content_html&&c.a.createElement(X,{style:{paddingHorizontal:15}},c.a.createElement(ke,{contentHtml:e.post.content_html,contentText:e.post.content_text})),c.a.createElement(X,{style:De.foot},c.a.createElement(X,null,c.a.createElement(z.a,{hitSlop:8,onPress:function(){return e.navigation.navigate("Community",{community:e.post.community})}},c.a.createElement(Le,{name:u.community.name,host:u.community.host,local:u.community.local,showHost:"only_foreign",colorize:"never",newLine:!0})),c.a.createElement(Q,{style:De.by},"by ",e.post.author.username),e.showCommunityHost&&c.a.createElement(Q,{style:De.by},"on ",e.post.community.host)),c.a.createElement(X,null,c.a.createElement(te,{time:e.post.created})),c.a.createElement(X,null,c.a.createElement(Q,{style:De.footText},c.a.createElement(O.a,{name:"chatbubble-outline",size:12})," ",e.post.replies_count_total)),c.a.createElement(X,null,c.a.createElement(Se,{post:e.post,isUpvoted:!1}))))}var De=D.a.create({item:{marginVertical:0,marginHorizontal:0},title:{fontSize:20,padding:15},contentText:{fontSize:12},link:{paddingVertical:10,paddingHorizontal:15,borderRadius:5,marginHorizontal:15},image:{width:"100%",height:void 0,resizeMode:"contain"},foot:{display:"flex",flexDirection:"row",justifyContent:"space-between",alignItems:"center",width:"100%",padding:15},footText:{},by:{fontSize:11},score:{fontSize:18},actions:{display:"flex",flexDirection:"row",justifyContent:"space-around",alignItems:"center",padding:10}});var Ve=n(16),We=n.n(Ve);function Ne(e,t,n){var r=Object(l.useState)([]),o=a()(r,2),i=o[0],c=o[1],s=Object(l.useState)(null),u=a()(s,2),m=u[0],d=u[1],f=Object(l.useState)(null),h=a()(f,2),y=h[0],g=h[1],b=Object(l.useState)(void 0),E=a()(b,2),v=E[0],x=E[1],w=Object(l.useState)(0),O=a()(w,2),S=O[0],j=O[1],P=Object(l.useContext)(ce).ctx,C=function(e,t){var n=Object(l.useState)(0),r=a()(n,2),o=r[0],i=r[1],c=Object(l.useState)(!0),s=a()(c,2),u=s[0],m=s[1];return Object(l.useEffect)((function(){e((function(){return m(!1)}))}),[o].concat(We()(t))),[u,function(){i((function(e){return e+1})),m(!0)}]}((function(r){P.login&&void 0===v&&(x(m),function(e,t){var n,r,a,o,i=arguments;return p.a.async((function(l){for(;;)switch(l.prev=l.next){case 0:return n=i.length>2&&void 0!==i[2]?i[2]:"hot",r=i.length>3?i[3]:void 0,a=i.length>4?i[4]:void 0,o=[null===t?"posts?sort="+n:"posts?page="+t+"&sort="+n,"include_your=true",void 0!==r&&"in_your_follows="+r,a&&"community="+a].filter((function(e){return e})).join("&"),l.abrupt("return",ve(e,"GET",o).then((function(e){return e.json()})));case 5:case"end":return l.stop()}}),null,null,null,Promise)}(P,m,e,t,n).then((function(e){c((function(t){return[].concat(We()(t),We()(e.items))})),g(e.next_page),x(void 0)})).then((function(){return r()})).catch((function(e){r(),c((function(t){return[].concat(We()(t),[{id:-1,title:"Lotide error",content_html:"<p>Error: "+e+"</p>",created:"",replies_count_total:0,score:0,sticky:!0,author:{id:-1,username:"Failure",local:!1,host:"hoot-mobile"},community:{id:-1,name:"something-went-wrong",local:!1,host:"hoot-mobile"}}])}))})))}),[S,m]),T=a()(C,2),k=T[0],z=T[1];return Object(l.useEffect)((function(){c([]),d(null),g(null),z()}),[P,e]),[i,k,function(){c([]),d(null),g(null),j((function(e){return e+1})),z()},function(){null!==y&&d(y)}]}var Fe=n(41),Ue=[{name:"Gold&Black",domain:"hoot.goldandblack.xyz"},{name:"Tide C",domain:"c.tide.tk"},{name:"Narwhal City",domain:"dev.narwhal.city"},{name:"Exopla",domain:"lotide.exopla.net.eu.org"},{name:"Tide B",domain:"b.tide.tk"},{name:"Tide A",domain:"a.tide.tk"}],Me=function(){return p.a.async((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",o.a.getItem("@lotide_ctx").then((function(e){return null!==e?JSON.parse(e):void 0})));case 1:case"end":return e.stop()}}),null,null,null,Promise)},Ge=function(e){var t;return p.a.async((function(n){for(;;)switch(n.prev=n.next){case 0:if(e.login){n.next=2;break}return n.abrupt("return");case 2:t=e.login.user.username+"@"+e.apiUrl,Ke.store("@lotide_ctx_arr",t,e);case 4:case"end":return n.stop()}}),null,null,null,Promise)},Ae=function(e){return p.a.async((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",Ke.query("@lotide_ctx_arr",e));case 1:case"end":return t.stop()}}),null,null,null,Promise)},$e=function(){return p.a.async((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",Ke.listKeys("@lotide_ctx_arr"));case 1:case"end":return e.stop()}}),null,null,null,Promise)},Je=function(e){return p.a.async((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",Ke.remove("@lotide_ctx_arr",e));case 1:case"end":return t.stop()}}),null,null,null,Promise)},qe=function(){var e;return p.a.async((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,p.a.awrap(o.a.getItem("@lotide_ctx_arr"));case 2:return e=t.sent,t.abrupt("return",e?JSON.parse(e):{});case 4:case"end":return t.stop()}}),null,null,null,Promise)},Ke={store:function(e,t,n){var r,a;return p.a.async((function(i){for(;;)switch(i.prev=i.next){case 0:return i.next=2,p.a.awrap(o.a.getItem(e));case 2:return r=i.sent,a=r?JSON.parse(r):{},a[t]=n,i.next=7,p.a.awrap(o.a.setItem(e,JSON.stringify(a)));case 7:case"end":return i.stop()}}),null,null,null,Promise)},query:function(e,t){var n;return p.a.async((function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,p.a.awrap(o.a.getItem(e));case 2:return n=r.sent,r.abrupt("return",n?JSON.parse(n)[t]:void 0);case 4:case"end":return r.stop()}}),null,null,null,Promise)},listKeys:function(e){var t,n;return p.a.async((function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,p.a.awrap(o.a.getItem(e));case 2:return t=r.sent,n=t?JSON.parse(t):{},r.abrupt("return",Object.keys(n));case 5:case"end":return r.stop()}}),null,null,null,Promise)},remove:function(e,t){var n,r,a;return p.a.async((function(i){for(;;)switch(i.prev=i.next){case 0:return i.next=2,p.a.awrap(o.a.getItem(e));case 2:return n=i.sent,r=n?JSON.parse(n):{},a=r[t],delete r[t],i.next=8,p.a.awrap(o.a.setItem(e,JSON.stringify(r)));case 8:return i.abrupt("return",a);case 9:case"end":return i.stop()}}),null,null,null,Promise)}};function Ye(e){var t=Object(l.useState)(""),n=a()(t,2),r=n[0],o=n[1],i=Object(l.useState)(Ue),s=a()(i,2),u=s[0],m=s[1],d=Object(l.useState)([]),p=a()(d,2),f=p[0],h=p[1],y=$(),g=Object(l.useContext)(ce);Object(l.useEffect)((function(){Ue.map((function(e,t){return Ee({apiUrl:"https://"+e.domain+"/api/unstable"}).then((function(e){m((function(n){return n.map((function(n,r){return t!==r?n:{name:n.name,domain:n.domain,instanceInfo:e}}))}))})).catch((function(){m((function(e){return e.map((function(e,n){return t!==n?e:{name:e.name,domain:e.domain,instanceInfo:null}}))}))}))}))}),[]),Object(l.useEffect)((function(){qe().then((function(e){return Object.entries(e)})).then(h)}),[]);return c.a.createElement(Fe.a,{style:Qe.root},c.a.createElement(Q,{style:Qe.title},"Login to continue"),f.length>0&&c.a.createElement(Q,{style:Qe.subtitle},"Select an existing profile"),f.map((function(e){var t=e[0].split("@"),n=a()(t,2),r=n[0],o=n[1];return c.a.createElement(z.a,{key:e[0],onPress:function(){g.setContext(e[1])}},c.a.createElement(Le,{name:r,host:o.replace("http://","").replace("https://","").split(/[/?#]/)[0],local:!0,showHost:"always",newLine:!0,style:{paddingVertical:5,paddingBottom:10}}))})),c.a.createElement(Q,{style:Qe.subtitle},f.length>0?"Or sign into a new acount":"Enter a host or select one below"),c.a.createElement(Z,{placeholder:"Host domain",style:{paddingVertical:10,paddingHorizontal:10},value:r,onChangeText:o,onSubmitEditing:function(){return e.onSelect(r.toLowerCase())},keyboardType:"url",returnKeyType:"next"}),u.filter((function(e){return""===r||e.domain.includes(r.toLowerCase())||e.name.toLowerCase().includes(r.toLowerCase())})).map((function(t){return c.a.createElement(X,{key:t.domain},function(t){var n,r=t.item,a="0.9.0-pre"===(null==(n=r.instanceInfo)?void 0:n.software.version),o=a?y.text:y.secondaryText;return c.a.createElement(X,{style:{borderBottomWidth:1,borderColor:y.secondaryBackground,paddingVertical:10}},c.a.createElement(z.a,{onPress:function(){return a&&e.onSelect(r.domain,r.name)}},c.a.createElement(Le,{name:r.name,host:r.domain,local:!1,newLine:!0,style:{borderBottomWidth:1,borderBottomColor:"#fff"},styleName:{fontSize:24,fontWeight:"300",fontFamily:"ios"===B.a.OS?"Georgia":"serif",color:o}}),r.instanceInfo?c.a.createElement(c.a.Fragment,null,c.a.createElement(Q,{style:{color:y.secondaryText}},r.instanceInfo.software.version,!a&&" - Out of date"),!!r.instanceInfo.description&&c.a.createElement(Q,{style:{color:o}},r.instanceInfo.description)):null===r.instanceInfo?c.a.createElement(Q,{style:{color:o}},"Failed to load info"):c.a.createElement(Q,{style:{color:o}},"Loading...")))}({item:t}))})))}var Qe=D.a.create({root:{flex:1,padding:20},title:{fontSize:24,marginBottom:10},subtitle:{fontWeight:"300",marginBottom:10}}),Xe=n(30),Ze=n(39),et=n(54);function tt(e){var t=Object(l.useState)(!1),n=a()(t,2),r=n[0],o=n[1],i=Object(l.useState)(""),s=a()(i,2),u=s[0],m=s[1],d=Object(l.useState)(""),f=a()(d,2),h=f[0],y=f[1],g=$(),b=Object(l.useContext)(ce);function E(){(function(e,t,n){return p.a.async((function(r){for(;;)switch(r.prev=r.next){case 0:return r.abrupt("return",ve({apiUrl:e},"POST","logins",{username:t,password:n},!0).then((function(e){return e.json()})));case 1:case"end":return r.stop()}}),null,null,null,Promise)})("https://"+e.domain+"/api/unstable",u,h).then((function(t){b.setContext({apiUrl:"https://"+e.domain+"/api/unstable",login:t})})).catch((function(e){re.a.alert("Failed to login",e),console.error(e)}))}return c.a.createElement(z.a,{style:{flex:1},onPress:function(){return"web"!==B.a.OS&&Ze.a.dismiss()}},c.a.createElement(et.a,{style:nt.root,behavior:"padding"},e.hostName?c.a.createElement(z.a,{style:{alignItems:"center"}},c.a.createElement(Q,{style:nt.name},e.hostName),c.a.createElement(Q,{style:[nt.domain,{color:g.secondaryText}]},e.domain)):c.a.createElement(z.a,null,c.a.createElement(Q,{style:{fontSize:24}},e.domain)),c.a.createElement(z.a,{hitSlop:5,onPress:function(){return o((function(e){return!e}))}},c.a.createElement(Q,{style:[nt.loginRegister,{color:g.secondaryText}]},c.a.createElement(Q,{style:{color:r?g.secondaryText:g.secondaryTint}},"Login")," | ",c.a.createElement(Q,{style:{color:r?g.secondaryTint:g.secondaryText}},"Register"))),c.a.createElement(Z,{style:nt.input,placeholder:"Username",value:u,onChangeText:m}),c.a.createElement(Z,{style:nt.input,placeholder:"Password",value:h,onChangeText:y,secureTextEntry:!0}),c.a.createElement(X,{style:nt.actionButtons},c.a.createElement(Xe.a,{title:"Change Host",onPress:e.onGoBack,color:g.secondaryTint}),c.a.createElement(Xe.a,{title:r?"Register":"Login",onPress:function(){r?se("https://"+e.domain+"/api/unstable",u,h).then((function(t){b.setContext({apiUrl:"https://"+e.domain+"/api/unstable",login:t})})).catch((function(e){re.a.alert("Failed to register",e),console.error(e)})):E()},color:g.tint}))))}var nt=D.a.create({root:{flex:1,alignItems:"center",justifyContent:"center",padding:35},name:{fontSize:50,fontFamily:"ios"===B.a.OS?"Georgia":"serif"},domain:{fontWeight:"300"},loginRegister:{padding:15},input:{width:"100%",marginVertical:5,paddingHorizontal:20,paddingVertical:10},actionButtons:{width:"100%",display:"flex",flexDirection:"row",justifyContent:"space-around"}});function rt(){var e=Object(l.useState)(),t=a()(e,2),n=t[0],r=t[1],o=Object(l.useState)(),i=a()(o,2),s=i[0],u=i[1];return c.a.createElement(X,{style:at.root},s?c.a.createElement(tt,{hostName:n,domain:s,onGoBack:function(){return u(void 0)}}):c.a.createElement(Ye,{onSelect:function(e,t){r(t),u(e)}}))}var at=D.a.create({root:{width:"100%",height:"100%"},container:{flex:1,alignItems:"center",justifyContent:"center"},input:{width:"100%",marginBottom:20,paddingHorizontal:20,paddingVertical:10},actionButtons:{display:"flex",flexDirection:"row",justifyContent:"space-around",width:"100%"}});function ot(e){var t=e.navigation,n=e.route.params.sort,r=Object(l.useContext)(ce).ctx,o=Ne(n,!0),i=a()(o,4),s=i[0],u=i[1],m=i[2],d=i[3];if(!function(e){return!!e.apiUrl&&!!e.login}(r))return c.a.createElement(rt,null);console.log(r);return c.a.createElement(X,{style:it.container},c.a.createElement(V.a,{data:s,renderItem:function(e){var n=e.item;return c.a.createElement(lt,{post:n,navigation:t})},keyExtractor:function(e,t){return e.id+"-"+t},refreshing:u,onRefresh:m,onEndReachedThreshold:2,onEndReached:d}))}var it=D.a.create({container:{flex:1},item:{marginVertical:0,marginHorizontal:0,borderBottomWidth:8},title:{fontSize:20,padding:15,color:"#eee"},contentText:{fontSize:12},link:{paddingVertical:10,paddingHorizontal:15,backgroundColor:"#8884",borderRadius:5,marginHorizontal:15},image:{width:"100%",height:void 0,resizeMode:"contain"},foot:{display:"flex",flexDirection:"row",justifyContent:"space-between",alignItems:"center",width:"100%",padding:15},footText:{color:"#ccc"},by:{fontSize:11},score:{fontSize:18,color:"#bbb"}}),lt=function(e){var t=e.post,n=e.navigation,r=$();return c.a.createElement(z.a,{onPress:function(){return n.navigate("Post",{post:t})},onLongPress:function(){ie(oe.a.Heavy),console.log(t)}},c.a.createElement(X,{style:[it.item,{borderBottomColor:r.secondaryBackground}]},c.a.createElement(Re,{post:t,navigation:n})))};function ct(e){var t,n=Object(l.useState)(),r=a()(n,2),o=r[0],i=r[1],s=Object(l.useState)(""),u=a()(s,2),m=u[0],d=u[1],p=Object(l.useContext)(ce).ctx,f=$(),h=e.onlyWhenTyping&&""===m?[]:o?""===m?o.items:o.items.filter((function(e){return e.name.toLowerCase().includes(m.toLowerCase())||e.host.includes(m.toLowerCase())})):[];Object(l.useEffect)((function(){fe(p,!1).then(i)}),[null==(t=p.login)?void 0:t.token]);return c.a.createElement(X,null,c.a.createElement(Z,{placeholder:e.placeholder||"Filter communities",value:m,onChangeText:d,style:st.input}),c.a.createElement(V.a,{data:h,renderItem:function(t){var n,r=t.item;return c.a.createElement(z.a,{onPress:function(){return e.onSelect(r)},style:[st.item,{borderColor:f.secondaryBackground}]},c.a.createElement(Le,{name:r.name,host:r.host,local:r.local,colorize:"always",newLine:!0}),c.a.createElement(X,{style:{display:"flex",flexDirection:"row"}},r.you_are_moderator&&c.a.createElement(O.a,{name:"shield-outline",size:20,color:f.secondaryTint}),(null==(n=r.your_follow)?void 0:n.accepted)&&c.a.createElement(O.a,{name:"checkmark",size:20,color:f.secondaryTint,style:{marginLeft:5}})))},keyExtractor:function(e,t){return e.id+"-"+t},contentContainerStyle:st.list}))}var st=D.a.create({root:{flex:1,alignItems:"center",justifyContent:"center"},input:{paddingVertical:10,marginHorizontal:20,marginTop:20},list:{padding:20,paddingBottom:100},item:{display:"flex",flexDirection:"row",justifyContent:"space-between",alignItems:"center",height:50,borderBottomWidth:1,paddingHorizontal:20}});function ut(e){var t=e.navigation;return Object(l.useContext)(ce).ctx.login?c.a.createElement(ct,{onSelect:function(e){return t.navigate("Community",{community:e})}}):c.a.createElement(rt,null)}function mt(e){var t,n,r,o=e.navigation,i=Object(l.useState)(),s=a()(i,2),u=s[0],m=s[1],d=Object(l.useState)([]),f=a()(d,2),h=f[0],y=f[1],g=Object(l.useState)([]),b=a()(g,2),E=b[0],v=b[1],x=Object(l.useState)(!1),w=a()(x,2),S=w[0],j=w[1],P=$(),C=Object(l.useContext)(ce),T=C.ctx;if(Object(l.useEffect)((function(){T.login&&fe(T,!0).then((function(e){return v(e.items)}))}),[null==(t=T.login)?void 0:t.user.id]),Object(l.useEffect)((function(){var e;void 0!==T.login&&void 0!==T.login.user&&ye(T,(null==(e=T.login)?void 0:e.user.id)||0).then(m)}),[null==(n=T.login)?void 0:n.token]),Object(l.useEffect)((function(){$e().then((function(e){return y(e)}))}),[T]),void 0===T.login)return c.a.createElement(rt,null);return c.a.createElement(Fe.a,{style:[dt.container,{backgroundColor:P.background}]},c.a.createElement(X,{style:dt.header},c.a.createElement(X,null,c.a.createElement(z.a,{hitSlop:10,onPress:function(){return j((function(e){return!e}))}},c.a.createElement(Q,{style:dt.title},null==u?void 0:u.username,"  ",c.a.createElement(O.a,{name:"pencil-outline",size:20,color:P.secondaryText}))),c.a.createElement(Q,{style:{color:P.secondaryText}},null==u?void 0:u.host),!(null==u||!u.avatar)&&c.a.createElement(Q,null,null==u||null==(r=u.avatar)?void 0:r.url),!(null==u||!u.description)&&c.a.createElement(Q,null,null==u?void 0:u.description)),c.a.createElement(Xe.a,{onPress:function(){re.a.alert("Log out","Would you like to keep the login profile handy for later?",[{text:"Remove",onPress:function(){var e;Je((null==(e=T.login)?void 0:e.user.username)+"@"+T.apiUrl).then((function(){return function(e){return p.a.async((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",ve(e,"DELETE","logins/~current"));case 1:case"end":return t.stop()}}),null,null,null,Promise)}(T)})).then((function(){return C.setContext({})}))}},{text:"Keep",style:"default",onPress:function(){C.setContext({})}}])},title:"Log Out",color:P.secondaryTint,accessibilityLabel:"Log out of the Hoot network"})),S&&c.a.createElement(X,{style:dt.editView},c.a.createElement(Z,{style:dt.editViewText,placeholder:"New email"}),c.a.createElement(Z,{style:dt.editViewText,placeholder:"User bio",multiline:!0}),c.a.createElement(Z,{style:dt.editViewText,placeholder:"New password"}),c.a.createElement(Z,{style:dt.editViewText,placeholder:"Confirm new password"}),c.a.createElement(X,{style:dt.editViewActionButtons},c.a.createElement(Xe.a,{onPress:function(){return j(!1)},title:"Cancel",color:P.secondaryTint,accessibilityLabel:"Add profile"}),c.a.createElement(Xe.a,{onPress:function(){return re.a.alert("unimplemented")},title:"Submit",color:P.tint,accessibilityLabel:"Add profile"}))),c.a.createElement(Xe.a,{onPress:function(){return C.setContext({})},title:"Add Profile",color:P.tint,accessibilityLabel:"Add profile"}),h.map((function(e){return[e].concat(We()(e.split("@")))})).map((function(e){return[e[0],e[1],e[2].replace("http://","").replace("https://","").split(/[/?#]/)[0]]})).map((function(e){return c.a.createElement(z.a,{key:e[0],style:[dt.altProfileButton,{borderColor:P.secondaryBackground}],onPress:function(){Ae(e[0]).then((function(e){void 0!==e&&(C.setContext(e),j(!1))}))}},c.a.createElement(Le,{name:e[1],host:e[2],local:!0,showHost:"always",colorize:"never",newLine:!0}))})),c.a.createElement(X,{style:{paddingTop:10}},c.a.createElement(Xe.a,{onPress:function(){return o.navigate("NewCommunity")},title:"Create Community",color:P.tint,accessibilityLabel:"Create a new community"})),c.a.createElement(Q,{style:dt.followingTitle},"Communities You Follow:"),E.map((function(e){return c.a.createElement(X,{key:e.id,style:[dt.altProfileButton,{borderColor:P.secondaryBackground}]},c.a.createElement(Le,{name:e.name,host:e.host,local:e.local,showHost:"always",colorize:"always",newLine:!0}))})))}var dt=D.a.create({container:{height:"100%"},header:{display:"flex",flexDirection:"row",justifyContent:"space-between",padding:20},title:{fontSize:20,fontWeight:"bold"},followingTitle:{fontSize:18,fontWeight:"500",padding:20},editView:{margin:20},editViewText:{marginBottom:15,paddingVertical:10,paddingHorizontal:15},editViewActionButtons:{display:"flex",flexDirection:"row",justifyContent:"space-around"},separator:{marginVertical:30,height:1,width:"80%"},inputContainer:{width:"100%",padding:20},input:{height:40,borderWidth:1,paddingVertical:10,paddingHorizontal:20,width:"100%",borderRadius:8},altProfileButton:{marginHorizontal:20,paddingVertical:15,borderBottomWidth:1}}),pt=n(108);function ft(e){var t=e.navigation,n=Object(l.useState)(),r=a()(n,2),o=r[0],i=r[1],s=Object(l.useState)(""),u=a()(s,2),m=u[0],d=u[1],f=Object(l.useState)(""),h=a()(f,2),y=h[0],g=h[1],b=Object(l.useState)(""),E=a()(b,2),v=E[0],x=E[1],w=$(),O=Object(l.useContext)(ce).ctx;if(Object(l.useEffect)((function(){return t.addListener("focus",(function(){console.log(o),null===o&&i(void 0)}))}),[o,null==o?void 0:o.id]),void 0===O.login)return c.a.createElement(rt,null);if(null===o)return c.a.createElement(ct,{onSelect:i,onlyWhenTyping:!0});return c.a.createElement(et.a,{style:{width:"100%",height:"100%"}},c.a.createElement(pt.a,{onPress:function(){return"web"!==B.a.OS&&Ze.a.dismiss()}},c.a.createElement(X,{style:ht.container},c.a.createElement(z.a,{onPress:function(){return i(null)}},o?c.a.createElement(Le,{name:o.name,host:o.host,local:o.local,colorize:"always",showHost:"always",newLine:!0,style:ht.input}):c.a.createElement(Q,{style:[ht.input,{color:w.secondaryText}]},"Select a Community")),c.a.createElement(A.a,{style:[ht.input,ht.title,{color:w.text}],placeholder:"Add a Title",placeholderTextColor:w.placeholderText,value:m,onChangeText:d}),m.length>=4?c.a.createElement(c.a.Fragment,null,c.a.createElement(A.a,{style:[ht.input,{color:w.text}],placeholder:"Link",placeholderTextColor:w.placeholderText,value:y,onChangeText:g,keyboardType:"url",textContentType:"URL"}),c.a.createElement(A.a,{style:[ht.input,{color:w.text}],placeholder:"Add post content",placeholderTextColor:w.placeholderText,value:v,onChangeText:x})):c.a.createElement(Q,{style:{color:w.secondaryText}},m.length>0&&4-m.length),!!o&&(!!y||v.length>10)&&c.a.createElement(Xe.a,{onPress:function(){o&&function(e,t){return p.a.async((function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",ve(e,"POST","posts",t).then((function(e){return e.json()})));case 1:case"end":return n.stop()}}),null,null,null,Promise)}(O,{community:o.id,title:m,href:y||void 0,content_markdown:v||void 0}).then((function(e){ue(O,e.id).then((function(e){i(void 0),d(""),g(""),x(""),t.navigate("Post",{post:e})}))})).catch((function(e){return re.a.alert("Could not submit post",e)}))},title:"Submit",color:w.tint,accessibilityLabel:"Submit new post"}),v.length<11&&v.length>0&&c.a.createElement(Q,{style:{color:w.secondaryText}},11-v.length))))}var ht=D.a.create({container:{flex:1,alignItems:"flex-start",padding:15,height:"100%",width:"100%"},title:{fontSize:20,fontWeight:"bold"},separator:{marginVertical:30,height:1,width:"80%"},inputContainer:{width:"100%",padding:20},input:{paddingVertical:10,width:"100%",borderRadius:8},item:{paddingHorizontal:20,paddingVertical:10,marginHorizontal:20,marginBottom:1}});function yt(){return c.a.createElement(X,null,c.a.createElement(Q,null,"Settings screen. It'll be implemented eventually."))}function gt(e){var t=e.navigation,n=(e.route,Object(l.useState)("")),r=a()(n,2),o=r[0],i=r[1],s=Object(l.useState)(""),u=a()(s,2),m=u[0],d=u[1],p=Object(l.useState)(""),f=a()(p,2),h=f[0],y=f[1],g=Object(l.useState)(""),b=a()(g,2),E=b[0],v=b[1],x=$(),w=Object(l.useContext)(ce);return c.a.createElement(X,{style:bt.root},c.a.createElement(z.a,{style:bt.container,onPress:function(){return"web"!==B.a.OS&&Ze.a.dismiss()}},c.a.createElement(Q,{style:{fontWeight:"300",fontSize:18,marginBottom:25}},"Register a new account"),c.a.createElement(et.a,{style:{width:"100%"},behavior:"position"},c.a.createElement(X,{style:{display:"flex",flexDirection:"row",alignItems:"center",marginBottom:20}},c.a.createElement(Z,{style:[bt.input,{marginBottom:0,width:"auto",flex:1}],placeholder:"Host URL",value:m,onChangeText:d,textContentType:"URL"}),c.a.createElement(z.a,{onPress:function(){return re.a.alert("unimplemented")}},c.a.createElement(O.a,{name:"search-outline",size:25,color:x.secondaryText,style:{marginLeft:15}}))),c.a.createElement(Z,{style:bt.input,placeholder:"Username",textContentType:"username",value:o,onChangeText:i}),c.a.createElement(Z,{style:bt.input,placeholder:"Password",textContentType:"password",secureTextEntry:!0,value:h,onChangeText:y}),c.a.createElement(Z,{style:bt.input,placeholder:"Confirm Password",textContentType:"password",secureTextEntry:!0,value:E,onChangeText:v}),c.a.createElement(X,{style:bt.actionButtons},c.a.createElement(Xe.a,{onPress:function(){var e=m||"https://hoot.goldandblack.xyz/api/unstable";se(e,o,h).then((function(n){w.setContext({apiUrl:e,login:n}),t.pop()})).catch(console.error)},title:"Register",color:x.tint,accessibilityLabel:"Login to the Hoot network"})))))}var bt=D.a.create({root:{width:"100%",height:"100%",padding:20},container:{flex:1,alignItems:"center",justifyContent:"center"},input:{width:"100%",marginBottom:20,paddingHorizontal:20,paddingVertical:10},actionButtons:{display:"flex",flexDirection:"row",justifyContent:"space-around",width:"100%"}});function Et(e){var t,n=e.navigation,r=e.route,o=Object(l.useState)(r.params.community),i=a()(o,2),s=i[0],u=i[1],m=Ne("hot",void 0,s.id),d=a()(m,4),f=d[0],h=d[1],y=d[2],g=d[3],b=Object(l.useState)(0),E=a()(b,2),v=E[0],x=E[1],w=$(),O=Object(l.useContext)(ce).ctx;Object(l.useEffect)((function(){he(O,s.id).then(u)}),[r.params.community.id,v]);var S=(null==(t=s.your_follow)?void 0:t.accepted)||!1;return c.a.createElement(X,{style:[vt.root,{backgroundColor:w.background}]},c.a.createElement(X,{style:[vt.header,{borderBottomColor:w.secondaryBackground}]},c.a.createElement(X,null,c.a.createElement(Q,{style:[vt.title]},s.name),c.a.createElement(Q,{style:{color:s.local?w.blue:w.green,fontWeight:"500"}},s.host),""!==s.description&&c.a.createElement(Q,null,"\n",s.description)),S?c.a.createElement(Xe.a,{onPress:function(){(function(e,t){return p.a.async((function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",ve(e,"POST","communities/"+t+"/unfollow"));case 1:case"end":return n.stop()}}),null,null,null,Promise)})(O,s.id).then((function(){x((function(e){return e+1}))}))},title:"Unfollow",color:w.tint,accessibilityLabel:"Stop seeing posts from this community"}):c.a.createElement(Xe.a,{onPress:function(){ge(O,s.id).then((function(e){!1===e.accepted&&re.a.alert("Follow request rejected.","This could be an issue with the node you are connected to."),x((function(e){return e+1}))}))},title:"Follow",color:w.tint,accessibilityLabel:"See posts from this community in your feed"})),c.a.createElement(V.a,{data:f,renderItem:function(e){var t=e.item;return c.a.createElement(xt,{post:t,navigation:n})},keyExtractor:function(e,t){return e.id+"-"+t},refreshing:h,onRefresh:y,onEndReachedThreshold:2,onEndReached:g}))}var vt=D.a.create({root:{height:"100%"},header:{display:"flex",flexDirection:"row",justifyContent:"space-between",padding:20,borderBottomWidth:1},title:{fontSize:20},item:{marginVertical:0,marginHorizontal:0,borderBottomWidth:8}}),xt=function(e){var t=e.post,n=e.navigation,r=$();return c.a.createElement(z.a,{onPress:function(){return n.navigate("Post",{post:t})},onLongPress:function(){ie(oe.a.Heavy)}},c.a.createElement(X,{style:[vt.item,{borderBottomColor:r.secondaryBackground}]},c.a.createElement(Re,{post:t,navigation:n})))},wt=n(212);function Ot(e){var t=e.navigation,n=e.route,r=Object(l.useState)(""),o=a()(r,2),i=o[0],s=o[1],u=Object(l.useRef)(null),m=$(),d=Object(l.useContext)(ce).ctx,f=n.params.id,h=n.params.title,y=n.params.html,g=n.params.type;return c.a.createElement(et.a,{behavior:"ios"===B.a.OS?"padding":"height"},c.a.createElement(wt.a,{ref:u},c.a.createElement(z.a,{style:St.root,onPress:function(){return"web"!==B.a.OS&&Ze.a.dismiss()}},c.a.createElement(Q,null,"Reply to ",g),!!h&&c.a.createElement(Q,{style:St.title},"From: ",h),y&&c.a.createElement(ke,{contentHtml:y}),c.a.createElement(Z,{style:St.input,multiline:!0,placeholder:"Type your reply",value:i,onChangeText:s,onFocus:function(){u.current&&u.current.scrollToEnd({animated:!0})}}),c.a.createElement(Xe.a,{title:"Submit",color:m.tint,onPress:function(){"post"===g?function(e,t,n){return p.a.async((function(r){for(;;)switch(r.prev=r.next){case 0:return r.abrupt("return",ve(e,"POST","posts/"+t+"/replies",{content_markdown:n}).then((function(e){return e.json()})));case 1:case"end":return r.stop()}}),null,null,null,Promise)}(d,f,i).then((function(){return t.pop()})):function(e,t,n){return p.a.async((function(r){for(;;)switch(r.prev=r.next){case 0:return r.abrupt("return",ve(e,"POST","comments/"+t+"/replies",{content_markdown:n}).then((function(e){return e.json()})));case 1:case"end":return r.stop()}}),null,null,null,Promise)}(d,f,i).then((function(){return t.pop()}))}}))))}var St=D.a.create({root:{padding:20,paddingBottom:100},title:{fontSize:20,marginVertical:10},input:{marginVertical:20,minHeight:100}}),jt=n(38),Pt=n(105);function Ct(e){var t=e.replies,n=e.navigation,r=e.layer,o=void 0===r?0:r,i=e.postId,s=e.replyId,u=e.highlightedReplies,m=void 0===u?[]:u,d=Object(l.useState)(),p=a()(d,2),f=p[0],h=p[1],y=$(),g=Object(l.useContext)(ce).ctx,b=[y.text,y.red,y.orange,y.yellow,y.green,y.teal,y.blue,y.indigo,y.purple];return c.a.createElement(X,null,t.items.map((function(e){return c.a.createElement(Tt,{reply:e,layer:o,key:e.id,navigation:n,layerColors:b,postId:i,highlightedReplies:m})})),null!==t.next_page&&void 0===f&&(i||s)&&c.a.createElement(z.a,{hitSlop:5,onPress:function(){s?pe(g,s,t.next_page||void 0).then(h):i&&de(g,i,t.next_page||void 0).then(h)}},c.a.createElement(Q,{style:{color:y.tint,paddingTop:5,paddingBottom:10}},"More replies ",c.a.createElement(O.a,{name:"chevron-down-outline"}))),void 0!==f&&c.a.createElement(Ct,{replies:f,navigation:n,layer:o,postId:i,replyId:s,highlightedReplies:m}),null===t.next_page&&0===o&&c.a.createElement(Q,{style:{margin:17,color:y.secondaryText}},t.items.length>0?"No more replies":"No replies yet"))}function Tt(e){var t=e.reply,n=e.layer,r=void 0===n?0:n,o=e.navigation,i=e.layerColors,s=e.postId,u=e.highlightedReplies,m=void 0===u?[]:u,d=Object(l.useState)(),p=a()(d,2),f=p[0],h=p[1],y=c.a.useState(!0),g=a()(y,2),b=g[0],E=g[1],v=$(),x=Object(l.useContext)(ce).ctx;return c.a.createElement(X,{style:{paddingLeft:0}},c.a.createElement(X,{style:{paddingVertical:8,borderTopWidth:.5,borderTopColor:v.secondaryBackground}},c.a.createElement(z.a,{onPress:function(){return E((function(e){return!e}))},onLongPress:function(){ie(oe.a.Medium),o.navigate("Reply",{id:t.id,title:t.author.username,html:t.content_html,type:"reply"})}},c.a.createElement(X,{style:{borderLeftWidth:2,borderColor:i[r%i.length],paddingLeft:15,paddingVertical:3,backgroundColor:m.includes(t.id)?v.secondaryBackground:v.background}},c.a.createElement(Q,{style:{color:v.text,fontSize:16,marginBottom:5,fontWeight:"500"}},t.author.username,"  ",c.a.createElement(Q,{style:{color:v.text,fontSize:14}},c.a.createElement(O.a,{name:"heart-outline",size:14,color:v.text,light:!0})," ",t.score,"   ",c.a.createElement(te,{time:t.created}))),b&&!!t.content_html&&c.a.createElement(ke,{contentHtml:t.content_html,contentText:t.content_text})))),null!==t.replies?t.replies.items.length>0&&b&&c.a.createElement(X,{style:{paddingLeft:15}},c.a.createElement(Ct,{replies:t.replies,layer:r+1,navigation:o,postId:s,replyId:t.id,highlightedReplies:m})):void 0===f&&c.a.createElement(z.a,{hitSlop:5,onPress:function(){pe(x,t.id).then(h)}},c.a.createElement(X,{style:{paddingHorizontal:15,paddingBottom:10}},c.a.createElement(Q,{style:{color:v.tint}},"More replies ",c.a.createElement(O.a,{name:"chevron-forward-outline"})))),void 0!==f&&c.a.createElement(X,{style:{paddingLeft:15}},c.a.createElement(Ct,{replies:f,navigation:o,layer:r+1,postId:s,replyId:t.id})))}function kt(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function zt(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?kt(Object(n),!0).forEach((function(t){m()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):kt(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function Bt(e){var t=e.navigation,n=e.route,r=n.params.post,o=Object(l.useState)(n.params.highlightedReplies),i=a()(o,2),s=i[0],u=i[1],m=Object(l.useState)(0),d=a()(m,2),f=d[0],h=d[1],y=function(e,t,n,r){var o=Object(l.useState)({items:[]}),i=a()(o,2),c=i[0],s=i[1];return Object(l.useEffect)((function(){r?me(e,r).then((function(t){return p.a.async((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,p.a.awrap(pe(e,t.id));case 2:t.replies=n.sent,s({items:[t],next_page:null});case 4:case"end":return n.stop()}}),null,null,null,Promise)})):de(e,t).then((function(e){s(e)}))}),n),c}(Object(l.useContext)(ce).ctx,r.id,[f,null==s?void 0:s.join(",")],null==s?void 0:s[0]),g=$();return Object(l.useEffect)((function(){t.addListener("focus",(function(){h((function(e){return e+1}))}))})),c.a.createElement(Fe.a,null,c.a.createElement(X,{style:zt(zt({},Lt.item),{},{backgroundColor:g.background})},c.a.createElement(Re,{post:r,navigation:t,showHtmlContent:!0,showCommunityHost:!0}),c.a.createElement(X,{style:Lt.actions},c.a.createElement(O.a,{name:"bookmark-outline",size:25,color:g.text}),c.a.createElement(z.a,{hitSlop:5,onPress:function(){ie(oe.a.Medium),t.navigate("Reply",{id:r.id,title:r.title,html:r.content_html,type:"post"})}},c.a.createElement(O.a,{name:"arrow-undo-outline",size:25,color:g.text})),c.a.createElement(z.a,{hitSlop:5,onPress:function(){ie(oe.a.Medium),Pt.a.share({message:r.title,url:"https://dev.goldandblack.xyz/p/posts/"+r.id,title:"Hoot"})}},c.a.createElement(O.a,{name:"share-outline",size:25,color:g.text}))),s&&c.a.createElement(z.a,{onPress:function(){return u(void 0)}},c.a.createElement(Q,{style:{color:g.tint,paddingVertical:10}},"Show all replies")),c.a.createElement(Ct,{replies:y,navigation:t,postId:r.id,highlightedReplies:s}),c.a.createElement(X,{style:{height:300}})))}var Lt=D.a.create({container:{flex:1,marginTop:jt.a.currentHeight||0},item:{marginVertical:0,marginHorizontal:0},title:{fontSize:20,padding:15},contentText:{fontSize:12},link:{paddingVertical:10,paddingHorizontal:15,backgroundColor:"#8884",borderRadius:5,marginHorizontal:15},image:{width:"100%",height:void 0,resizeMode:"contain"},foot:{display:"flex",flexDirection:"row",justifyContent:"space-between",alignItems:"center",width:"100%",padding:15,borderBottomColor:"#8884",borderBottomWidth:2},by:{fontSize:11},actions:{display:"flex",flexDirection:"row",justifyContent:"space-around",alignItems:"center",padding:10}}),_t=n(71);function It(e){var t=e.navigation;return l.createElement(G.a,{style:Ht.container},l.createElement(M.a,{style:Ht.title},"This screen doesn't exist."),l.createElement(_t.a,{onPress:function(){return t.replace("Root")},style:Ht.link},l.createElement(M.a,{style:Ht.linkText},"Go to home screen!")))}var Ht=D.a.create({container:{flex:1,backgroundColor:"#fff",alignItems:"center",justifyContent:"center",padding:20},title:{fontSize:20,fontWeight:"bold"},link:{marginTop:15,paddingVertical:15},linkText:{fontSize:14,color:"#2e78b7"}});function Rt(e,t){var n;return p.a.async((function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,p.a.awrap(me(e,t));case 2:return n=r.sent,r.abrupt("return",{type:"comment",id:t,content_text:n.content_text,content_html:n.content_html,author:n.author});case 4:case"end":return r.stop()}}),null,null,null,Promise)}function Dt(e){return p.a.async((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",{type:"post",id:e.id,content_text:e.title,author:e.author});case 1:case"end":return t.stop()}}),null,null,null,Promise)}function Vt(e){var t=e.navigation,n=Object(l.useState)([]),r=a()(n,2),o=r[0],i=r[1],s=Object(l.useState)(!0),u=a()(s,2),m=u[0],d=u[1],f=Object(l.useState)(0),h=a()(f,2),y=h[0],g=h[1],b=$(),E=Object(l.useContext)(ce).ctx;if(Object(l.useEffect)((function(){E.login&&function(e){return p.a.async((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",ve(e,"GET","users/~me/notifications").then((function(e){return e.json()})));case 1:case"end":return t.stop()}}),null,null,null,Promise)}(E).then((function(e){var t=e.map((function(e){return function(e,t){var n,r,a;return p.a.async((function(o){for(;;)switch(o.prev=o.next){case 0:if(n=ue(e,t.post.id),!t.comment){o.next=5;break}o.t0=Rt(e,t.comment),o.next=10;break;case 5:return o.t1=Dt,o.next=8,p.a.awrap(n);case 8:o.t2=o.sent,o.t0=(0,o.t1)(o.t2);case 10:return r=o.t0,o.next=13,p.a.awrap(me(e,t.reply.id));case 13:return a=o.sent,o.t3=t.unseen,o.t4={id:a.id,content_text:a.content_text,content_html:a.content_html,author:a.author},o.next=18,p.a.awrap(r);case 18:return o.t5=o.sent,o.next=21,p.a.awrap(n);case 21:return o.t6=o.sent,o.abrupt("return",{unseen:o.t3,reply:o.t4,origin:o.t5,post:o.t6});case 23:case"end":return o.stop()}}),null,null,null,Promise)}(E,e)}));Promise.all(t).then(i).then((function(){return d(!1)}))}))}),[y]),Object(l.useEffect)((function(){return t.addListener("focus",(function(){return g((function(e){return e+1}))}))}),[]),!E.login)return c.a.createElement(rt,null);return c.a.createElement(V.a,{style:Wt.container,data:o,renderItem:function(e){var n=e.item;return c.a.createElement(z.a,{style:[Wt.item,{borderColor:b.secondaryBackground}],onPress:function(){var e="comment"===n.origin.type?[n.origin.id,n.reply.id]:[n.reply.id];t.navigate("Post",{post:n.post,highlightedReplies:e})}},c.a.createElement(Q,{style:Wt.name},n.post.author.username),c.a.createElement(Q,{style:Wt.title},n.post.title),c.a.createElement(Q,null,"In"," ",c.a.createElement(Le,{name:n.post.community.name,host:n.post.community.host,local:n.post.community.local,showHost:"always",colorize:"never"})),"comment"===n.origin.type?c.a.createElement(c.a.Fragment,null,c.a.createElement(X,{style:[Wt.level1,{borderColor:b.secondaryText}]},c.a.createElement(Q,{style:Wt.name},n.origin.author.username),c.a.createElement(ke,{contentHtml:n.origin.content_html,contentText:n.origin.content_text})),c.a.createElement(X,{style:[Wt.level2,{borderColor:b.tint}]},c.a.createElement(Q,{style:Wt.name},n.reply.author.username),c.a.createElement(ke,{contentHtml:n.reply.content_html,contentText:n.reply.content_text}))):c.a.createElement(c.a.Fragment,null,c.a.createElement(X,{style:[Wt.level1,{borderColor:b.tint}]},c.a.createElement(Q,{style:Wt.name},n.reply.author.username),c.a.createElement(ke,{contentHtml:n.reply.content_html,contentText:n.reply.content_text}))))},keyExtractor:function(e,t){return e.reply.id+"-"+t},refreshing:m,onRefresh:function(){d(!0),g((function(e){return e+1}))}})}var Wt=D.a.create({container:{flex:1},item:{borderBottomWidth:5,padding:15},title:{fontSize:20,fontWeight:"bold"},level1:{marginTop:5,borderLeftWidth:2,paddingLeft:15,padding:5},level2:{marginTop:5,marginLeft:15,borderLeftWidth:2,paddingLeft:15,padding:5},name:{fontWeight:"600",marginBottom:3},thin:{fontWeight:"200"}});function Nt(e){var t=e.navigation,n=Object(l.useState)(""),r=a()(n,2),o=r[0],i=r[1],s=Object(l.useState)(""),u=a()(s,2),m=u[0],d=u[1],f=$(),h=Object(l.useContext)(ce).ctx;return c.a.createElement(X,{style:Ft.root},c.a.createElement(A.a,{style:[Ft.input,{fontSize:20,color:f.text}],placeholder:"Community Name",value:o,onChangeText:i}),o.length>=4?c.a.createElement(c.a.Fragment,null,c.a.createElement(A.a,{style:[Ft.input,{color:f.text}],placeholder:"Description (Optional)",value:m,onChangeText:d}),c.a.createElement(Xe.a,{title:"Submit",color:f.tint,onPress:function(){(function(e,t){return p.a.async((function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",ve(e,"POST","communities",{name:t}).then((function(e){return e.json()})));case 1:case"end":return n.stop()}}),null,null,null,Promise)})(h,o).then((function(e){var n,r;return p.a.async((function(a){for(;;)switch(a.prev=a.next){case 0:if(n=e.community.id,!m){a.next=4;break}return a.next=4,p.a.awrap(be(h,n,m));case 4:return a.next=6,p.a.awrap(ge(h,n));case 6:return a.next=8,p.a.awrap(he(h,n));case 8:r=a.sent,t.replace("Community",{community:r});case 10:case"end":return a.stop()}}),null,null,null,Promise)})).catch((function(e){return re.a.alert("Failed to create community",e)}))},accessibilityLabel:"Create new community"})):c.a.createElement(Q,null,o.length>0&&4-o.length))}var Ft=D.a.create({root:{flex:1,alignItems:"flex-start",padding:15,height:"100%",width:"100%"},title:{fontSize:20,fontWeight:"bold"},separator:{marginVertical:30,height:1,width:"80%"},inputContainer:{width:"100%",padding:20},input:{paddingVertical:10,width:"100%",borderRadius:8},item:{paddingHorizontal:20,paddingVertical:10,marginHorizontal:20,marginBottom:1}});function Ut(e){var t=e.colorScheme;return c.a.createElement(j.a,{linking:R,theme:"dark"===t?P.a:C.a},c.a.createElement(Gt,null))}var Mt=Object(T.a)();function Gt(){return c.a.createElement(Mt.Navigator,null,c.a.createElement(Mt.Screen,{name:"Root",component:$t,options:{headerShown:!1}}),c.a.createElement(Mt.Screen,{name:"Web",component:Bt}),c.a.createElement(Mt.Screen,{name:"Post",component:Bt}),c.a.createElement(Mt.Screen,{name:"Reply",component:Ot}),c.a.createElement(Mt.Screen,{name:"Community",component:Et}),c.a.createElement(Mt.Screen,{name:"NewCommunity",component:Nt}),c.a.createElement(Mt.Screen,{name:"Settings",component:yt}),c.a.createElement(Mt.Screen,{name:"Register",component:gt}),c.a.createElement(Mt.Screen,{name:"NotFound",component:It,options:{title:"Oops!"}}),c.a.createElement(Mt.Group,{screenOptions:{presentation:"modal"}},c.a.createElement(Mt.Screen,{name:"Modal",component:Bt})))}var At=Object(S.a)();function $t(e){var t=e.navigation,n=Object(l.useState)("hot"),r=a()(n,2),o=r[0],i=r[1],s=v();return c.a.createElement(At.Navigator,{initialRouteName:"FeedScreen",screenOptions:{tabBarActiveTintColor:_[s].tint,tabBarShowLabel:!1}},c.a.createElement(At.Screen,{name:"FeedScreen",component:ot,initialParams:{sort:o},options:function(e){var t=e.navigation;return{title:"Hoot",tabBarIcon:function(e){var t=e.color;return c.a.createElement(Jt,{name:"newspaper-outline",color:t})},headerRight:function(){return c.a.createElement(z.a,{onPress:function(){k.ActionSheetIOS.showActionSheetWithOptions({options:["Cancel","Hot","New"],title:"Sort by:",cancelButtonIndex:0},(function(e){var n=[o,"hot","new"][e];i(n),t.navigate("FeedScreen",{sort:n})}))},style:function(e){return{opacity:e.pressed?.5:1}}},c.a.createElement(O.a,{name:{hot:"flame-outline",new:"time-outline"}[o],size:25,color:_[s].tint,style:{marginRight:15}}))}}}}),c.a.createElement(At.Screen,{name:"SearchScreen",component:ut,options:{title:"Communities",tabBarIcon:function(e){var t=e.color;return c.a.createElement(Jt,{name:"search-outline",color:t})}}}),c.a.createElement(At.Screen,{name:"NewPostScreen",component:ft,options:{title:"New Post",tabBarIcon:function(e){var t=e.color;return c.a.createElement(Jt,{name:"add-outline",color:t,size:40})}}}),c.a.createElement(At.Screen,{name:"NotificationScreen",component:Vt,options:{title:"Notifications",tabBarIcon:function(e){var t=e.color;return c.a.createElement(Jt,{name:"notifications-outline",color:t})}}}),c.a.createElement(At.Screen,{name:"ProfileScreen",component:mt,options:{title:"Profile",tabBarIcon:function(e){var t=e.color;return c.a.createElement(Jt,{name:"person-circle-outline",color:t})},headerLeft:function(){return c.a.createElement(z.a,{onPress:function(){t.navigate("Settings")},style:function(e){return{opacity:e.pressed?.5:1}}},c.a.createElement(O.a,{name:"cog-outline",size:25,color:_[s].secondaryText,style:{marginLeft:15}}))}}}))}function Jt(e){return c.a.createElement(O.a,w()({size:30,style:{marginBottom:-3}},e))}function qt(){var e=function(){var e=l.useState(!1),t=a()(e,2),r=t[0],o=t[1];return l.useEffect((function(){p.a.async((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,y.b(),e.next=4,p.a.awrap(h.b(b(b({},f.a.font),{},{"space-mono":n(238)})));case 4:e.next=9;break;case 6:e.prev=6,e.t0=e.catch(0),console.warn(e.t0);case 9:return e.prev=9,o(!0),y.a(),e.finish(9);case 13:case"end":return e.stop()}}),null,null,[[0,6,9,13]],Promise)}),[]),r}(),t=v(),r=Object(l.useState)(le),u=a()(r,2),m=u[0],d=u[1];function g(e){Ge(e).then((function(){return o.a.setItem("@lotide_ctx",JSON.stringify(e))})).then((function(){return d(e)}))}return Object(l.useEffect)((function(){Me().then((function(e){void 0!==e&&d(e)}))}),[]),Object(l.useEffect)((function(){m.apiUrl&&(Ee(m).then((function(e){if(console.log(e),"0.9.0-pre"!==e.software.version)throw"Bad version"})).catch((function(){var e;Je((null==(e=m.login)?void 0:e.user.username)+"@"+m.apiUrl).then((function(){return g({})}))})),m.login&&ye(m,m.login.user.id).catch((function(){var e;Je((null==(e=m.login)?void 0:e.user.username)+"@"+m.apiUrl).then((function(){return g({})}))})))}),[m]),e?c.a.createElement(ce.Provider,{value:{ctx:m,setContext:function(e){return g(e)}}},c.a.createElement(s.b,null,c.a.createElement(Ut,{colorScheme:t}),c.a.createElement(i.a,null))):null}},219:function(e,t,n){e.exports=n(302)},238:function(e,t,n){e.exports=n.p+"./fonts/SpaceMono-Regular.ttf"},254:function(e,t){}},[[219,1,2]]]);
//# sourceMappingURL=app.d13cfb60.chunk.js.map
(this.webpackJsonp=this.webpackJsonp||[]).push([[0],{211:function(e,t,n){"use strict";n.d(t,"a",(function(){return At}));var r=n(4),o=n.n(r),a=n(48),i=n(213),l=n(0),c=n.n(l),s=n(318),u=n(2),m=n.n(u),d=n(3),p=n.n(d),f=n(308),h=n(315),g=n(147);function y(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function b(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?y(Object(n),!0).forEach((function(t){m()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):y(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var v=n(99);function E(){return Object(v.a)()}var x=n(40),w=n.n(x),O=n(30),S=n(313),j=n(309),P=n(310),C=n(120),T=n(314),k=n(109),z=n(18),B=n(8),L="web"===B.a.OS?function(){}:n(109).PlatformColor,_={light:"ios"===B.a.OS?I():{tint:"orange",secondaryTint:"purple",text:"#111",secondaryText:"#333",placeholderText:"#444",background:"#fff",secondaryBackground:"#eee",tertiaryBackground:"#ccc",tabIconDefault:"#ccc",tabIconSelected:"orange",red:"red",orange:"orange",yellow:"yellow",green:"green",teal:"eeal",blue:"blue",indigo:"indigo",purple:"purple"},dark:"ios"===B.a.OS?I():{tint:"orange",secondaryTint:"purple",text:"#fff",secondaryText:"#666",placeholderText:"#aaa",background:"#111",secondaryBackground:"#222",tertiaryBackground:"#222",tabIconDefault:"#ccc",tabIconSelected:"orange",red:"red",orange:"orange",yellow:"yellow",green:"green",teal:"eeal",blue:"#68f",indigo:"indigo",purple:"purple"}};function I(){return{tint:L("systemOrange"),secondaryTint:L("systemPurple"),text:L("label"),secondaryText:L("secondaryLabel"),placeholderText:L("placeholderText"),background:L("systemBackground"),secondaryBackground:L("secondarySystemBackground"),tertiaryBackground:L("tertiarySystemBackground"),tabIconDefault:L("secondaryLabel"),tabIconSelected:L("systemOrange"),red:L("systemRed"),orange:L("systemOrange"),yellow:L("systemYellow"),green:L("systemGreen"),teal:L("systemTeal"),blue:L("systemBlue"),indigo:L("systemIndigo"),purple:L("systemPurple")}}var H=n(124),R={prefixes:[H.a("/")],config:{screens:{Root:{screens:{TabOne:{screens:{TabOneScreen:"one"}},TabTwo:{screens:{TabTwoScreen:"two"}}}},Modal:"modal",NotFound:"*"}}},V=n(1),D=n(45),W=n(37),N=n(201),U=n(11),F=n.n(U),M=n(25),G=n(5),A=n(47);function $(){var e=E();return _[e]}var J=["style","lightColor","darkColor"],q=["style","lightColor","darkColor"],K=["style","placeholderTextColor"];function Y(e,t){var n=E(),r=e[n];return r||_[n][t]}function Q(e){var t=e.style,n=e.lightColor,r=e.darkColor,o=F()(e,J),a=Y({light:n,dark:r},"text");return l.createElement(M.a,w()({style:[{color:a},t]},o))}function X(e){var t=e.style,n=e.lightColor,r=e.darkColor,o=F()(e,q),a=Y({light:n,dark:r},"background");return l.createElement(G.a,w()({style:[{backgroundColor:a},t]},o))}function Z(e){var t=e.style,n=e.placeholderTextColor,r=F()(e,K),o=$(),a={backgroundColor:o.secondaryBackground,paddingHorizontal:10,paddingVertical:5,borderRadius:8,color:o.text};return l.createElement(A.a,w()({style:[a,t],placeholderTextColor:n||o.placeholderText},r))}function ee(e){return Object(l.useMemo)((function(){return function(e){var t=Math.round((Date.now()-Date.parse(e))/1e3),n=Math.round(t/60),r=Math.round(n/60),o=Math.round(r/24),a=Math.round(o/7);return n<60&&n+"m"||r<24&&r+"h"||o<7&&o+"d"||a+"w"}(e)}),[e])}function te(e){var t=ee(e.time);return c.a.createElement(Q,{style:ne.root},c.a.createElement(N.a,{name:"time-outline",size:14})," ",t)}var ne=V.a.create({root:{}}),re=n(33),oe=n(141),ae=n(89);function ie(e){return p.a.async((function(t){for(;;)switch(t.prev=t.next){case 0:if("web"!==B.a.OS){t.next=2;break}return t.abrupt("return");case 2:return t.next=4,p.a.awrap(oe.a(e));case 4:case"end":return t.stop()}}),null,null,null,Promise)}var le={apiUrl:"https://hoot.goldandblack.xyz/api/unstable",login:void 0},ce=Object(l.createContext)({ctx:le,setContext:function(e){}});function se(e,t,n,r){return p.a.async((function(o){for(;;)switch(o.prev=o.next){case 0:return o.abrupt("return",Ee({apiUrl:e},"POST","users",{username:t,password:n,email_address:r,login:!0},!0).then((function(e){return e.json()})));case 1:case"end":return o.stop()}}),null,null,null,Promise)}function ue(e,t){return p.a.async((function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",Ee(e,"GET","posts/"+t,void 0,!0).then((function(e){return e.json()})));case 1:case"end":return n.stop()}}),null,null,null,Promise)}function me(e,t){return p.a.async((function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",Ee(e,"GET","comments/"+t,void 0,!0).then((function(e){return e.json()})));case 1:case"end":return n.stop()}}),null,null,null,Promise)}function de(e,t,n){return p.a.async((function(r){for(;;)switch(r.prev=r.next){case 0:return r.abrupt("return",Ee(e,"GET","posts/"+t+"/replies?limit=10"+(n?"&page="+n:""),void 0,!0).then((function(e){return e.json()})));case 1:case"end":return r.stop()}}),null,null,null,Promise)}function pe(e,t,n){return p.a.async((function(r){for(;;)switch(r.prev=r.next){case 0:return r.abrupt("return",Ee(e,"GET","comments/"+t+"/replies?limit=10"+(n?"&page="+n:""),void 0,!0).then((function(e){return e.json()})));case 1:case"end":return r.stop()}}),null,null,null,Promise)}function fe(e){var t,n,r=arguments;return p.a.async((function(o){for(;;)switch(o.prev=o.next){case 0:return t=r.length>1&&void 0!==r[1]&&r[1],n=r.length>2?r[2]:void 0,o.abrupt("return",Ee(e,"GET","communities?include_your=true&limit=100"+(t?"&your_follow.accepted=true":"")+(n?"&page="+n:"")).then((function(e){return e.json()})).then((function(e){return e})));case 3:case"end":return o.stop()}}),null,null,null,Promise)}function he(e,t){return p.a.async((function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",Ee(e,"GET","communities/"+t+"?include_your=true").then((function(e){return e.json()})));case 1:case"end":return n.stop()}}),null,null,null,Promise)}function ge(e,t){return p.a.async((function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",Ee(e,"GET","users/"+t,void 0,!0).then((function(e){return e.json()})));case 1:case"end":return n.stop()}}),null,null,null,Promise)}function ye(e,t){return p.a.async((function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",Ee(e,"POST","communities/"+t+"/follow",{try_wait_for_accept:!0}).then((function(e){return e.json()})));case 1:case"end":return n.stop()}}),null,null,null,Promise)}function be(e,t,n){return p.a.async((function(r){for(;;)switch(r.prev=r.next){case 0:return r.abrupt("return",Ee(e,"PATCH","communities/"+t,{description:n}));case 1:case"end":return r.stop()}}),null,null,null,Promise)}function ve(e){return p.a.async((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",Ee(e,"GET","instance",void 0,!0).then((function(e){return e.json()})));case 1:case"end":return t.stop()}}),null,null,null,Promise)}function Ee(e,t,n,r){var o,a=arguments;return p.a.async((function(i){for(;;)switch(i.prev=i.next){case 0:if(o=a.length>4&&void 0!==a[4]&&a[4],e.apiUrl){i.next=3;break}throw"No API url";case 3:if(o||void 0!=e.login){i.next=5;break}throw"Not logged in";case 5:return i.abrupt("return",fetch(e.apiUrl+"/"+n,{method:t,headers:xe(e),body:void 0!==r?JSON.stringify(r):void 0}).then((function(e){return p.a.async((function(t){for(;;)switch(t.prev=t.next){case 0:if(!e.ok){t.next=4;break}return t.abrupt("return",e);case 4:return t.next=6,p.a.awrap(e.text());case 6:throw t.sent;case 7:case"end":return t.stop()}}),null,null,null,Promise)})).catch((function(r){throw console.error("Lotide Service Error: "+t+" "+e.apiUrl+"/"+n+"\n"+r,e),r})));case 6:case"end":return i.stop()}}),null,null,null,Promise)}function xe(e){return void 0!==e.login?{Authorization:"Bearer "+e.login.token,"Content-Type":"application/json"}:void 0}function we(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Oe(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?we(Object(n),!0).forEach((function(t){m()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):we(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function Se(e){var t=Object(l.useState)(!1),n=o()(t,2),r=n[0],a=n[1],i=$(),s=Object(l.useContext)(ce).ctx,u=null!==e.post.your_vote&&void 0!==e.post.your_vote;function m(){ie(ae.a.Light),void 0!==s.login?r?function(e,t){return p.a.async((function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",Ee(e,"DELETE","posts/"+t+"/your_vote"));case 1:case"end":return n.stop()}}),null,null,null,Promise)}(s,e.post.id).then((function(){return a(!1)})):function(e,t){return p.a.async((function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",Ee(e,"PUT","posts/"+t+"/your_vote"));case 1:case"end":return n.stop()}}),null,null,null,Promise)}(s,e.post.id).then((function(){return a(!0)})):re.a.alert("Login to like","Leave a like when you login to a community")}Object(l.useEffect)((function(){return a(u)}),[e.post.your_vote]);var d=i.text;r&&(d=i.red);var f=r&&!u,h=!r&&u;return c.a.createElement(z.a,{onPress:function(){return m()},hitSlop:7},c.a.createElement(X,{style:je.root},c.a.createElement(N.a,{name:r?"heart":"heart-outline",color:d,size:25}),c.a.createElement(Q,{style:Oe(Oe({},je.score),{},{color:d})},"  "+(e.post.score+ +f-+h)+"  ")))}var je=V.a.create({root:{display:"flex",flexDirection:"row",alignItems:"center"},score:{fontSize:18,minWidth:28}}),Pe=n(214);function Ce(e){var t=$(),n=Object(l.useMemo)((function(){return e.contentHtml||(""===(t=e.contentMarkdown)||void 0===t?void 0:t.replace(/^### (.*$)/gim,"<h3>$1</h3>").replace(/^## (.*$)/gim,"<h2>$1</h2>").replace(/^# (.*$)/gim,"<h1>$1</h1>").replace(/^\> (.*$)/gim,"<blockquote>$1</blockquote>").replace(/\*\*(.*)\*\*/gim,"<b>$1</b>").replace(/\*(.*)\*/gim,"<i>$1</i>").replace(/!\[(.*?)\]\((.*?)\)/gim,"<img alt='$1' src='$2' />").replace(/\[(.*?)\]\((.*?)\)/gim,"<a href='$2'>$1</a>").replace(/\n$/gim,"<br />").trim())||"<p>"+e.contentText+"</p>";var t}),[e.contentHtml,e.contentMarkdown,e.contentText]);return Object(l.useMemo)((function(){return c.a.createElement(Pe.a,{value:n.replace(/\n/g,""),renderNode:Te,stylesheet:{a:{color:t.secondaryTint}},textComponentProps:{style:{color:t.text}},addLineBreaks:!1,onLinkLongPress:function(e){return re.a.alert("Link",e)}})}),[n])}function Te(e,t,n,r,o){return["iframe","img","hr","script"].includes(e.name||"")?null:"li"===e.name?c.a.createElement(Q,{key:t},"\u2022 ",o(e.children,r),"\n"):void 0}function ke(e){var t=$(),n=e.colorize||"never",r=e.showHost||"only_foreign",o=function(e,t){return"always"===e||"never"!==e&&!t},a=o(n,e.local),i=o(r,e.local),l=a?{color:e.local?t.blue:t.green}:{};return c.a.createElement(Q,{style:[ze.root,e.style]},c.a.createElement(Q,{style:[ze.name,l,e.styleName]},e.name),i&&c.a.createElement(Q,{style:[ze.host,{color:t.secondaryText},e.styleHost]},e.newLine&&"\n",!e.newLine&&"@",e.host))}var ze=V.a.create({root:{},name:{fontWeight:"500"},host:{fontWeight:"200"}});function Be(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Le(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Be(Object(n),!0).forEach((function(t){m()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Be(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function _e(e){var t=Object(l.useState)(1),n=o()(t,2),r=n[0],a=n[1],i=Object(l.useMemo)((function(){return!!(t=e.post.href)&&[".png",".jpg",".jpeg",".bmp",".gif",".webp"].some((function(e){return t.endsWith(e)}));var t}),[e.post.href]),s=$(),u=e.post;return c.a.createElement(X,null,c.a.createElement(Q,{style:Ie.title},e.post.sticky&&c.a.createElement(c.a.Fragment,null,c.a.createElement(O.a,{name:"pin",size:25,color:s.secondaryTint})," "),e.post.title),e.post.href&&(i?c.a.createElement(W.a,{style:Le(Le({},Ie.image),{},{aspectRatio:r,backgroundColor:s.secondaryBackground}),source:{uri:e.post.href},onLoad:function(e){return a(Math.max(e.nativeEvent.source.width/e.nativeEvent.source.height,.5))}}):c.a.createElement(z.a,{style:[Ie.link,{backgroundColor:s.secondaryBackground}],onPress:function(){ie(ae.a.Medium),e.post.href&&Object(H.b)(e.post.href)}},c.a.createElement(Q,null,e.post.href))),e.showHtmlContent&&!!e.post.content_html&&c.a.createElement(X,{style:{paddingHorizontal:15}},c.a.createElement(Ce,{contentHtml:e.post.content_html,contentText:e.post.content_text})),c.a.createElement(X,{style:Ie.foot},c.a.createElement(X,null,c.a.createElement(z.a,{hitSlop:8,onPress:function(){return e.navigation.navigate("Community",{community:e.post.community})}},c.a.createElement(ke,{name:u.community.name,host:u.community.host,local:u.community.local,showHost:"only_foreign",colorize:"never",newLine:!0})),c.a.createElement(Q,{style:Ie.by},"by ",e.post.author.username),e.showCommunityHost&&c.a.createElement(Q,{style:Ie.by},"on ",e.post.community.host)),c.a.createElement(X,null,c.a.createElement(te,{time:e.post.created})),c.a.createElement(X,null,c.a.createElement(Q,{style:Ie.footText},c.a.createElement(O.a,{name:"chatbubble-outline",size:12})," ",e.post.replies_count_total)),c.a.createElement(X,null,c.a.createElement(Se,{post:e.post,isUpvoted:!1}))))}var Ie=V.a.create({item:{marginVertical:0,marginHorizontal:0},title:{fontSize:20,padding:15},contentText:{fontSize:12},link:{paddingVertical:10,paddingHorizontal:15,borderRadius:5,marginHorizontal:15},image:{width:"100%",height:void 0,resizeMode:"contain"},foot:{display:"flex",flexDirection:"row",justifyContent:"space-between",alignItems:"center",width:"100%",padding:15},footText:{},by:{fontSize:11},score:{fontSize:18},actions:{display:"flex",flexDirection:"row",justifyContent:"space-around",alignItems:"center",padding:10}});var He=n(16),Re=n.n(He);function Ve(e,t,n){var r=Object(l.useState)([]),a=o()(r,2),i=a[0],c=a[1],s=Object(l.useState)(null),u=o()(s,2),m=u[0],d=u[1],f=Object(l.useState)(null),h=o()(f,2),g=h[0],y=h[1],b=Object(l.useState)(void 0),v=o()(b,2),E=v[0],x=v[1],w=Object(l.useState)(0),O=o()(w,2),S=O[0],j=O[1],P=Object(l.useContext)(ce).ctx,C=function(e,t){var n=Object(l.useState)(0),r=o()(n,2),a=r[0],i=r[1],c=Object(l.useState)(!0),s=o()(c,2),u=s[0],m=s[1];return Object(l.useEffect)((function(){e((function(){return m(!1)}))}),[a].concat(Re()(t))),[u,function(){i((function(e){return e+1})),m(!0)}]}((function(r){P.login&&void 0===E&&(x(m),function(e,t){var n,r,o,a,i=arguments;return p.a.async((function(l){for(;;)switch(l.prev=l.next){case 0:return n=i.length>2&&void 0!==i[2]?i[2]:"hot",r=i.length>3?i[3]:void 0,o=i.length>4?i[4]:void 0,a=[null===t?"posts?sort="+n:"posts?page="+t+"&sort="+n,"include_your=true",void 0!==r&&"in_your_follows="+r,o&&"community="+o].filter((function(e){return e})).join("&"),l.abrupt("return",Ee(e,"GET",a).then((function(e){return e.json()})));case 5:case"end":return l.stop()}}),null,null,null,Promise)}(P,m,e,t,n).then((function(e){c((function(t){return[].concat(Re()(t),Re()(e.items))})),y(e.next_page),x(void 0)})).then((function(){return r()})).catch((function(e){r(),c((function(t){return[].concat(Re()(t),[{id:-1,title:"Lotide error",content_html:"<p>Error: "+e+"</p>",created:"",replies_count_total:0,score:0,sticky:!0,author:{id:-1,username:"Failure",local:!1,host:"hoot-mobile"},community:{id:-1,name:"something-went-wrong",local:!1,host:"hoot-mobile"}}])}))})))}),[S,m]),T=o()(C,2),k=T[0],z=T[1];return Object(l.useEffect)((function(){c([]),d(null),y(null),z()}),[P,e]),[i,k,function(){c([]),d(null),y(null),j((function(e){return e+1})),z()},function(){null!==g&&d(g)}]}var De=n(41),We=[{name:"Gold&Black",domain:"hoot.goldandblack.xyz"},{name:"Tide C",domain:"c.tide.tk"},{name:"Narwhal City",domain:"dev.narwhal.city"},{name:"Exopla",domain:"lotide.exopla.net.eu.org"},{name:"Tide B",domain:"b.tide.tk"},{name:"Tide A",domain:"a.tide.tk"}],Ne=function(){return p.a.async((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",a.a.getItem("@lotide_ctx").then((function(e){return null!==e?JSON.parse(e):void 0})));case 1:case"end":return e.stop()}}),null,null,null,Promise)},Ue=function(e){var t;return p.a.async((function(n){for(;;)switch(n.prev=n.next){case 0:if(e.login){n.next=2;break}return n.abrupt("return");case 2:t=e.login.user.username+"@"+e.apiUrl,$e.store("@lotide_ctx_arr",t,e);case 4:case"end":return n.stop()}}),null,null,null,Promise)},Fe=function(e){return p.a.async((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",$e.query("@lotide_ctx_arr",e));case 1:case"end":return t.stop()}}),null,null,null,Promise)},Me=function(){return p.a.async((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",$e.listKeys("@lotide_ctx_arr"));case 1:case"end":return e.stop()}}),null,null,null,Promise)},Ge=function(e){return p.a.async((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",$e.remove("@lotide_ctx_arr",e));case 1:case"end":return t.stop()}}),null,null,null,Promise)},Ae=function(){var e;return p.a.async((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,p.a.awrap(a.a.getItem("@lotide_ctx_arr"));case 2:return e=t.sent,t.abrupt("return",e?JSON.parse(e):{});case 4:case"end":return t.stop()}}),null,null,null,Promise)},$e={store:function(e,t,n){var r,o;return p.a.async((function(i){for(;;)switch(i.prev=i.next){case 0:return i.next=2,p.a.awrap(a.a.getItem(e));case 2:return r=i.sent,o=r?JSON.parse(r):{},o[t]=n,i.next=7,p.a.awrap(a.a.setItem(e,JSON.stringify(o)));case 7:case"end":return i.stop()}}),null,null,null,Promise)},query:function(e,t){var n;return p.a.async((function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,p.a.awrap(a.a.getItem(e));case 2:return n=r.sent,r.abrupt("return",n?JSON.parse(n)[t]:void 0);case 4:case"end":return r.stop()}}),null,null,null,Promise)},listKeys:function(e){var t,n;return p.a.async((function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,p.a.awrap(a.a.getItem(e));case 2:return t=r.sent,n=t?JSON.parse(t):{},r.abrupt("return",Object.keys(n));case 5:case"end":return r.stop()}}),null,null,null,Promise)},remove:function(e,t){var n,r,o;return p.a.async((function(i){for(;;)switch(i.prev=i.next){case 0:return i.next=2,p.a.awrap(a.a.getItem(e));case 2:return n=i.sent,r=n?JSON.parse(n):{},o=r[t],delete r[t],i.next=8,p.a.awrap(a.a.setItem(e,JSON.stringify(r)));case 8:return i.abrupt("return",o);case 9:case"end":return i.stop()}}),null,null,null,Promise)}};function Je(e){var t=Object(l.useState)(""),n=o()(t,2),r=n[0],a=n[1],i=Object(l.useState)(We),s=o()(i,2),u=s[0],m=s[1],d=Object(l.useState)([]),p=o()(d,2),f=p[0],h=p[1],g=$(),y=Object(l.useContext)(ce);Object(l.useEffect)((function(){We.map((function(e,t){return ve({apiUrl:"https://"+e.domain+"/api/unstable"}).then((function(e){m((function(n){return n.map((function(n,r){return t!==r?n:{name:n.name,domain:n.domain,instanceInfo:e}}))}))})).catch((function(){m((function(e){return e.map((function(e,n){return t!==n?e:{name:e.name,domain:e.domain,instanceInfo:null}}))}))}))}))}),[]),Object(l.useEffect)((function(){Ae().then((function(e){return Object.entries(e)})).then(h)}),[]);return c.a.createElement(De.a,{style:qe.root},c.a.createElement(Q,{style:qe.title},"Login to continue"),f.length>0&&c.a.createElement(Q,{style:qe.subtitle},"Select an existing profile"),f.map((function(e){var t=e[0].split("@"),n=o()(t,2),r=n[0],a=n[1];return c.a.createElement(z.a,{key:e[0],onPress:function(){y.setContext(e[1])}},c.a.createElement(ke,{name:r,host:a.replace("http://","").replace("https://","").split(/[/?#]/)[0],local:!0,showHost:"always",newLine:!0,style:{paddingVertical:5,paddingBottom:10}}))})),c.a.createElement(Q,{style:qe.subtitle},f.length>0?"Or sign into a new acount":"Enter a host or select one below"),c.a.createElement(Z,{placeholder:"Host domain",style:{paddingVertical:10,paddingHorizontal:10},value:r,onChangeText:a,onSubmitEditing:function(){return e.onSelect(r.toLowerCase())},keyboardType:"url",returnKeyType:"next"}),u.filter((function(e){return""===r||e.domain.includes(r.toLowerCase())||e.name.toLowerCase().includes(r.toLowerCase())})).map((function(t){return c.a.createElement(X,{key:t.domain},function(t){var n,r=t.item,o="0.9.0-pre"===(null==(n=r.instanceInfo)?void 0:n.software.version),a=o?g.text:g.secondaryText;return c.a.createElement(X,{style:{borderBottomWidth:1,borderColor:g.secondaryBackground,paddingVertical:10}},c.a.createElement(z.a,{onPress:function(){return o&&e.onSelect(r.domain,r.name)}},c.a.createElement(ke,{name:r.name,host:r.domain,local:!1,newLine:!0,style:{borderBottomWidth:1,borderBottomColor:"#fff"},styleName:{fontSize:24,fontWeight:"300",fontFamily:"ios"===B.a.OS?"Georgia":"serif",color:a}}),r.instanceInfo?c.a.createElement(c.a.Fragment,null,c.a.createElement(Q,{style:{color:g.secondaryText}},r.instanceInfo.software.version,!o&&" - Out of date"),!!r.instanceInfo.description&&c.a.createElement(Q,{style:{color:a}},r.instanceInfo.description)):null===r.instanceInfo?c.a.createElement(Q,{style:{color:a}},"Failed to load info"):c.a.createElement(Q,{style:{color:a}},"Loading...")))}({item:t}))})))}var qe=V.a.create({root:{flex:1,padding:20},title:{fontSize:24,marginBottom:10},subtitle:{fontWeight:"300",marginBottom:10}}),Ke=n(29),Ye=n(39),Qe=n(54);function Xe(e){var t=Object(l.useState)(!1),n=o()(t,2),r=n[0],a=n[1],i=Object(l.useState)(""),s=o()(i,2),u=s[0],m=s[1],d=Object(l.useState)(""),f=o()(d,2),h=f[0],g=f[1],y=$(),b=Object(l.useContext)(ce);function v(){(function(e,t,n){return p.a.async((function(r){for(;;)switch(r.prev=r.next){case 0:return r.abrupt("return",Ee({apiUrl:e},"POST","logins",{username:t,password:n},!0).then((function(e){return e.json()})));case 1:case"end":return r.stop()}}),null,null,null,Promise)})("https://"+e.domain+"/api/unstable",u,h).then((function(t){b.setContext({apiUrl:"https://"+e.domain+"/api/unstable",login:t})})).catch((function(e){re.a.alert("Failed to login",e),console.error(e)}))}return c.a.createElement(z.a,{style:{flex:1},onPress:function(){return"web"!==B.a.OS&&Ye.a.dismiss()}},c.a.createElement(Qe.a,{style:Ze.root,behavior:"padding"},e.hostName?c.a.createElement(z.a,{style:{alignItems:"center"}},c.a.createElement(Q,{style:Ze.name},e.hostName),c.a.createElement(Q,{style:[Ze.domain,{color:y.secondaryText}]},e.domain)):c.a.createElement(z.a,null,c.a.createElement(Q,{style:{fontSize:24}},e.domain)),c.a.createElement(z.a,{hitSlop:5,onPress:function(){return a((function(e){return!e}))}},c.a.createElement(Q,{style:[Ze.loginRegister,{color:y.secondaryText}]},c.a.createElement(Q,{style:{color:r?y.secondaryText:y.secondaryTint}},"Login")," | ",c.a.createElement(Q,{style:{color:r?y.secondaryTint:y.secondaryText}},"Register"))),c.a.createElement(Z,{style:Ze.input,placeholder:"Username",value:u,onChangeText:m}),c.a.createElement(Z,{style:Ze.input,placeholder:"Password",value:h,onChangeText:g,secureTextEntry:!0}),c.a.createElement(X,{style:Ze.actionButtons},c.a.createElement(Ke.a,{title:"Change Host",onPress:e.onGoBack,color:y.secondaryTint}),c.a.createElement(Ke.a,{title:r?"Register":"Login",onPress:function(){r?se("https://"+e.domain+"/api/unstable",u,h).then((function(t){b.setContext({apiUrl:"https://"+e.domain+"/api/unstable",login:t})})).catch((function(e){re.a.alert("Failed to register",e),console.error(e)})):v()},color:y.tint}))))}var Ze=V.a.create({root:{flex:1,alignItems:"center",justifyContent:"center",padding:35},name:{fontSize:50,fontFamily:"ios"===B.a.OS?"Georgia":"serif"},domain:{fontWeight:"300"},loginRegister:{padding:15},input:{width:"100%",marginVertical:5,paddingHorizontal:20,paddingVertical:10},actionButtons:{width:"100%",display:"flex",flexDirection:"row",justifyContent:"space-around"}});function et(){var e=Object(l.useState)(),t=o()(e,2),n=t[0],r=t[1],a=Object(l.useState)(),i=o()(a,2),s=i[0],u=i[1];return c.a.createElement(X,{style:tt.root},s?c.a.createElement(Xe,{hostName:n,domain:s,onGoBack:function(){return u(void 0)}}):c.a.createElement(Je,{onSelect:function(e,t){r(t),u(e)}}))}var tt=V.a.create({root:{width:"100%",height:"100%"},container:{flex:1,alignItems:"center",justifyContent:"center"},input:{width:"100%",marginBottom:20,paddingHorizontal:20,paddingVertical:10},actionButtons:{display:"flex",flexDirection:"row",justifyContent:"space-around",width:"100%"}});function nt(e){var t=e.navigation,n=e.route.params.sort,r=Object(l.useContext)(ce).ctx,a=Ve(n,!0),i=o()(a,4),s=i[0],u=i[1],m=i[2],d=i[3];if(!function(e){return!!e.apiUrl&&!!e.login}(r))return c.a.createElement(et,null);console.log(r);return c.a.createElement(X,{style:rt.container},c.a.createElement(D.a,{data:s,renderItem:function(e){var n=e.item;return c.a.createElement(ot,{post:n,navigation:t})},keyExtractor:function(e,t){return e.id+"-"+t},refreshing:u,onRefresh:m,onEndReachedThreshold:2,onEndReached:d}))}var rt=V.a.create({container:{flex:1},item:{marginVertical:0,marginHorizontal:0,borderBottomWidth:8},title:{fontSize:20,padding:15,color:"#eee"},contentText:{fontSize:12},link:{paddingVertical:10,paddingHorizontal:15,backgroundColor:"#8884",borderRadius:5,marginHorizontal:15},image:{width:"100%",height:void 0,resizeMode:"contain"},foot:{display:"flex",flexDirection:"row",justifyContent:"space-between",alignItems:"center",width:"100%",padding:15},footText:{color:"#ccc"},by:{fontSize:11},score:{fontSize:18,color:"#bbb"}}),ot=function(e){var t=e.post,n=e.navigation,r=$();return c.a.createElement(z.a,{onPress:function(){return n.navigate("Post",{post:t})},onLongPress:function(){ie(ae.a.Heavy),console.log(t)}},c.a.createElement(X,{style:[rt.item,{borderBottomColor:r.secondaryBackground}]},c.a.createElement(_e,{post:t,navigation:n})))};function at(e){var t,n=Object(l.useState)(),r=o()(n,2),a=r[0],i=r[1],s=Object(l.useState)(""),u=o()(s,2),m=u[0],d=u[1],p=Object(l.useContext)(ce).ctx,f=$(),h=e.onlyWhenTyping&&""===m?[]:a?""===m?a.items:a.items.filter((function(e){return e.name.toLowerCase().includes(m.toLowerCase())||e.host.includes(m.toLowerCase())})):[];Object(l.useEffect)((function(){fe(p,!1).then(i)}),[null==(t=p.login)?void 0:t.token]);return c.a.createElement(X,null,c.a.createElement(Z,{placeholder:e.placeholder||"Filter communities",value:m,onChangeText:d,style:it.input}),c.a.createElement(D.a,{data:h,renderItem:function(t){var n,r=t.item;return c.a.createElement(z.a,{onPress:function(){return e.onSelect(r)},style:[it.item,{borderColor:f.secondaryBackground}]},c.a.createElement(ke,{name:r.name,host:r.host,local:r.local,colorize:"always",newLine:!0}),c.a.createElement(X,{style:{display:"flex",flexDirection:"row"}},r.you_are_moderator&&c.a.createElement(O.a,{name:"shield-outline",size:20,color:f.secondaryTint}),(null==(n=r.your_follow)?void 0:n.accepted)&&c.a.createElement(O.a,{name:"checkmark",size:20,color:f.secondaryTint,style:{marginLeft:5}})))},keyExtractor:function(e,t){return e.id+"-"+t},contentContainerStyle:it.list}))}var it=V.a.create({root:{flex:1,alignItems:"center",justifyContent:"center"},input:{paddingVertical:10,marginHorizontal:20,marginTop:20},list:{padding:20,paddingBottom:100},item:{display:"flex",flexDirection:"row",justifyContent:"space-between",alignItems:"center",height:50,borderBottomWidth:1,paddingHorizontal:20}});function lt(e){var t=e.navigation;return Object(l.useContext)(ce).ctx.login?c.a.createElement(at,{onSelect:function(e){return t.navigate("Community",{community:e})}}):c.a.createElement(et,null)}function ct(e){var t,n,r,a=e.navigation,i=Object(l.useState)(),s=o()(i,2),u=s[0],m=s[1],d=Object(l.useState)([]),f=o()(d,2),h=f[0],g=f[1],y=Object(l.useState)([]),b=o()(y,2),v=b[0],E=b[1],x=Object(l.useState)(!1),w=o()(x,2),S=w[0],j=w[1],P=$(),C=Object(l.useContext)(ce),T=C.ctx;if(Object(l.useEffect)((function(){T.login&&fe(T,!0).then((function(e){return E(e.items)}))}),[null==(t=T.login)?void 0:t.user.id]),Object(l.useEffect)((function(){var e;void 0!==T.login&&void 0!==T.login.user&&ge(T,(null==(e=T.login)?void 0:e.user.id)||0).then(m)}),[null==(n=T.login)?void 0:n.token]),Object(l.useEffect)((function(){Me().then((function(e){return g(e)}))}),[T]),void 0===T.login)return c.a.createElement(et,null);return c.a.createElement(De.a,{style:[st.container,{backgroundColor:P.background}]},c.a.createElement(X,{style:st.header},c.a.createElement(X,null,c.a.createElement(z.a,{hitSlop:10,onPress:function(){return j((function(e){return!e}))}},c.a.createElement(Q,{style:st.title},null==u?void 0:u.username,"  ",c.a.createElement(O.a,{name:"pencil-outline",size:20,color:P.secondaryText}))),c.a.createElement(Q,{style:{color:P.secondaryText}},null==u?void 0:u.host),!(null==u||!u.avatar)&&c.a.createElement(Q,null,null==u||null==(r=u.avatar)?void 0:r.url),!(null==u||!u.description)&&c.a.createElement(Q,null,null==u?void 0:u.description)),c.a.createElement(Ke.a,{onPress:function(){re.a.alert("Log out","Would you like to keep the login profile handy for later?",[{text:"Remove",onPress:function(){var e;Ge((null==(e=T.login)?void 0:e.user.username)+"@"+T.apiUrl).then((function(){return function(e){return p.a.async((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",Ee(e,"DELETE","logins/~current"));case 1:case"end":return t.stop()}}),null,null,null,Promise)}(T)})).then((function(){return C.setContext({})}))}},{text:"Keep",style:"default",onPress:function(){C.setContext({})}}])},title:"Log Out",color:P.secondaryTint,accessibilityLabel:"Log out of the Hoot network"})),S&&c.a.createElement(X,{style:st.editView},c.a.createElement(Z,{style:st.editViewText,placeholder:"New email"}),c.a.createElement(Z,{style:st.editViewText,placeholder:"User bio",multiline:!0}),c.a.createElement(Z,{style:st.editViewText,placeholder:"New password"}),c.a.createElement(Z,{style:st.editViewText,placeholder:"Confirm new password"}),c.a.createElement(X,{style:st.editViewActionButtons},c.a.createElement(Ke.a,{onPress:function(){return j(!1)},title:"Cancel",color:P.secondaryTint,accessibilityLabel:"Add profile"}),c.a.createElement(Ke.a,{onPress:function(){return re.a.alert("unimplemented")},title:"Submit",color:P.tint,accessibilityLabel:"Add profile"}))),c.a.createElement(Ke.a,{onPress:function(){return C.setContext({})},title:"Add Profile",color:P.tint,accessibilityLabel:"Add profile"}),h.map((function(e){return[e].concat(Re()(e.split("@")))})).map((function(e){return[e[0],e[1],e[2].replace("http://","").replace("https://","").split(/[/?#]/)[0]]})).map((function(e){return c.a.createElement(z.a,{key:e[0],style:[st.altProfileButton,{borderColor:P.secondaryBackground}],onPress:function(){Fe(e[0]).then((function(e){void 0!==e&&(C.setContext(e),j(!1))}))}},c.a.createElement(ke,{name:e[1],host:e[2],local:!0,showHost:"always",colorize:"never",newLine:!0}))})),c.a.createElement(X,{style:{paddingTop:10}},c.a.createElement(Ke.a,{onPress:function(){return a.navigate("NewCommunity")},title:"Create Community",color:P.tint,accessibilityLabel:"Create a new community"})),c.a.createElement(Q,{style:st.followingTitle},"Communities You Follow:"),v.map((function(e){return c.a.createElement(X,{key:e.id,style:[st.altProfileButton,{borderColor:P.secondaryBackground}]},c.a.createElement(ke,{name:e.name,host:e.host,local:e.local,showHost:"always",colorize:"always",newLine:!0}))})))}var st=V.a.create({container:{height:"100%"},header:{display:"flex",flexDirection:"row",justifyContent:"space-between",padding:20},title:{fontSize:20,fontWeight:"bold"},followingTitle:{fontSize:18,fontWeight:"500",padding:20},editView:{margin:20},editViewText:{marginBottom:15,paddingVertical:10,paddingHorizontal:15},editViewActionButtons:{display:"flex",flexDirection:"row",justifyContent:"space-around"},separator:{marginVertical:30,height:1,width:"80%"},inputContainer:{width:"100%",padding:20},input:{height:40,borderWidth:1,paddingVertical:10,paddingHorizontal:20,width:"100%",borderRadius:8},altProfileButton:{marginHorizontal:20,paddingVertical:15,borderBottomWidth:1}}),ut=n(108);function mt(e){var t=e.navigation,n=Object(l.useState)(),r=o()(n,2),a=r[0],i=r[1],s=Object(l.useState)(""),u=o()(s,2),m=u[0],d=u[1],f=Object(l.useState)(""),h=o()(f,2),g=h[0],y=h[1],b=Object(l.useState)(""),v=o()(b,2),E=v[0],x=v[1],w=$(),O=Object(l.useContext)(ce).ctx;if(Object(l.useEffect)((function(){return t.addListener("focus",(function(){console.log(a),null===a&&i(void 0)}))}),[a,null==a?void 0:a.id]),void 0===O.login)return c.a.createElement(et,null);if(null===a)return c.a.createElement(at,{onSelect:i,onlyWhenTyping:!0});return c.a.createElement(Qe.a,{style:{width:"100%",height:"100%"}},c.a.createElement(ut.a,{onPress:function(){return"web"!==B.a.OS&&Ye.a.dismiss()}},c.a.createElement(X,{style:dt.container},c.a.createElement(z.a,{onPress:function(){return i(null)}},a?c.a.createElement(ke,{name:a.name,host:a.host,local:a.local,colorize:"always",showHost:"always",newLine:!0,style:dt.input}):c.a.createElement(Q,{style:[dt.input,{color:w.secondaryText}]},"Select a Community")),c.a.createElement(A.a,{style:[dt.input,dt.title,{color:w.text}],placeholder:"Add a Title",placeholderTextColor:w.placeholderText,value:m,onChangeText:d}),m.length>=4?c.a.createElement(c.a.Fragment,null,c.a.createElement(A.a,{style:[dt.input,{color:w.text}],placeholder:"Link",placeholderTextColor:w.placeholderText,value:g,onChangeText:y,keyboardType:"url",textContentType:"URL"}),c.a.createElement(A.a,{style:[dt.input,{color:w.text}],placeholder:"Add post content",placeholderTextColor:w.placeholderText,value:E,onChangeText:x})):c.a.createElement(Q,{style:{color:w.secondaryText}},m.length>0&&4-m.length),!!a&&(!!g||E.length>10)&&c.a.createElement(Ke.a,{onPress:function(){a&&function(e,t){return p.a.async((function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",Ee(e,"POST","posts",t).then((function(e){return e.json()})));case 1:case"end":return n.stop()}}),null,null,null,Promise)}(O,{community:a.id,title:m,href:g||void 0,content_markdown:E||void 0}).then((function(e){ue(O,e.id).then((function(e){i(void 0),d(""),y(""),x(""),t.navigate("Post",{post:e})}))})).catch((function(e){return re.a.alert("Could not submit post",e)}))},title:"Submit",color:w.tint,accessibilityLabel:"Submit new post"}),E.length<11&&E.length>0&&c.a.createElement(Q,{style:{color:w.secondaryText}},11-E.length))))}var dt=V.a.create({container:{flex:1,alignItems:"flex-start",padding:15,height:"100%",width:"100%"},title:{fontSize:20,fontWeight:"bold"},separator:{marginVertical:30,height:1,width:"80%"},inputContainer:{width:"100%",padding:20},input:{paddingVertical:10,width:"100%",borderRadius:8},item:{paddingHorizontal:20,paddingVertical:10,marginHorizontal:20,marginBottom:1}});function pt(){return c.a.createElement(X,null,c.a.createElement(Q,null,"Settings screen. It'll be implemented eventually."))}function ft(e){var t=e.navigation,n=(e.route,Object(l.useState)("")),r=o()(n,2),a=r[0],i=r[1],s=Object(l.useState)(""),u=o()(s,2),m=u[0],d=u[1],p=Object(l.useState)(""),f=o()(p,2),h=f[0],g=f[1],y=Object(l.useState)(""),b=o()(y,2),v=b[0],E=b[1],x=$(),w=Object(l.useContext)(ce);return c.a.createElement(X,{style:ht.root},c.a.createElement(z.a,{style:ht.container,onPress:function(){return"web"!==B.a.OS&&Ye.a.dismiss()}},c.a.createElement(Q,{style:{fontWeight:"300",fontSize:18,marginBottom:25}},"Register a new account"),c.a.createElement(Qe.a,{style:{width:"100%"},behavior:"position"},c.a.createElement(X,{style:{display:"flex",flexDirection:"row",alignItems:"center",marginBottom:20}},c.a.createElement(Z,{style:[ht.input,{marginBottom:0,width:"auto",flex:1}],placeholder:"Host URL",value:m,onChangeText:d,textContentType:"URL"}),c.a.createElement(z.a,{onPress:function(){return re.a.alert("unimplemented")}},c.a.createElement(O.a,{name:"search-outline",size:25,color:x.secondaryText,style:{marginLeft:15}}))),c.a.createElement(Z,{style:ht.input,placeholder:"Username",textContentType:"username",value:a,onChangeText:i}),c.a.createElement(Z,{style:ht.input,placeholder:"Password",textContentType:"password",secureTextEntry:!0,value:h,onChangeText:g}),c.a.createElement(Z,{style:ht.input,placeholder:"Confirm Password",textContentType:"password",secureTextEntry:!0,value:v,onChangeText:E}),c.a.createElement(X,{style:ht.actionButtons},c.a.createElement(Ke.a,{onPress:function(){var e=m||"https://hoot.goldandblack.xyz/api/unstable";se(e,a,h).then((function(n){w.setContext({apiUrl:e,login:n}),t.pop()})).catch(console.error)},title:"Register",color:x.tint,accessibilityLabel:"Login to the Hoot network"})))))}var ht=V.a.create({root:{width:"100%",height:"100%",padding:20},container:{flex:1,alignItems:"center",justifyContent:"center"},input:{width:"100%",marginBottom:20,paddingHorizontal:20,paddingVertical:10},actionButtons:{display:"flex",flexDirection:"row",justifyContent:"space-around",width:"100%"}});function gt(e){var t,n=e.navigation,r=e.route,a=Object(l.useState)(r.params.community),i=o()(a,2),s=i[0],u=i[1],m=Ve("hot",void 0,s.id),d=o()(m,4),f=d[0],h=d[1],g=d[2],y=d[3],b=Object(l.useState)(0),v=o()(b,2),E=v[0],x=v[1],w=$(),O=Object(l.useContext)(ce).ctx;Object(l.useEffect)((function(){he(O,s.id).then(u)}),[r.params.community.id,E]);var S=(null==(t=s.your_follow)?void 0:t.accepted)||!1;return c.a.createElement(X,{style:[yt.root,{backgroundColor:w.background}]},c.a.createElement(X,{style:[yt.header,{borderBottomColor:w.secondaryBackground}]},c.a.createElement(X,null,c.a.createElement(Q,{style:[yt.title]},s.name),c.a.createElement(Q,{style:{color:s.local?w.blue:w.green,fontWeight:"500"}},s.host),""!==s.description&&c.a.createElement(Q,null,"\n",s.description)),S?c.a.createElement(Ke.a,{onPress:function(){(function(e,t){return p.a.async((function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",Ee(e,"POST","communities/"+t+"/unfollow"));case 1:case"end":return n.stop()}}),null,null,null,Promise)})(O,s.id).then((function(){x((function(e){return e+1}))}))},title:"Unfollow",color:w.tint,accessibilityLabel:"Stop seeing posts from this community"}):c.a.createElement(Ke.a,{onPress:function(){ye(O,s.id).then((function(e){!1===e.accepted&&re.a.alert("Follow request rejected.","This could be an issue with the node you are connected to."),x((function(e){return e+1}))}))},title:"Follow",color:w.tint,accessibilityLabel:"See posts from this community in your feed"})),c.a.createElement(D.a,{data:f,renderItem:function(e){var t=e.item;return c.a.createElement(bt,{post:t,navigation:n})},keyExtractor:function(e,t){return e.id+"-"+t},refreshing:h,onRefresh:g,onEndReachedThreshold:2,onEndReached:y}))}var yt=V.a.create({root:{height:"100%"},header:{display:"flex",flexDirection:"row",justifyContent:"space-between",padding:20,borderBottomWidth:1},title:{fontSize:20},item:{marginVertical:0,marginHorizontal:0,borderBottomWidth:8}}),bt=function(e){var t=e.post,n=e.navigation,r=$();return c.a.createElement(z.a,{onPress:function(){return n.navigate("Post",{post:t})},onLongPress:function(){ie(ae.a.Heavy)}},c.a.createElement(X,{style:[yt.item,{borderBottomColor:r.secondaryBackground}]},c.a.createElement(_e,{post:t,navigation:n})))},vt=n(212);function Et(e){var t=e.navigation,n=e.route,r=Object(l.useState)(""),a=o()(r,2),i=a[0],s=a[1],u=Object(l.useRef)(null),m=$(),d=Object(l.useContext)(ce).ctx,f=n.params.id,h=n.params.title,g=n.params.html,y=n.params.type;return c.a.createElement(Qe.a,{behavior:"ios"===B.a.OS?"padding":"height"},c.a.createElement(vt.a,{ref:u},c.a.createElement(z.a,{style:xt.root,onPress:function(){return"web"!==B.a.OS&&Ye.a.dismiss()}},c.a.createElement(Q,null,"Reply to ",y),!!h&&c.a.createElement(Q,{style:xt.title},"From: ",h),g&&c.a.createElement(Ce,{contentHtml:g}),c.a.createElement(Z,{style:xt.input,multiline:!0,placeholder:"Type your reply",value:i,onChangeText:s,onFocus:function(){u.current&&u.current.scrollToEnd({animated:!0})}}),c.a.createElement(Ke.a,{title:"Submit",color:m.tint,onPress:function(){"post"===y?function(e,t,n){return p.a.async((function(r){for(;;)switch(r.prev=r.next){case 0:return r.abrupt("return",Ee(e,"POST","posts/"+t+"/replies",{content_markdown:n}).then((function(e){return e.json()})));case 1:case"end":return r.stop()}}),null,null,null,Promise)}(d,f,i).then((function(){return t.pop()})):function(e,t,n){return p.a.async((function(r){for(;;)switch(r.prev=r.next){case 0:return r.abrupt("return",Ee(e,"POST","comments/"+t+"/replies",{content_markdown:n}).then((function(e){return e.json()})));case 1:case"end":return r.stop()}}),null,null,null,Promise)}(d,f,i).then((function(){return t.pop()}))}}))))}var xt=V.a.create({root:{padding:20,paddingBottom:100},title:{fontSize:20,marginVertical:10},input:{marginVertical:20,minHeight:100}}),wt=n(38),Ot=n(105);function St(e){var t=e.replies,n=e.navigation,r=e.layer,a=void 0===r?0:r,i=e.postId,s=e.replyId,u=e.highlightedReplies,m=void 0===u?[]:u,d=Object(l.useState)(),p=o()(d,2),f=p[0],h=p[1],g=$(),y=Object(l.useContext)(ce).ctx,b=[g.text,g.red,g.orange,g.yellow,g.green,g.teal,g.blue,g.indigo,g.purple];return c.a.createElement(X,null,t.items.map((function(e){return c.a.createElement(jt,{reply:e,layer:a,key:e.id,navigation:n,layerColors:b,postId:i,highlightedReplies:m})})),null!==t.next_page&&void 0===f&&(i||s)&&c.a.createElement(z.a,{hitSlop:5,onPress:function(){s?pe(y,s,t.next_page||void 0).then(h):i&&de(y,i,t.next_page||void 0).then(h)}},c.a.createElement(Q,{style:{color:g.tint,paddingTop:5,paddingBottom:10}},"More replies ",c.a.createElement(O.a,{name:"chevron-down-outline"}))),void 0!==f&&c.a.createElement(St,{replies:f,navigation:n,layer:a,postId:i,replyId:s,highlightedReplies:m}),null===t.next_page&&0===a&&c.a.createElement(Q,{style:{margin:17,color:g.secondaryText}},t.items.length>0?"No more replies":"No replies yet"))}function jt(e){var t=e.reply,n=e.layer,r=void 0===n?0:n,a=e.navigation,i=e.layerColors,s=e.postId,u=e.highlightedReplies,m=void 0===u?[]:u,d=Object(l.useState)(),p=o()(d,2),f=p[0],h=p[1],g=c.a.useState(!0),y=o()(g,2),b=y[0],v=y[1],E=$(),x=Object(l.useContext)(ce).ctx;return c.a.createElement(X,{style:{paddingLeft:0}},c.a.createElement(X,{style:{paddingVertical:8,borderTopWidth:.5,borderTopColor:E.secondaryBackground}},c.a.createElement(z.a,{onPress:function(){return v((function(e){return!e}))},onLongPress:function(){ie(ae.a.Medium),a.navigate("Reply",{id:t.id,title:t.author.username,html:t.content_html,type:"reply"})}},c.a.createElement(X,{style:{borderLeftWidth:2,borderColor:i[r%i.length],paddingLeft:15,paddingVertical:3,backgroundColor:m.includes(t.id)?E.secondaryBackground:E.background}},c.a.createElement(Q,{style:{color:E.text,fontSize:16,marginBottom:5,fontWeight:"500"}},t.author.username,"  ",c.a.createElement(Q,{style:{color:E.text,fontSize:14}},c.a.createElement(O.a,{name:"heart-outline",size:14,color:E.text,light:!0})," ",t.score,"   ",c.a.createElement(te,{time:t.created}))),b&&!!t.content_html&&c.a.createElement(Ce,{contentHtml:t.content_html,contentText:t.content_text})))),null!==t.replies?t.replies.items.length>0&&b&&c.a.createElement(X,{style:{paddingLeft:15}},c.a.createElement(St,{replies:t.replies,layer:r+1,navigation:a,postId:s,replyId:t.id,highlightedReplies:m})):void 0===f&&c.a.createElement(z.a,{hitSlop:5,onPress:function(){pe(x,t.id).then(h)}},c.a.createElement(X,{style:{paddingHorizontal:15,paddingBottom:10}},c.a.createElement(Q,{style:{color:E.tint}},"More replies ",c.a.createElement(O.a,{name:"chevron-forward-outline"})))),void 0!==f&&c.a.createElement(X,{style:{paddingLeft:15}},c.a.createElement(St,{replies:f,navigation:a,layer:r+1,postId:s,replyId:t.id})))}function Pt(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Ct(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Pt(Object(n),!0).forEach((function(t){m()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Pt(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function Tt(e){var t=e.navigation,n=e.route,r=n.params.post,a=Object(l.useState)(n.params.highlightedReplies),i=o()(a,2),s=i[0],u=i[1],m=Object(l.useState)(0),d=o()(m,2),f=d[0],h=d[1],g=function(e,t,n,r){var a=Object(l.useState)({items:[]}),i=o()(a,2),c=i[0],s=i[1];return Object(l.useEffect)((function(){r?me(e,r).then((function(t){return p.a.async((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,p.a.awrap(pe(e,t.id));case 2:t.replies=n.sent,s({items:[t],next_page:null});case 4:case"end":return n.stop()}}),null,null,null,Promise)})):de(e,t).then((function(e){s(e)}))}),n),c}(Object(l.useContext)(ce).ctx,r.id,[f,null==s?void 0:s.join(",")],null==s?void 0:s[0]),y=$();return Object(l.useEffect)((function(){t.addListener("focus",(function(){h((function(e){return e+1}))}))})),c.a.createElement(De.a,null,c.a.createElement(X,{style:Ct(Ct({},kt.item),{},{backgroundColor:y.background})},c.a.createElement(_e,{post:r,navigation:t,showHtmlContent:!0,showCommunityHost:!0}),c.a.createElement(X,{style:kt.actions},c.a.createElement(O.a,{name:"bookmark-outline",size:25,color:y.text}),c.a.createElement(z.a,{hitSlop:5,onPress:function(){ie(ae.a.Medium),t.navigate("Reply",{id:r.id,title:r.title,html:r.content_html,type:"post"})}},c.a.createElement(O.a,{name:"arrow-undo-outline",size:25,color:y.text})),c.a.createElement(z.a,{hitSlop:5,onPress:function(){ie(ae.a.Medium),Ot.a.share({message:r.title,url:"https://dev.goldandblack.xyz/p/posts/"+r.id,title:"Hoot"})}},c.a.createElement(O.a,{name:"share-outline",size:25,color:y.text}))),s&&c.a.createElement(z.a,{onPress:function(){return u(void 0)}},c.a.createElement(Q,{style:{color:y.tint,paddingVertical:10}},"Show all replies")),c.a.createElement(St,{replies:g,navigation:t,postId:r.id,highlightedReplies:s}),c.a.createElement(X,{style:{height:300}})))}var kt=V.a.create({container:{flex:1,marginTop:wt.a.currentHeight||0},item:{marginVertical:0,marginHorizontal:0},title:{fontSize:20,padding:15},contentText:{fontSize:12},link:{paddingVertical:10,paddingHorizontal:15,backgroundColor:"#8884",borderRadius:5,marginHorizontal:15},image:{width:"100%",height:void 0,resizeMode:"contain"},foot:{display:"flex",flexDirection:"row",justifyContent:"space-between",alignItems:"center",width:"100%",padding:15,borderBottomColor:"#8884",borderBottomWidth:2},by:{fontSize:11},actions:{display:"flex",flexDirection:"row",justifyContent:"space-around",alignItems:"center",padding:10}}),zt=n(71);function Bt(e){var t=e.navigation;return l.createElement(G.a,{style:Lt.container},l.createElement(M.a,{style:Lt.title},"This screen doesn't exist."),l.createElement(zt.a,{onPress:function(){return t.replace("Root")},style:Lt.link},l.createElement(M.a,{style:Lt.linkText},"Go to home screen!")))}var Lt=V.a.create({container:{flex:1,backgroundColor:"#fff",alignItems:"center",justifyContent:"center",padding:20},title:{fontSize:20,fontWeight:"bold"},link:{marginTop:15,paddingVertical:15},linkText:{fontSize:14,color:"#2e78b7"}});function _t(e,t){var n;return p.a.async((function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,p.a.awrap(me(e,t));case 2:return n=r.sent,r.abrupt("return",{type:"comment",id:t,content_text:n.content_text,content_html:n.content_html,author:n.author});case 4:case"end":return r.stop()}}),null,null,null,Promise)}function It(e){return p.a.async((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",{type:"post",id:e.id,content_text:e.title,author:e.author});case 1:case"end":return t.stop()}}),null,null,null,Promise)}function Ht(e){var t=e.navigation,n=Object(l.useState)([]),r=o()(n,2),a=r[0],i=r[1],s=Object(l.useState)(!0),u=o()(s,2),m=u[0],d=u[1],f=Object(l.useState)(0),h=o()(f,2),g=h[0],y=h[1],b=$(),v=Object(l.useContext)(ce).ctx;if(Object(l.useEffect)((function(){v.login&&function(e){return p.a.async((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",Ee(e,"GET","users/~me/notifications").then((function(e){return e.json()})));case 1:case"end":return t.stop()}}),null,null,null,Promise)}(v).then((function(e){var t=e.map((function(e){return function(e,t){var n,r,o;return p.a.async((function(a){for(;;)switch(a.prev=a.next){case 0:if(n=ue(e,t.post.id),!t.comment){a.next=5;break}a.t0=_t(e,t.comment),a.next=10;break;case 5:return a.t1=It,a.next=8,p.a.awrap(n);case 8:a.t2=a.sent,a.t0=(0,a.t1)(a.t2);case 10:return r=a.t0,a.next=13,p.a.awrap(me(e,t.reply.id));case 13:return o=a.sent,a.t3=t.unseen,a.t4={id:o.id,content_text:o.content_text,content_html:o.content_html,author:o.author},a.next=18,p.a.awrap(r);case 18:return a.t5=a.sent,a.next=21,p.a.awrap(n);case 21:return a.t6=a.sent,a.abrupt("return",{unseen:a.t3,reply:a.t4,origin:a.t5,post:a.t6});case 23:case"end":return a.stop()}}),null,null,null,Promise)}(v,e)}));Promise.all(t).then(i).then((function(){return d(!1)}))}))}),[g]),Object(l.useEffect)((function(){return t.addListener("focus",(function(){return y((function(e){return e+1}))}))}),[]),!v.login)return c.a.createElement(et,null);return c.a.createElement(D.a,{style:Rt.container,data:a,renderItem:function(e){var n=e.item;return c.a.createElement(z.a,{style:[Rt.item,{borderColor:b.secondaryBackground}],onPress:function(){var e="comment"===n.origin.type?[n.origin.id,n.reply.id]:[n.reply.id];t.navigate("Post",{post:n.post,highlightedReplies:e})}},c.a.createElement(Q,{style:Rt.name},n.post.author.username),c.a.createElement(Q,{style:Rt.title},n.post.title),c.a.createElement(Q,null,"In"," ",c.a.createElement(ke,{name:n.post.community.name,host:n.post.community.host,local:n.post.community.local,showHost:"always",colorize:"never"})),"comment"===n.origin.type?c.a.createElement(c.a.Fragment,null,c.a.createElement(X,{style:[Rt.level1,{borderColor:b.secondaryText}]},c.a.createElement(Q,{style:Rt.name},n.origin.author.username),c.a.createElement(Ce,{contentHtml:n.origin.content_html,contentText:n.origin.content_text})),c.a.createElement(X,{style:[Rt.level2,{borderColor:b.tint}]},c.a.createElement(Q,{style:Rt.name},n.reply.author.username),c.a.createElement(Ce,{contentHtml:n.reply.content_html,contentText:n.reply.content_text}))):c.a.createElement(c.a.Fragment,null,c.a.createElement(X,{style:[Rt.level1,{borderColor:b.tint}]},c.a.createElement(Q,{style:Rt.name},n.reply.author.username),c.a.createElement(Ce,{contentHtml:n.reply.content_html,contentText:n.reply.content_text}))))},keyExtractor:function(e,t){return e.reply.id+"-"+t},refreshing:m,onRefresh:function(){d(!0),y((function(e){return e+1}))}})}var Rt=V.a.create({container:{flex:1},item:{borderBottomWidth:5,padding:15},title:{fontSize:20,fontWeight:"bold"},level1:{marginTop:5,borderLeftWidth:2,paddingLeft:15,padding:5},level2:{marginTop:5,marginLeft:15,borderLeftWidth:2,paddingLeft:15,padding:5},name:{fontWeight:"600",marginBottom:3},thin:{fontWeight:"200"}});function Vt(e){var t=e.navigation,n=Object(l.useState)(""),r=o()(n,2),a=r[0],i=r[1],s=Object(l.useState)(""),u=o()(s,2),m=u[0],d=u[1],f=$(),h=Object(l.useContext)(ce).ctx;return c.a.createElement(X,{style:Dt.root},c.a.createElement(A.a,{style:[Dt.input,{fontSize:20,color:f.text}],placeholder:"Community Name",value:a,onChangeText:i}),a.length>=4?c.a.createElement(c.a.Fragment,null,c.a.createElement(A.a,{style:[Dt.input,{color:f.text}],placeholder:"Description (Optional)",value:m,onChangeText:d}),c.a.createElement(Ke.a,{title:"Submit",color:f.tint,onPress:function(){(function(e,t){return p.a.async((function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",Ee(e,"POST","communities",{name:t}).then((function(e){return e.json()})));case 1:case"end":return n.stop()}}),null,null,null,Promise)})(h,a).then((function(e){var n,r;return p.a.async((function(o){for(;;)switch(o.prev=o.next){case 0:if(n=e.community.id,!m){o.next=4;break}return o.next=4,p.a.awrap(be(h,n,m));case 4:return o.next=6,p.a.awrap(ye(h,n));case 6:return o.next=8,p.a.awrap(he(h,n));case 8:r=o.sent,t.replace("Community",{community:r});case 10:case"end":return o.stop()}}),null,null,null,Promise)})).catch((function(e){return re.a.alert("Failed to create community",e)}))},accessibilityLabel:"Create new community"})):c.a.createElement(Q,null,a.length>0&&4-a.length))}var Dt=V.a.create({root:{flex:1,alignItems:"flex-start",padding:15,height:"100%",width:"100%"},title:{fontSize:20,fontWeight:"bold"},separator:{marginVertical:30,height:1,width:"80%"},inputContainer:{width:"100%",padding:20},input:{paddingVertical:10,width:"100%",borderRadius:8},item:{paddingHorizontal:20,paddingVertical:10,marginHorizontal:20,marginBottom:1}});function Wt(e){var t=e.colorScheme;return c.a.createElement(j.a,{linking:R,theme:"dark"===t?P.a:C.a},c.a.createElement(Ut,null))}var Nt=Object(T.a)();function Ut(){return c.a.createElement(Nt.Navigator,null,c.a.createElement(Nt.Screen,{name:"Root",component:Mt,options:{headerShown:!1}}),c.a.createElement(Nt.Screen,{name:"Web",component:Tt}),c.a.createElement(Nt.Screen,{name:"Post",component:Tt}),c.a.createElement(Nt.Screen,{name:"Reply",component:Et}),c.a.createElement(Nt.Screen,{name:"Community",component:gt}),c.a.createElement(Nt.Screen,{name:"NewCommunity",component:Vt}),c.a.createElement(Nt.Screen,{name:"Settings",component:pt}),c.a.createElement(Nt.Screen,{name:"Register",component:ft}),c.a.createElement(Nt.Screen,{name:"NotFound",component:Bt,options:{title:"Oops!"}}),c.a.createElement(Nt.Group,{screenOptions:{presentation:"modal"}},c.a.createElement(Nt.Screen,{name:"Modal",component:Tt})))}var Ft=Object(S.a)();function Mt(e){var t=e.navigation,n=Object(l.useState)("hot"),r=o()(n,2),a=r[0],i=r[1],s=E();return c.a.createElement(Ft.Navigator,{initialRouteName:"FeedScreen",screenOptions:{tabBarActiveTintColor:_[s].tint,tabBarShowLabel:!1}},c.a.createElement(Ft.Screen,{name:"FeedScreen",component:nt,initialParams:{sort:a},options:function(e){var t=e.navigation;return{title:"Hoot",tabBarIcon:function(e){var t=e.color;return c.a.createElement(Gt,{name:"newspaper-outline",color:t})},headerRight:function(){return c.a.createElement(z.a,{onPress:function(){k.ActionSheetIOS.showActionSheetWithOptions({options:["Cancel","Hot","New"],title:"Sort by:",cancelButtonIndex:0},(function(e){var n=[a,"hot","new"][e];i(n),t.navigate("FeedScreen",{sort:n})}))},style:function(e){return{opacity:e.pressed?.5:1}}},c.a.createElement(O.a,{name:{hot:"flame-outline",new:"time-outline"}[a],size:25,color:_[s].tint,style:{marginRight:15}}))}}}}),c.a.createElement(Ft.Screen,{name:"SearchScreen",component:lt,options:{title:"Communities",tabBarIcon:function(e){var t=e.color;return c.a.createElement(Gt,{name:"search-outline",color:t})}}}),c.a.createElement(Ft.Screen,{name:"NewPostScreen",component:mt,options:{title:"New Post",tabBarIcon:function(e){var t=e.color;return c.a.createElement(Gt,{name:"add-outline",color:t,size:40})}}}),c.a.createElement(Ft.Screen,{name:"NotificationScreen",component:Ht,options:{title:"Notifications",tabBarIcon:function(e){var t=e.color;return c.a.createElement(Gt,{name:"notifications-outline",color:t})}}}),c.a.createElement(Ft.Screen,{name:"ProfileScreen",component:ct,options:{title:"Profile",tabBarIcon:function(e){var t=e.color;return c.a.createElement(Gt,{name:"person-circle-outline",color:t})},headerLeft:function(){return c.a.createElement(z.a,{onPress:function(){t.navigate("Settings")},style:function(e){return{opacity:e.pressed?.5:1}}},c.a.createElement(O.a,{name:"cog-outline",size:25,color:_[s].secondaryText,style:{marginLeft:15}}))}}}))}function Gt(e){return c.a.createElement(O.a,w()({size:30,style:{marginBottom:-3}},e))}function At(){var e=function(){var e=l.useState(!1),t=o()(e,2),r=t[0],a=t[1];return l.useEffect((function(){p.a.async((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,g.b(),e.next=4,p.a.awrap(h.b(b(b({},f.a.font),{},{"space-mono":n(238)})));case 4:e.next=9;break;case 6:e.prev=6,e.t0=e.catch(0),console.warn(e.t0);case 9:return e.prev=9,a(!0),g.a(),e.finish(9);case 13:case"end":return e.stop()}}),null,null,[[0,6,9,13]],Promise)}),[]),r}(),t=E(),r=Object(l.useState)(le),u=o()(r,2),m=u[0],d=u[1];function y(e){Ue(e).then((function(){return a.a.setItem("@lotide_ctx",JSON.stringify(e))})).then((function(){return d(e)}))}return Object(l.useEffect)((function(){Ne().then((function(e){void 0!==e&&d(e)}))}),[]),Object(l.useEffect)((function(){m.apiUrl&&(ve(m).then((function(e){if(console.log(e),"0.9.0-pre"!==e.software.version)throw"Bad version"})).catch((function(){var e;Ge((null==(e=m.login)?void 0:e.user.username)+"@"+m.apiUrl).then((function(){return y({})}))})),m.login&&ge(m,m.login.user.id).catch((function(){var e;Ge((null==(e=m.login)?void 0:e.user.username)+"@"+m.apiUrl).then((function(){return y({})}))})))}),[m]),e?c.a.createElement(ce.Provider,{value:{ctx:m,setContext:function(e){return y(e)}}},c.a.createElement(s.b,null,c.a.createElement(Wt,{colorScheme:t}),c.a.createElement(i.a,null))):null}},219:function(e,t,n){e.exports=n(302)},238:function(e,t,n){e.exports=n.p+"./fonts/SpaceMono-Regular.ttf"},254:function(e,t){}},[[219,1,2]]]);
//# sourceMappingURL=app.c80cd886.chunk.js.map
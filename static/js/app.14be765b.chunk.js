(this.webpackJsonp=this.webpackJsonp||[]).push([[0],{266:function(e,t,n){"use strict";var r=n(3),o=n.n(r),a=n(65),i=n(267),l=n(0),c=n.n(l),s=n(199),u=n(8),d=n.n(u),p=n(7),m=n.n(p),f=n(374),y=n(379),g=n(197);function h(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function b(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?h(Object(n),!0).forEach((function(t){o()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):h(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var v=n(139);function E(){return Object(v.a)()}var O=n(46),w=n.n(O),j=n(36),x=n(375),P=n(376),S=n(164),T=n(378),k=n(377),C=n(20),I=n(5),z="web"===I.a.OS?function(){}:n(224).PlatformColor,_={light:"ios"===I.a.OS?D():{tint:"orange",secondaryTint:"purple",text:"#111",secondaryText:"#333",placeholderText:"#444",background:"#fff",secondaryBackground:"#eee",tertiaryBackground:"#ccc",tabIconDefault:"#ccc",tabIconSelected:"orange",red:"red",orange:"orange",yellow:"yellow",green:"green",teal:"eeal",blue:"blue",indigo:"indigo",purple:"purple"},dark:"ios"===I.a.OS?D():{tint:"orange",secondaryTint:"purple",text:"#fff",secondaryText:"#666",placeholderText:"#aaa",background:"#111",secondaryBackground:"#222",tertiaryBackground:"#222",tabIconDefault:"#ccc",tabIconSelected:"orange",red:"red",orange:"orange",yellow:"yellow",green:"green",teal:"eeal",blue:"#68f",indigo:"indigo",purple:"purple"}};function D(){return{tint:z("systemOrange"),secondaryTint:z("systemPurple"),text:z("label"),secondaryText:z("secondaryLabel"),placeholderText:z("placeholderText"),background:z("systemBackground"),secondaryBackground:z("secondarySystemBackground"),tertiaryBackground:z("tertiarySystemBackground"),tabIconDefault:z("secondaryLabel"),tabIconSelected:z("systemOrange"),red:z("systemRed"),orange:z("systemOrange"),yellow:z("systemYellow"),green:z("systemGreen"),teal:z("systemTeal"),blue:z("systemBlue"),indigo:z("systemIndigo"),purple:z("systemPurple")}}var L=n(171),R={prefixes:[L.a("/")],config:{screens:{Root:{screens:{TabOne:{screens:{TabOneScreen:"one"}},TabTwo:{screens:{TabTwoScreen:"two"}}}},Modal:"modal",NotFound:"*"}}},B=n(2),H=n(62),V=n(49),N=n(252),F=n(34),W=n(15),M=n.n(W),U=n(29),A=n(6),G=n(63);function $(){var e=E();return _[e]}var J=["style","secondary","tint"],K=["style"],q=["style","placeholderTextColor"];function Y(e){var t=e.style,n=e.secondary,r=e.tint,o=M()(e,J),a=$(),i=n||r?n&&!r?a.secondaryText:r&&!n?a.tint:a.secondaryTint:a.text;return c.a.createElement(U.a,w()({style:[{color:i},t]},o))}function X(e){var t=e.style,n=M()(e,K),r=$().background;return c.a.createElement(A.a,w()({style:[{backgroundColor:r},t]},n))}var Q=Object(l.forwardRef)((function(e,t){var n=e.style,r=e.placeholderTextColor,o=M()(e,q),a=$(),i={backgroundColor:a.secondaryBackground,paddingHorizontal:10,paddingVertical:5,borderRadius:8,color:a.text};return c.a.createElement(G.a,w()({ref:t,style:[i,n],placeholderTextColor:r||a.placeholderText},o))}));function Z(e){return Object(l.useMemo)((function(){return function(e){var t=Math.round((Date.now()-Date.parse(e))/1e3),n=Math.round(t/60),r=Math.round(n/60),o=Math.round(r/24),a=Math.round(o/7),i=Math.round(o/30.4),l=Math.round(o/365);return n<60&&n+"min"||r<24&&r+"h"||o<7&&o+"d"||a<5&&a+"w"||i<12&&i+"mo"||l+"y"}(e)}),[e])}function ee(e){var t=Z(e.time);return c.a.createElement(C.a,{hitSlop:8,onPress:function(){return F.a.alert("Date posted",e.time)}},c.a.createElement(Y,{style:te.root},c.a.createElement(N.a,{name:"time-outline",size:14})," ",t))}var te=B.a.create({root:{}}),ne=n(191),re=n(125);function oe(e){return m.a.async((function(t){for(;;)switch(t.prev=t.next){case 0:if("web"!==I.a.OS){t.next=2;break}return t.abrupt("return");case 2:return t.next=4,m.a.awrap(ne.a(e));case 4:case"end":return t.stop()}}),null,null,null,Promise)}var ae=n(35),ie=n(90);function le(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function ce(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?le(Object(n),!0).forEach((function(t){o()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):le(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var se=Object(ie.b)({name:"posts",initialState:{posts:{}},reducers:{setPost:function(e,t){var n=t.payload;e.posts[n.post.id]=n.post},setPostMulti:function(e,t){t.payload.posts.forEach((function(t){e.posts[t.id]=t}))},editPost:function(e,t){var n=t.payload,r=e.posts[n.id];e.posts[n.id]=ce(ce({},r),n.post)},clearPosts:function(e){e.posts={}},setPostVote:function(e,t){var n=t.payload,r=e.posts[n.id];r.your_vote!==n.vote&&(r.your_vote=n.vote,n.vote?r.score+=1:r.score-=1)}}}),ue=se.actions,de=ue.setPost,pe=ue.setPostMulti,me=ue.editPost,fe=(ue.clearPosts,ue.setPostVote),ye=se.reducer;function ge(e,t,n,r){var o,a,i=arguments;return m.a.async((function(l){for(;;)switch(l.prev=l.next){case 0:if(a=i.length>4&&void 0!==i[4]&&i[4],e.apiUrl){l.next=3;break}throw"No API url";case 3:if(a||null!=(o=e.login)&&o.token){l.next=5;break}throw"Not logged in";case 5:return l.abrupt("return",fetch(e.apiUrl+"/"+n,{method:t,headers:he(e),body:void 0!==r?JSON.stringify(r):void 0}).then((function(e){return m.a.async((function(t){for(;;)switch(t.prev=t.next){case 0:if(!e.ok){t.next=4;break}return t.abrupt("return",e);case 4:return t.next=6,m.a.awrap(e.text());case 6:throw t.sent;case 7:case"end":return t.stop()}}),null,null,null,Promise)})).catch((function(r){throw console.error("Lotide Service Error: "+t+" "+e.apiUrl+"/"+n+"\n"+r,e),r})));case 6:case"end":return l.stop()}}),null,null,null,Promise)}function he(e){return void 0!==e.login?{Authorization:"Bearer "+e.login.token,"Content-Type":"application/json"}:void 0}function be(e){var t,n,r=arguments;return m.a.async((function(o){for(;;)switch(o.prev=o.next){case 0:return t=r.length>1&&void 0!==r[1]&&r[1],n=r.length>2?r[2]:void 0,o.abrupt("return",ge(e,"GET","communities?include_your=true&limit=100"+(t?"&your_follow.accepted=true":"")+(n?"&page="+n:"")).then((function(e){return e.json()})).then((function(e){return e})));case 3:case"end":return o.stop()}}),null,null,null,Promise)}function ve(e,t){return m.a.async((function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",ge(e,"GET","communities/"+t+"?include_your=true").then((function(e){return e.json()})));case 1:case"end":return n.stop()}}),null,null,null,Promise)}function Ee(e,t){return m.a.async((function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",ge(e,"GET","users/"+t,void 0,!0).then((function(e){return e.json()})));case 1:case"end":return n.stop()}}),null,null,null,Promise)}function Oe(e,t){return m.a.async((function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",ge(e,"POST","communities/"+t+"/follow",{try_wait_for_accept:!0}).then((function(e){return e.json()})));case 1:case"end":return n.stop()}}),null,null,null,Promise)}function we(e,t,n){return m.a.async((function(r){for(;;)switch(r.prev=r.next){case 0:return r.abrupt("return",ge(e,"PATCH","communities/"+t,{description:n}));case 1:case"end":return r.stop()}}),null,null,null,Promise)}function je(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function xe(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?je(Object(n),!0).forEach((function(t){o()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):je(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function Pe(e){return m.a.async((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",ge(e,"GET","instance",void 0,!0).then((function(e){return e.json()})).then((function(e){var t=parseInt(e.software.version.split(".")[1]);return xe(xe({},e),{},{apiVersion:t})})));case 1:case"end":return t.stop()}}),null,null,null,Promise)}function Se(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Te(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Se(Object(n),!0).forEach((function(t){o()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Se(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function ke(e,t){return m.a.async((function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",ge(e,"GET","posts/"+t,void 0,!0).then((function(e){return e.json()})).then(Ce));case 1:case"end":return n.stop()}}),null,null,null,Promise)}function Ce(e){return void 0!==e.your_vote?Te(Te({},e),{},{your_vote:null!==e.your_vote}):e}var Ie=n(18),ze=n.n(Ie);function _e(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function De(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?_e(Object(n),!0).forEach((function(t){o()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):_e(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function Le(e){var t=Re(e.replies||void 0),n=d()(t,2),r=n[0],o=n[1];return[De(De({},e),{},{replies:r,your_vote:null!==e.your_vote&&void 0!==e.your_vote})].concat(ze()(o))}function Re(e){return e?[{items:e.items.map((function(e){return e.id})),next_page:e.next_page},e.items.flatMap(Le)]:[void 0,[]]}function Be(e){return m.a.async((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",ge(e,"DELETE","logins/~current"));case 1:case"end":return t.stop()}}),null,null,null,Promise)}function He(){return Object(ae.c)((function(e){return e.lotide.ctx}))}function Ve(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Ne(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Ve(Object(n),!0).forEach((function(t){o()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Ve(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var Fe=Object(ie.b)({name:"replies",initialState:{replies:{}},reducers:{setReply:function(e,t){var n=t.payload;e.replies[n.reply.id]=n.reply},setReplyMulti:function(e,t){t.payload.replies.forEach((function(t){e.replies[t.id]=t}))},editReply:function(e,t){var n=t.payload,r=e.replies[n.id];e.replies[n.id]=Ne(Ne({},r),n.reply)},clearReplies:function(e){e.replies={}},setReplyVote:function(e,t){var n=t.payload,r=e.replies[n.id];r.your_vote!==n.vote&&(r.your_vote=n.vote,n.vote?r.score+=1:r.score-=1)},setSelectedReply:function(e,t){e.selectedReply=t.payload}}}),We=Fe.actions,Me=(We.setReply,We.setReplyMulti),Ue=We.editReply,Ae=(We.clearReplies,We.setReplyVote),Ge=We.setSelectedReply,$e=Fe.reducer;function Je(e,t){var n=!!t.your_vote,r=Object(ae.b)(),o=He();function a(n){r("post"==e?fe({id:t.id,vote:n}):Ae({id:t.id,vote:n}))}return{isUpvoted:n,addVote:function(){null!=o&&o.login&&("post"==e?function(e,t){return m.a.async((function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",ge(e,"PUT","posts/"+t+"/your_vote"));case 1:case"end":return n.stop()}}),null,null,null,Promise)}(o,t.id).then((function(){return a(!0)})):function(e,t){return m.a.async((function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",ge(e,"PUT","comments/"+t+"/your_vote"));case 1:case"end":return n.stop()}}),null,null,null,Promise)}(o,t.id).then((function(){return a(!0)})))},removeVote:function(){null!=o&&o.login&&("post"==e?function(e,t){return m.a.async((function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",ge(e,"DELETE","posts/"+t+"/your_vote"));case 1:case"end":return n.stop()}}),null,null,null,Promise)}(o,t.id).then((function(){return a(!1)})):function(e,t){return m.a.async((function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",ge(e,"DELETE","comments/"+t+"/your_vote"));case 1:case"end":return n.stop()}}),null,null,null,Promise)}(o,t.id).then((function(){return a(!1)})))}}}function Ke(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function qe(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Ke(Object(n),!0).forEach((function(t){o()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Ke(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function Ye(e){var t=$(),n=He(),r=Je(e.type,e.content),o=r.isUpvoted,a=r.addVote,i=r.removeVote;var l=o?t.red:t.text;return c.a.createElement(C.a,{onPress:function(){return oe(re.a.Light),void(null!=n&&n.login?o?i():a():F.a.alert("Login to like","Leave a like when you login to a community"))},hitSlop:7,style:[Xe.root,e.style]},c.a.createElement(X,{style:Xe.root},c.a.createElement(N.a,{name:o?"heart":"heart-outline",color:l,size:25}),!e.hideCount&&c.a.createElement(Y,{style:qe(qe({},Xe.score),{},{color:l})},"  "+e.content.score+"  ")))}var Xe=B.a.create({root:qe({display:"flex",flexDirection:"row",alignItems:"center"},"web"==I.a.OS?{cursor:"pointer"}:{}),score:{fontSize:18,minWidth:28}}),Qe=n(162),Ze=n.n(Qe),et=n(269);function tt(e){var t=$(),n=Object(l.useMemo)((function(){return e.contentHtml||(""===(t=e.contentMarkdown)||void 0===t?void 0:t.replace(/^### (.*$)/gim,"<h3>$1</h3>").replace(/^## (.*$)/gim,"<h2>$1</h2>").replace(/^# (.*$)/gim,"<h1>$1</h1>").replace(/^\> (.*$)/gim,"<blockquote>$1</blockquote>").replace(/\*\*(.*)\*\*/gim,"<b>$1</b>").replace(/\*(.*)\*/gim,"<i>$1</i>").replace(/!\[(.*?)\]\((.*?)\)/gim,"<img alt='$1' src='$2' />").replace(/\[(.*?)\]\((.*?)\)/gim,"<a href='$2'>$1</a>").replace(/\n$/gim,"<br />").trim())||"<p>"+e.contentText+"</p>";var t}),[e.contentHtml,e.contentMarkdown,e.contentText]);return c.a.createElement(et.a,{RootComponent:function(e){return c.a.createElement(U.a,e)},value:n.replace(/\n/g,""),renderNode:nt(t),stylesheet:{a:{color:t.secondaryTint},cite:{fontStyle:"italic"},del:{textDecorationLine:"line-through",textDecorationStyle:"solid"},dfn:{fontStyle:"italic"},ins:{textDecorationLine:"underline"},samp:{fontFamily:"ios"===I.a.OS?"Menlo":"monospace"},small:{fontSize:10}},textComponentProps:{style:{color:t.text}},onLinkLongPress:function(e){return F.a.alert("Link",e,void 0,{cancelable:!0})}})}var nt=function(e){return function(t,n,r,o,a){if(["iframe","script"].includes(t.name||""))return null;function i(){return a(t.children,o)}switch(t.name){case"abbr":return c.a.createElement(C.a,{key:n,onPress:function(){return F.a.alert("Abbr.",t.attribs.title)}},c.a.createElement(U.a,{style:{textDecorationLine:"underline",textDecorationStyle:"dotted"}},i()));case"blockquote":return c.a.createElement(U.a,{key:n},c.a.createElement(A.a,{style:{padding:10}},c.a.createElement(A.a,{style:{borderLeftWidth:2,borderColor:e.secondaryText,paddingLeft:10,paddingVertical:5}},i())),"\n");case"details":return c.a.createElement(rt,{key:n},i());case"dl":case"dt":case"dd":return c.a.createElement(U.a,{key:n},i(),"\n");case"figure":return c.a.createElement(A.a,{key:n},i());case"hr":return c.a.createElement(A.a,{key:n,style:{width:200,alignSelf:"stretch",borderBottomWidth:B.a.hairlineWidth||1,borderColor:e.secondaryText}});case"kbd":return c.a.createElement(U.a,{key:n,style:{backgroundColor:e.tertiaryBackground}}," ",i()," ");case"img":return c.a.createElement(U.a,{key:n},"[Image not displayed]");case"li":return c.a.createElement(U.a,{key:n},"\u2022 ",i(),"\n");case"sub":return c.a.createElement(U.a,{key:n,style:{fontSize:10}},i());case"summary":return c.a.createElement(U.a,{key:n},i());case"sup":return c.a.createElement(A.a,{key:n},c.a.createElement(U.a,{style:{fontSize:10}},i()));default:return}}};function rt(e){var t=e.children,n=Object(l.useState)(!1),r=d()(n,2),o=r[0],a=r[1],i=$(),s=t.filter((function(e){return""!==e.props.children.toString().trim()})),u=Ze()(s),p=u[0],m=u.slice(1);return c.a.createElement(A.a,null,c.a.createElement(C.a,{hitSlop:5,onPress:function(){return a((function(e){return!e}))}},c.a.createElement(U.a,{style:{color:i.secondaryTint}},o?c.a.createElement(j.a,{name:"chevron-down-outline"}):c.a.createElement(j.a,{name:"chevron-forward-outline"}),p)),o&&m)}function ot(e){var t,n=$(),r=He(),o=e.colorize||"never",a=e.showHost||"only_foreign",i=e.userId&&e.userId==(null==r||null==(t=r.login)?void 0:t.user.id)||!1,l=function(e,t){return"always"===e||"never"!==e&&!t},s=l(o,e.local),u=l(a,e.local),d=i?{color:n.secondaryTint}:s?{color:e.local?n.blue:n.green}:{};return c.a.createElement(Y,{style:[at.root,e.style]},c.a.createElement(Y,{style:[at.name,d,e.styleName]},e.name),u&&c.a.createElement(Y,{style:[at.host,{color:n.secondaryText},e.styleHost]},e.newLine&&"\n",!e.newLine&&"@",e.host),i&&c.a.createElement(Y,{style:[at.host,{color:n.secondaryText},e.styleHost]}," (you)"))}var at=B.a.create({root:{},name:{fontWeight:"500"},host:{fontWeight:"200"}}),it=c.a.memo(ot);function lt(e){var t=Object(ae.b)(),n=He(),r=Object(ae.c)((function(t){return t.posts.posts[e]}));return Object(l.useEffect)((function(){n&&(r||ke(n,e).then((function(e){t(de({post:e}))})))}),[null==r?void 0:r.id]),r}function ct(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function st(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ct(Object(n),!0).forEach((function(t){o()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ct(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function ut(e){var t=lt(e.postId),n=Object(l.useState)(1),r=d()(n,2),o=r[0],a=r[1],i=Object(l.useMemo)((function(){return t&&(!!(e=t.href)&&[".png",".jpg",".jpeg",".bmp",".gif",".webp"].some((function(t){return e.endsWith(t)})));var e}),[null==t?void 0:t.href]),s=$();return t?c.a.createElement(X,null,c.a.createElement(Y,{style:dt.title},t.sticky&&c.a.createElement(c.a.Fragment,null,c.a.createElement(j.a,{name:"pin",size:25,color:s.secondaryTint})," "),t.title),t.href&&(i?c.a.createElement(V.a,{style:st(st({},dt.image),{},{aspectRatio:o,backgroundColor:s.secondaryBackground}),source:{uri:t.href},onLoad:function(e){return"web"!==I.a.OS&&a(Math.max(e.nativeEvent.source.width/e.nativeEvent.source.height,.5))}}):c.a.createElement(C.a,{style:[dt.link,{backgroundColor:s.secondaryBackground}],onPress:function(){oe(re.a.Medium),t.href&&Object(L.b)(t.href)}},c.a.createElement(Y,null,t.href))),e.showHtmlContent&&!!t.content_html&&c.a.createElement(X,{style:{padding:15}},c.a.createElement(tt,{contentHtml:t.content_html,contentText:t.content_text})),e.showAuthor&&c.a.createElement(X,{style:{display:"flex",flexDirection:"row",alignItems:"center",paddingHorizontal:15,paddingTop:15}},c.a.createElement(Y,{style:dt.by},"by","   "),c.a.createElement(it,{name:t.author.username,host:t.author.host,local:t.author.local,showHost:"only_foreign",colorize:"always",newLine:!0,userId:t.author.id})),c.a.createElement(X,{style:dt.foot},c.a.createElement(C.a,{hitSlop:8,onPress:function(){return e.navigation.navigate("Community",{community:t.community})},style:[dt.footItem,dt.pointer,{display:"flex",flexDirection:"row",alignItems:"center"}]},e.showAuthor&&c.a.createElement(Y,{style:dt.by},"in","   "),c.a.createElement(it,{name:t.community.name,host:t.community.host,local:t.community.local,showHost:"only_foreign",colorize:e.showAuthor?"always":"never",newLine:!0})),c.a.createElement(X,{style:{flex:1}}),c.a.createElement(X,{style:dt.footItem},c.a.createElement(ee,{time:t.created})),c.a.createElement(X,{style:dt.footItem},c.a.createElement(Y,{style:dt.footText},c.a.createElement(j.a,{name:"chatbubble-outline",size:12})," ",t.replies_count_total)),c.a.createElement(X,{style:dt.footItem},c.a.createElement(Ye,{type:"post",content:t})))):c.a.createElement(Y,null,"Failed to load post")}var dt=B.a.create({item:{marginVertical:0,marginHorizontal:0},pointer:st({},"web"==I.a.OS?{cursor:"pointer"}:{}),title:{fontSize:20,padding:15},contentText:{fontSize:12},link:st({paddingVertical:10,paddingHorizontal:15,borderRadius:5,marginHorizontal:15},"web"==I.a.OS?{cursor:"pointer"}:{}),image:{width:"100%",height:void 0,resizeMode:"contain"},foot:{display:"flex",flexDirection:"row",justifyContent:"space-between",alignItems:"center",width:"100%"},footText:{},footItem:{padding:15},by:{fontSize:11},score:{fontSize:18},actions:{display:"flex",flexDirection:"row",justifyContent:"space-around",alignItems:"center",padding:10}});function pt(e){var t=Object(ae.b)(),n=He(),r=Object(l.useState)([]),o=d()(r,2),a=o[0],i=o[1],c=Object(l.useState)(null),s=d()(c,2),u=s[0],p=s[1],f=Object(l.useState)(null),y=d()(f,2),g=y[0],h=y[1],b=Object(l.useState)(0),v=d()(b,2),E=v[0],O=v[1];return Object(l.useEffect)((function(){n&&function(e,t){var n,r,o,a,i=arguments;return m.a.async((function(l){for(;;)switch(l.prev=l.next){case 0:return n=i.length>2&&void 0!==i[2]?i[2]:"hot",r=i.length>3?i[3]:void 0,o=i.length>4?i[4]:void 0,a=[null===t?"posts?sort="+n:"posts?page="+t+"&sort="+n,"include_your=true",void 0!==r&&"in_your_follows="+r,o&&"community="+o].filter((function(e){return e})).join("&"),l.abrupt("return",ge(e,"GET",a).then((function(e){return e.json()})).then((function(e){return Te(Te({},e),{},{items:e.items.map(Ce)})})));case 5:case"end":return l.stop()}}),null,null,null,Promise)}(n,u,e.sort,e.inYourFollows,e.communityId).then((function(e){t(pe({posts:e.items})),i((function(t){return[].concat(ze()(t),ze()(e.items.map((function(e){return e.id}))))})),h(e.next_page)}))}),[u,E]),[a,function(){p(g),h(null)},function(){i([]),p(null),h(null),O((function(e){return e+1}))}]}var mt=n(47),ft=[{name:"Gold&Black",domain:"hoot.goldandblack.xyz"},{name:"Narwhal.City",domain:"narwhal.city"},{name:"FBXL",domain:"lotide.fbxl.net"},{name:"Tide C",domain:"c.tide.tk"},{name:"Exopla",domain:"lotide.exopla.net.eu.org"},{name:"Narwhal.City (Dev)",domain:"dev.narwhal.city"},{name:"Tide B",domain:"b.tide.tk"},{name:"Tide A",domain:"a.tide.tk"}],yt=function(e){return m.a.async((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",a.a.setItem("@lotide_ctx",JSON.stringify(e)));case 1:case"end":return t.stop()}}),null,null,null,Promise)},gt=function(){return m.a.async((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",a.a.getItem("@lotide_ctx").then((function(e){return null!==e?JSON.parse(e):void 0})));case 1:case"end":return e.stop()}}),null,null,null,Promise)},ht=function(e){var t;return m.a.async((function(n){for(;;)switch(n.prev=n.next){case 0:if(e.login){n.next=2;break}return n.abrupt("return");case 2:t=e.login.user.username+"@"+e.apiUrl,jt.store("@lotide_ctx_arr",t,e);case 4:case"end":return n.stop()}}),null,null,null,Promise)},bt=function(e){return m.a.async((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",jt.query("@lotide_ctx_arr",e));case 1:case"end":return t.stop()}}),null,null,null,Promise)},vt=function(){return m.a.async((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",jt.listKeys("@lotide_ctx_arr"));case 1:case"end":return e.stop()}}),null,null,null,Promise)},Et=function(e){return m.a.async((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",jt.remove("@lotide_ctx_arr",e));case 1:case"end":return t.stop()}}),null,null,null,Promise)},Ot=function(e){var t;return m.a.async((function(n){for(;;)switch(n.prev=n.next){case 0:if(e.login){n.next=2;break}return n.abrupt("return");case 2:t=e.login.user.username+"@"+e.apiUrl,jt.store("@lotide_ctx_arr",t,{apiUrl:e.apiUrl});case 4:case"end":return n.stop()}}),null,null,null,Promise)},wt=function(){var e;return m.a.async((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,m.a.awrap(a.a.getItem("@lotide_ctx_arr"));case 2:return e=t.sent,t.abrupt("return",e?JSON.parse(e):{});case 4:case"end":return t.stop()}}),null,null,null,Promise)},jt={store:function(e,t,n){var r,o;return m.a.async((function(i){for(;;)switch(i.prev=i.next){case 0:return i.next=2,m.a.awrap(a.a.getItem(e));case 2:return r=i.sent,o=r?JSON.parse(r):{},o[t]=n,i.next=7,m.a.awrap(a.a.setItem(e,JSON.stringify(o)));case 7:case"end":return i.stop()}}),null,null,null,Promise)},query:function(e,t){var n;return m.a.async((function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,m.a.awrap(a.a.getItem(e));case 2:return n=r.sent,r.abrupt("return",n?JSON.parse(n)[t]:void 0);case 4:case"end":return r.stop()}}),null,null,null,Promise)},listKeys:function(e){var t,n;return m.a.async((function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,m.a.awrap(a.a.getItem(e));case 2:return t=r.sent,n=t?JSON.parse(t):{},r.abrupt("return",Object.keys(n));case 5:case"end":return r.stop()}}),null,null,null,Promise)},remove:function(e,t){var n,r,o;return m.a.async((function(i){for(;;)switch(i.prev=i.next){case 0:return i.next=2,m.a.awrap(a.a.getItem(e));case 2:return n=i.sent,r=n?JSON.parse(n):{},o=r[t],delete r[t],i.next=8,m.a.awrap(a.a.setItem(e,JSON.stringify(r)));case 8:return i.abrupt("return",o);case 9:case"end":return i.stop()}}),null,null,null,Promise)}},xt=Object(ie.b)({name:"lotide",initialState:{ctx:null},reducers:{setCtx:function(e,t){e.ctx=t.payload}}}),Pt=xt.actions.setCtx,St=xt.reducer;function Tt(e){var t=Object(l.useState)(""),n=d()(t,2),r=n[0],o=n[1],a=Object(l.useState)(ft),i=d()(a,2),s=i[0],u=i[1],p=Object(l.useState)([]),m=d()(p,2),f=m[0],y=m[1],g=$(),h=Object(ae.b)();Object(l.useEffect)((function(){ft.map((function(e,t){return Pe({apiUrl:"https://"+e.domain+"/api/unstable"}).then((function(e){u((function(n){return n.map((function(n,r){return t!==r?n:{name:n.name,domain:n.domain,instanceInfo:e}}))}))})).catch((function(){u((function(e){return e.map((function(e,n){return t!==n?e:{name:e.name,domain:e.domain,instanceInfo:null}}))}))}))}))}),[]),Object(l.useEffect)((function(){wt().then((function(e){return Object.entries(e)})).then(y)}),[]);return c.a.createElement(mt.a,{contentContainerStyle:kt.root},c.a.createElement(Y,{style:kt.title},"Login to continue"),f.length>0&&c.a.createElement(Y,{style:kt.subtitle},"Select an existing profile"),f.map((function(t){var n,r=t[0].split("@"),o=d()(r,2),a=o[0],i=o[1],l=!!t[1].login,s=l?g.text:g.secondaryText,u=i.replace("http://","").replace("https://","").split(/[/?#]/)[0],p=null==(n=ft.find((function(e){return e.domain==u})))?void 0:n.name;return c.a.createElement(C.a,{key:t[0],onPress:function(){l?h(Pt(t[1])):e.onSelect(u.toLowerCase(),void 0,a)},style:{display:"flex",flexDirection:"row",alignItems:"center"}},c.a.createElement(j.a,{name:l?"lock-open-outline":"lock-closed-outline",color:s,style:{marginRight:10},size:20}),c.a.createElement(it,{name:a,host:u,local:!0,showHost:"always",newLine:!0,style:{paddingVertical:15,paddingBottom:10},styleName:{color:s}}),c.a.createElement(X,{style:{flex:1}}),c.a.createElement(Y,{style:{fontSize:16,color:s,fontFamily:"ios"===I.a.OS?"Georgia":"serif"}},p))})),c.a.createElement(Y,{style:kt.subtitle},f.length>0?"Or sign into a new acount":"Enter a host or select one below"),c.a.createElement(Q,{placeholder:"Host domain",style:{paddingVertical:10,paddingHorizontal:10},value:r,onChangeText:o,onSubmitEditing:function(){return e.onSelect(r.toLowerCase())},keyboardType:"url",returnKeyType:"next"}),s.filter((function(e){return""===r||e.domain.includes(r.toLowerCase())||e.name.toLowerCase().includes(r.toLowerCase())})).map((function(t){return c.a.createElement(X,{key:t.domain},function(t){var n,r=t.item,o=((null==(n=r.instanceInfo)?void 0:n.apiVersion)||0)>8,a=o?g.text:g.secondaryText;return c.a.createElement(X,{style:{borderBottomWidth:B.a.hairlineWidth||1,borderColor:g.secondaryText,paddingVertical:25}},c.a.createElement(C.a,{onPress:function(){return o&&e.onSelect(r.domain,r.name)}},c.a.createElement(it,{name:r.name,host:r.domain,local:!1,newLine:!0,styleName:{fontSize:24,fontWeight:"300",fontFamily:"ios"===I.a.OS?"Georgia":"serif",color:a}}),r.instanceInfo?c.a.createElement(c.a.Fragment,null,c.a.createElement(Y,{style:{color:g.secondaryText}},r.instanceInfo.software.name," ",r.instanceInfo.software.version,!o&&" - Out of date"),!!r.instanceInfo.description&&c.a.createElement(Y,{style:{color:a}},r.instanceInfo.description)):null===r.instanceInfo?c.a.createElement(Y,{style:{color:a}},"Failed to load info"):c.a.createElement(Y,{style:{color:a}},"Loading...")))}({item:t}))})))}var kt=B.a.create({root:{padding:20},title:{fontSize:24,marginBottom:10,textAlign:"center"},subtitle:{fontWeight:"300",marginBottom:10,marginTop:15,textAlign:"center"}}),Ct=n(38),It=n(54),zt=n(66),_t=n(30);function Dt(e){var t=Object(l.useState)(!1),n=d()(t,2),r=n[0],o=n[1],a=Object(l.useState)(e.username||""),i=d()(a,2),s=i[0],u=i[1],p=Object(l.useState)(""),f=d()(p,2),y=f[0],g=f[1],h=Object(l.useState)(""),b=d()(h,2),v=b[0],E=b[1],O=Object(l.useRef)(null),w=Object(l.useRef)(null),j=$(),x=Object(ae.b)(),P=Object(_t.p)();function S(e){F.a.alert("Failed to submit",e)}function T(){return s?y?v?void function(e,t,n,r){return m.a.async((function(o){for(;;)switch(o.prev=o.next){case 0:return o.abrupt("return",ge({apiUrl:e},"POST","users",{username:t,password:n,email_address:r,login:!0},!0).then((function(e){return e.json()})));case 1:case"end":return o.stop()}}),null,null,null,Promise)}("https://"+e.domain+"/api/unstable",s,y,v).then((function(t){x(Pt({apiUrl:"https://"+e.domain+"/api/unstable",login:t}))})).catch((function(e){F.a.alert("Failed to register",e),console.error(e)})):S("Please enter an email address"):S("Enter a password"):S("Please enter a username")}function k(){return s?y?void function(e,t,n){return m.a.async((function(r){for(;;)switch(r.prev=r.next){case 0:return r.abrupt("return",ge({apiUrl:e},"POST","logins",{username:t,password:n},!0).then((function(e){return e.json()})));case 1:case"end":return r.stop()}}),null,null,null,Promise)}("https://"+e.domain+"/api/unstable",s,y).then((function(t){x(Pt({apiUrl:"https://"+e.domain+"/api/unstable",login:t}))})).catch((function(e){F.a.alert("Failed to login",e),console.error(e)})):S("Enter a password"):S("Please enter a username")}function z(){r?T():k()}return c.a.createElement(C.a,{style:{flex:1},onPress:function(){return"web"!==I.a.OS&&It.a.dismiss()}},c.a.createElement(zt.a,{style:Lt.root,behavior:"padding"},e.hostName?c.a.createElement(C.a,{style:{alignItems:"center"}},c.a.createElement(Y,{style:Lt.name},e.hostName),c.a.createElement(Y,{style:[Lt.domain,{color:j.secondaryText}]},e.domain)):c.a.createElement(C.a,null,c.a.createElement(Y,{style:{fontSize:24}},e.domain)),c.a.createElement(C.a,{hitSlop:5,onPress:function(){return o((function(e){return!e}))}},c.a.createElement(Y,{style:[Lt.loginRegister,{color:j.secondaryText}]},c.a.createElement(Y,{style:{color:r?j.secondaryText:j.secondaryTint}},"Login")," | ",c.a.createElement(Y,{style:{color:r?j.secondaryTint:j.secondaryText}},"Register"))),r&&c.a.createElement(Q,{style:Lt.input,placeholder:"Email Address",value:v,onChangeText:E,keyboardType:"email-address",textContentType:"emailAddress",autoCompleteType:"email",returnKeyType:"next",onSubmitEditing:function(){var e;return null==(e=O.current)?void 0:e.focus()}}),c.a.createElement(Q,{ref:O,style:Lt.input,placeholder:"Username",value:s,onChangeText:u,keyboardType:"ascii-capable",textContentType:"username",autoCompleteType:"username",returnKeyType:"next",onSubmitEditing:function(){var e;return null==(e=w.current)?void 0:e.focus()}}),c.a.createElement(Q,{ref:w,style:Lt.input,placeholder:"Password",value:y,onChangeText:g,secureTextEntry:!0,textContentType:r?"newPassword":"password",autoCompleteType:"password",returnKeyType:"done",onSubmitEditing:z}),!r&&c.a.createElement(C.a,{style:{padding:15},onPress:function(){return P.navigate("ForgotPassword",{node:e.domain})}},c.a.createElement(Y,{secondary:!0},"Forgot Password")),c.a.createElement(X,{style:Lt.actionButtons},c.a.createElement(Ct.a,{title:"Change Host",onPress:e.onGoBack,color:j.secondaryTint}),c.a.createElement(Ct.a,{title:r?"Register":"Login",onPress:z,color:j.tint}))))}var Lt=B.a.create({root:{flex:1,alignItems:"center",justifyContent:"center",padding:35},name:{fontSize:50,fontFamily:"ios"===I.a.OS?"Georgia":"serif"},domain:{fontWeight:"300"},loginRegister:{padding:15},input:{width:"100%",marginVertical:5,paddingHorizontal:20,paddingVertical:10},actionButtons:{width:"100%",display:"flex",flexDirection:"row",justifyContent:"space-around"}});function Rt(){var e=Object(l.useState)(),t=d()(e,2),n=t[0],r=t[1],o=Object(l.useState)(),a=d()(o,2),i=a[0],s=a[1],u=Object(l.useState)(),p=d()(u,2),m=p[0],f=p[1];return c.a.createElement(X,{style:Bt.root},i?c.a.createElement(Dt,{hostName:n,domain:i,username:m,onGoBack:function(){return s(void 0)}}):c.a.createElement(Tt,{onSelect:function(e,t,n){r(t),s(e),f(n)}}))}var Bt=B.a.create({root:{width:"100%",height:"100%"},container:{flex:1,alignItems:"center",justifyContent:"center"},input:{width:"100%",marginBottom:20,paddingHorizontal:20,paddingVertical:10},actionButtons:{display:"flex",flexDirection:"row",justifyContent:"space-around",width:"100%"}}),Ht=n(149);function Vt(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Nt(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Vt(Object(n),!0).forEach((function(t){o()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Vt(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function Ft(e){if("ios"!==I.a.OS)return c.a.createElement(A.a,{style:e.style},e.children);var t=e.distanceToActivate||60,n=Object(l.useState)(!1),r=d()(n,2),o=r[0],a=r[1],i=Object(l.useState)(0),s=d()(i,2),u=s[0],p=s[1],m=Object(l.useState)(!1),f=d()(m,2),y=f[0],g=f[1],h=Object(l.useState)(!1),b=d()(h,2),v=b[0],E=b[1],O=Object(l.useState)(!1),w=d()(O,2),x=w[0],P=w[1],S=Object(Ht.a)(),T=Object(l.useRef)(null);return Object(l.useEffect)((function(){u<0&&!y?(oe(re.a.Light),g(!0)):u>=0&&y&&(g(!1),o||(P(!0),e.onLeftSide())),u>=2*t&&!v?(oe(re.a.Light),E(!0)):u<2*t&&v&&(E(!1),o||(P(!0),e.onRightSide())),u==t&&(null==e.onReturnToCenter||e.onReturnToCenter(),E(!1),g(!1),P(!1))}),[u]),c.a.createElement(mt.a,{ref:T,horizontal:!0,snapToOffsets:[t,t+S.width],snapToStart:!1,snapToEnd:!1,onScrollBeginDrag:function(){return a(!0)},onScrollEndDrag:function(){var e;null==(e=T.current)||e.scrollTo({x:t}),a(!1)},contentOffset:{x:t,y:0},onScroll:function(e){var t,n,r=null==e||null==(t=e.nativeEvent)||null==(n=t.contentOffset)?void 0:n.x;p(r)},scrollEventThrottle:100,showsHorizontalScrollIndicator:!1,style:Nt({backgroundColor:e.backgroundColor},e.style),overScrollMode:"always"},c.a.createElement(A.a,{style:{width:t,display:"flex",justifyContent:"center",alignItems:"center"}},c.a.createElement(j.a,{name:e.iconLeftSide[+y||+x],color:e.colorLeftSide,size:25})),c.a.createElement(A.a,{style:{width:S.width}},e.children),c.a.createElement(A.a,{style:{width:t,display:"flex",justifyContent:"center",alignItems:"center"}},c.a.createElement(j.a,{name:e.iconRightSide[+v||+x],color:e.colorRightSide,size:25})))}function Wt(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Mt(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Wt(Object(n),!0).forEach((function(t){o()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Wt(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function Ut(e){e.navigation;var t=e.route.params.sort,n=He(),r=pt({sort:t,inYourFollows:!0}),o=d()(r,3),a=o[0],i=o[1],l=o[2];if(null==n||!n.login)return c.a.createElement(Rt,null);return c.a.createElement(X,{style:At.container},c.a.createElement(H.a,{data:a,renderItem:function(e){var t=e.item;return c.a.createElement(Gt,{postId:t})},keyExtractor:function(e,t){return e+"-"+t},refreshing:0==a.length,onRefresh:l,onEndReachedThreshold:2,onEndReached:i}))}var At=B.a.create({container:{flex:1},item:{marginVertical:0,marginHorizontal:0,borderBottomWidth:8},title:{fontSize:20,padding:15,color:"#eee"},contentText:{fontSize:12},link:{paddingVertical:10,paddingHorizontal:15,backgroundColor:"#8884",borderRadius:5,marginHorizontal:15},image:{width:"100%",height:void 0,resizeMode:"contain"},foot:{display:"flex",flexDirection:"row",justifyContent:"space-between",alignItems:"center",width:"100%",padding:15},footText:{color:"#ccc"},by:{fontSize:11},score:{fontSize:18,color:"#bbb"}}),Gt=function(e){var t=e.postId,n=Object(ae.c)((function(e){return e.posts.posts[t]})),r=Je("post",n),o=r.isUpvoted,a=r.addVote,i=r.removeVote,s=Object(l.useState)(!1),u=d()(s,2),p=u[0],m=u[1],f=$(),y=Object(_t.p)();return c.a.createElement(Ft,{iconLeftSide:o!==p?["heart-dislike","heart-dislike-outline"]:["heart-outline","heart"],iconRightSide:["arrow-undo-outline","arrow-undo"],colorLeftSide:f.red,colorRightSide:f.blue,onLeftSide:function(){o?i():a(),m(!0)},onRightSide:function(){y.navigate("Reply",{id:n.id,title:n.title,html:n.content_html,type:"post"})},onReturnToCenter:function(){return m(!1)},backgroundColor:f.secondaryBackground,style:{borderBottomWidth:8,borderColor:f.secondaryBackground}},c.a.createElement(C.a,{style:Mt({width:"100%"},"web"==I.a.OS?{cursor:"pointer"}:{}),onPress:function(){return y.navigate("Post",{postId:t})},onLongPress:function(){oe(re.a.Heavy),console.log(n)}},c.a.createElement(X,{style:[]},c.a.createElement(ut,{postId:t,navigation:y}))))};function $t(e){var t,n=Object(l.useState)(),r=d()(n,2),o=r[0],a=r[1],i=Object(l.useState)(""),s=d()(i,2),u=s[0],p=s[1],m=He(),f=$(),y=e.onlyWhenTyping&&""===u?[]:o?""===u?o.items:o.items.filter((function(e){return e.name.toLowerCase().includes(u.toLowerCase())})):[];Object(l.useEffect)((function(){m&&be(m,!1).then(a)}),[null==m||null==(t=m.login)?void 0:t.token,e.focusId]);return c.a.createElement(H.a,{data:y,renderItem:function(t){var n,r,o,a=t.item;return c.a.createElement(C.a,{onPress:function(){return e.onSelect(a)},style:[Jt.item,{borderColor:f.tertiaryBackground}]},c.a.createElement(A.a,{style:{flex:1,flexDirection:"row",justifyContent:"space-between",alignItems:"center"}},c.a.createElement(it,{name:a.name,host:a.host,local:a.local,colorize:"always",newLine:!0}),c.a.createElement(A.a,{style:{display:"flex",flexDirection:"row"}},a.you_are_moderator&&c.a.createElement(j.a,{name:"shield-outline",size:20,color:f.secondaryTint}),(null==(n=a.your_follow)?void 0:n.accepted)&&c.a.createElement(j.a,{name:"checkmark",size:20,color:f.secondaryTint,style:{marginLeft:5}}))),!!a.description&&a.description.length>0&&c.a.createElement(U.a,{style:{color:f.secondaryText,marginTop:10}},null==(r=a.description)?void 0:r.substring(0,120),((null==(o=a.description)?void 0:o.length)||0)>120&&"..."))},keyExtractor:function(e,t){return e.id+"-"+t},contentContainerStyle:Jt.list,stickyHeaderIndices:[0],ListHeaderComponent:c.a.createElement(A.a,{style:{backgroundColor:f.background,padding:15}},c.a.createElement(G.a,{placeholder:e.placeholder||"Filter communities",placeholderTextColor:f.placeholderText,value:u,onChangeText:p,style:[Jt.input,{color:f.text}]}))})}var Jt=B.a.create({input:{marginHorizontal:25,paddingVertical:10},list:{paddingBottom:50},item:{display:"flex",flexDirection:"column",justifyContent:"space-between",alignItems:"stretch",paddingVertical:10,borderTopWidth:B.a.hairlineWidth||1,paddingHorizontal:20,marginHorizontal:20}});function Kt(e){var t=e.navigation,n=Object(l.useState)(0),r=d()(n,2),o=r[0],a=r[1],i=He();return Object(l.useEffect)((function(){return t.addListener("focus",(function(){return a((function(e){return e+1}))}))}),[]),null!=i&&i.login?c.a.createElement($t,{onSelect:function(e){return t.navigate("Community",{community:e})},focusId:o}):c.a.createElement(Rt,null)}function qt(e){var t,n,r,o=e.navigation,a=Object(l.useState)(),i=d()(a,2),s=i[0],u=i[1],p=Object(l.useState)([]),m=d()(p,2),f=m[0],y=m[1],g=Object(l.useState)([]),h=d()(g,2),b=h[0],v=h[1],E=Object(l.useState)(!1),O=d()(E,2),w=O[0],x=O[1],P=Object(l.useState)(0),S=d()(P,2),T=S[0],k=S[1],z=$(),_=He(),D=Object(ae.b)();if(Object(l.useEffect)((function(){return o.addListener("focus",(function(){return k((function(e){return e+1}))}))}),[]),Object(l.useEffect)((function(){null!=_&&_.login&&be(_,!0).then((function(e){return v(e.items)}))}),[null==_||null==(t=_.login)?void 0:t.user.id,T]),Object(l.useEffect)((function(){var e;void 0!==(null==_?void 0:_.login)&&void 0!==_.login.user&&Ee(_,(null==(e=_.login)?void 0:e.user.id)||0).then(u)}),[null==_||null==(n=_.login)?void 0:n.token,T]),Object(l.useEffect)((function(){vt().then((function(e){return y(e)}))}),[_,T]),void 0===(null==_?void 0:_.login))return c.a.createElement(Rt,null);return c.a.createElement(mt.a,{style:[Yt.container,{backgroundColor:z.background}]},c.a.createElement(X,{style:Yt.header},c.a.createElement(X,null,c.a.createElement(C.a,{hitSlop:10,onPress:function(){return x((function(e){return!e}))}},c.a.createElement(Y,{style:Yt.title},(null==s?void 0:s.username)||_.login.user.username,"  ",c.a.createElement(j.a,{name:"pencil-outline",size:20,color:z.secondaryText}))),c.a.createElement(Y,{style:{color:z.secondaryText}},null==s?void 0:s.host),!(null==s||!s.avatar)&&c.a.createElement(Y,null,null==s||null==(r=s.avatar)?void 0:r.url),!(null==s||!s.description)&&c.a.createElement(Y,null,null==s?void 0:s.description)),c.a.createElement(Ct.a,{onPress:function(){var e;null!=_&&_.login&&("web"!==I.a.OS?F.a.alert("Log out","Would you like to keep the login profile handy for later?",[{text:"Cancel",style:"cancel"},{text:"Remove",onPress:function(){var e;Et((null==(e=_.login)?void 0:e.user.username)+"@"+_.apiUrl).then((function(){return Be(_)})).then((function(){return D(Pt({}))}))}},{text:"Keep",style:"default",onPress:function(){Ot(_),D(Pt({}))}}],{cancelable:!0}):Et((null==(e=_.login)?void 0:e.user.username)+"@"+_.apiUrl).then((function(){return Be(_)})).then((function(){return D(Pt({}))})))},title:"Log Out",color:z.secondaryTint,accessibilityLabel:"Log out of the Hoot network"})),w&&c.a.createElement(X,{style:Yt.editView},c.a.createElement(Q,{style:Yt.editViewText,placeholder:"New email"}),c.a.createElement(Q,{style:Yt.editViewText,placeholder:"User bio",multiline:!0}),c.a.createElement(Q,{style:Yt.editViewText,placeholder:"New password"}),c.a.createElement(Q,{style:Yt.editViewText,placeholder:"Confirm new password"}),c.a.createElement(X,{style:Yt.editViewActionButtons},c.a.createElement(Ct.a,{onPress:function(){return x(!1)},title:"Cancel",color:z.secondaryTint,accessibilityLabel:"Add profile"}),c.a.createElement(Ct.a,{onPress:function(){return F.a.alert("unimplemented")},title:"Submit",color:z.tint,accessibilityLabel:"Add profile"}))),c.a.createElement(X,{style:Yt.buttonView},c.a.createElement(Ct.a,{onPress:function(){return D(Pt({}))},title:"Add Profile",color:z.tint,accessibilityLabel:"Add profile"})),f.map((function(e){return[e].concat(ze()(e.split("@")))})).map((function(e){return[e[0],e[1],e[2].replace("http://","").replace("https://","").split(/[/?#]/)[0]]})).map((function(e){return c.a.createElement(C.a,{key:e[0],style:[Yt.altProfileButton,{borderColor:z.secondaryBackground}],onPress:function(){bt(e[0]).then((function(e){void 0!==e&&(D(Pt(e)),yt(e),x(!1))}))}},c.a.createElement(it,{name:e[1],host:e[2],local:!0,showHost:"always",colorize:"never",newLine:!0}))})),c.a.createElement(X,{style:[Yt.buttonView,{paddingTop:10}]},c.a.createElement(Ct.a,{onPress:function(){return o.navigate("NewCommunity")},title:"Create Community",color:z.tint,accessibilityLabel:"Create a new community"})),c.a.createElement(Y,{style:Yt.followingTitle},"Communities You Follow:"),b.map((function(e){return c.a.createElement(X,{key:e.id,style:[Yt.altProfileButton,{borderColor:z.secondaryBackground}]},c.a.createElement(it,{name:e.name,host:e.host,local:e.local,showHost:"always",colorize:"always",newLine:!0}))})))}var Yt=B.a.create({container:{height:"100%"},header:{display:"flex",flexDirection:"row",justifyContent:"space-between",alignItems:"flex-start",padding:20},title:{fontSize:20,fontWeight:"bold"},followingTitle:{fontSize:18,fontWeight:"500",padding:20},editView:{margin:20},editViewText:{marginBottom:15,paddingVertical:10,paddingHorizontal:15},editViewActionButtons:{display:"flex",flexDirection:"row",justifyContent:"space-around"},buttonView:{display:"flex",alignItems:"center"},separator:{marginVertical:30,height:1,width:"80%"},inputContainer:{width:"100%",padding:20},input:{height:40,borderWidth:1,paddingVertical:10,paddingHorizontal:20,width:"100%",borderRadius:8},altProfileButton:{marginHorizontal:20,paddingVertical:15,borderBottomWidth:1}}),Xt=n(148);function Qt(e){var t,n=e.navigation,r=e.route,o=Object(ae.b)(),a=Object(l.useState)(r.params.community),i=d()(a,2),s=i[0],u=i[1],p=Object(l.useState)(""),f=d()(p,2),y=f[0],g=f[1],h=Object(l.useState)(""),b=d()(h,2),v=b[0],E=b[1],O=Object(l.useState)(""),w=d()(O,2),j=w[0],x=w[1],P=$(),S=He();if(Object(l.useEffect)((function(){return n.addListener("focus",(function(){return r.params.community?u(r.params.community):null===s?u(void 0):void 0}))}),[s,null==s?void 0:s.id,null==(t=r.params.community)?void 0:t.id]),null==S||!S.login)return c.a.createElement(Rt,null);if(null===s)return c.a.createElement($t,{onSelect:u,onlyWhenTyping:!0});return c.a.createElement(zt.a,{style:{width:"100%",height:"100%"}},c.a.createElement(Xt.a,{onPress:function(){return"web"!==I.a.OS&&It.a.dismiss()}},c.a.createElement(X,{style:Zt.container},c.a.createElement(C.a,{onPress:function(){return u(null)}},s?c.a.createElement(it,{name:s.name,host:s.host,local:s.local,colorize:"always",showHost:"always",newLine:!0,style:Zt.input}):c.a.createElement(Y,{style:[Zt.input,{color:P.secondaryText}]},"Select a Community")),c.a.createElement(G.a,{style:[Zt.input,Zt.title,{color:P.text}],placeholder:"Add a Title",placeholderTextColor:P.placeholderText,value:y,onChangeText:g}),y.length>=4?c.a.createElement(c.a.Fragment,null,c.a.createElement(G.a,{style:[Zt.input,{color:P.text}],placeholder:"Link",placeholderTextColor:P.placeholderText,value:v,onChangeText:E,keyboardType:"url",textContentType:"URL"}),c.a.createElement(Q,{style:{marginVertical:20,minHeight:100},multiline:!0,placeholder:"Add post content",value:j,onChangeText:x})):c.a.createElement(Y,{style:{color:P.secondaryText}},y.length>0&&4-y.length),!!s&&y.length>=4&&c.a.createElement(Ct.a,{onPress:function(){S&&s&&function(e,t){return m.a.async((function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",ge(e,"POST","posts",t).then((function(e){return e.json()})));case 1:case"end":return n.stop()}}),null,null,null,Promise)}(S,{community:s.id,title:y,href:v||void 0,content_markdown:j||" "}).then((function(e){ke(S,e.id).then((function(e){u(void 0),g(""),E(""),x(""),o(de({post:e})),n.navigate("Post",{postId:e.id})}))})).catch((function(e){return F.a.alert("Could not submit post",e)}))},title:"Submit",color:P.tint,accessibilityLabel:"Submit new post"}))))}var Zt=B.a.create({container:{flex:1,alignItems:"stretch",padding:15,height:"100%",width:"100%"},title:{fontSize:20,fontWeight:"bold"},separator:{marginVertical:30,height:1,width:"80%"},inputContainer:{width:"100%",padding:20},input:{paddingVertical:10,width:"100%",borderRadius:8},item:{paddingHorizontal:20,paddingVertical:10,marginHorizontal:20,marginBottom:1}});function en(){return c.a.createElement(X,null,c.a.createElement(Y,null,"Settings screen. It'll be implemented eventually."))}function tn(e){var t=e.route,n=Object(l.useState)(t.params.community),r=d()(n,2),o=r[0],a=r[1],i=pt({sort:"hot",communityId:o.id}),s=d()(i,3),u=s[0],p=s[1],m=s[2],f=Object(l.useState)(0),y=d()(f,2),g=y[0],h=y[1],b=$(),v=He();Object(l.useEffect)((function(){v&&ve(v,o.id).then(a)}),[null==v?void 0:v.apiUrl,t.params.community.id,t.params.community.description,g]);return c.a.createElement(X,{style:[nn.root,{backgroundColor:b.background}]},c.a.createElement(H.a,{data:u,renderItem:function(e){var t=e.item;return c.a.createElement(rn,{postId:t})},ListHeaderComponent:c.a.createElement(on,{community:o,setReloadId:h}),keyExtractor:function(e,t){return e+"-"+t},refreshing:0==u.length,onRefresh:m,onEndReachedThreshold:2,onEndReached:p}))}var nn=B.a.create({root:{height:"100%"},header:{padding:20,paddingVertical:15,borderBottomWidth:B.a.hairlineWidth||1},title:{fontSize:20},description:{marginTop:10},buttons:{display:"flex",flexDirection:"row",width:"100%",justifyContent:"space-around",alignItems:"center"},item:{marginVertical:0,marginHorizontal:0,borderBottomWidth:8}}),rn=function(e){var t=e.postId,n=$(),r=Object(_t.p)();return c.a.createElement(C.a,{onPress:function(){return r.navigate("Post",{postId:t})},onLongPress:function(){oe(re.a.Heavy)}},c.a.createElement(X,{style:[nn.item,{borderBottomColor:n.secondaryBackground}]},c.a.createElement(ut,{postId:t,navigation:r})))},on=c.a.memo((function(e){var t,n=$(),r=Object(_t.p)(),o=e.community,a=e.setReloadId,i=He(),l=(null==(t=o.your_follow)?void 0:t.accepted)||!1;return c.a.createElement(X,{style:[nn.header,{borderBottomColor:n.tertiaryBackground}]},c.a.createElement(X,null,c.a.createElement(ot,{name:o.name,host:o.host,local:o.local,newLine:!0,colorize:"always",showHost:"always",styleName:[nn.title]}),""!==o.description&&c.a.createElement(Y,{style:nn.description},o.description)),!!i&&c.a.createElement(X,{style:[nn.buttons]},c.a.createElement(Ct.a,{onPress:function(){return r.navigate("NewPostScreen",{community:o})},title:"Post",color:n.tint,accessibilityLabel:"Post to this community"}),o.you_are_moderator&&c.a.createElement(Ct.a,{onPress:function(){return r.navigate("EditCommunity",{community:o})},title:"Edit",color:n.tint,accessibilityLabel:"Edit your community community"}),l?c.a.createElement(Ct.a,{onPress:function(){i&&function(e,t){return m.a.async((function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",ge(e,"POST","communities/"+t+"/unfollow"));case 1:case"end":return n.stop()}}),null,null,null,Promise)}(i,o.id).then((function(){a((function(e){return e+1}))}))},title:"Unfollow",color:n.secondaryTint,accessibilityLabel:"Stop seeing posts from this community"}):c.a.createElement(Ct.a,{onPress:function(){i&&Oe(i,o.id).then((function(e){!1===e.accepted&&F.a.alert("Follow request rejected.","This could be an issue with the node you are connected to."),a((function(e){return e+1}))}))},title:"Follow",color:n.tint,accessibilityLabel:"See posts from this community in your feed"})))})),an=n(98);function ln(e){var t=e.navigation,n=e.route,r=Object(l.useState)(""),o=d()(r,2),a=o[0],i=o[1],s=Object(l.useRef)(null),u=$(),p=He(),f=n.params.id,y=n.params.title,g=n.params.html,h=n.params.type;return c.a.createElement(zt.a,{behavior:"ios"===I.a.OS?"padding":"height"},c.a.createElement(an.b,{ref:s},c.a.createElement(C.a,{style:cn.root,onPress:function(){return"web"!==I.a.OS&&It.a.dismiss()}},c.a.createElement(Y,null,"Reply to ",h),!!y&&c.a.createElement(Y,{style:cn.title},y),!!g&&c.a.createElement(tt,{contentHtml:g}),c.a.createElement(Q,{style:cn.input,multiline:!0,placeholder:"Type your reply",value:a,onChangeText:i,onFocus:function(){s.current&&s.current.scrollToEnd({animated:!0})}}),c.a.createElement(Ct.a,{title:"Submit",color:u.tint,onPress:function(){null!=p&&p.login&&("post"===h?function(e,t,n){return m.a.async((function(r){for(;;)switch(r.prev=r.next){case 0:return r.abrupt("return",ge(e,"POST","posts/"+t+"/replies",{content_markdown:n}).then((function(e){return e.json()})));case 1:case"end":return r.stop()}}),null,null,null,Promise)}(p,f,a).then((function(){return t.pop()})):function(e,t,n){return m.a.async((function(r){for(;;)switch(r.prev=r.next){case 0:return r.abrupt("return",ge(e,"POST","comments/"+t+"/replies",{content_markdown:n}).then((function(e){return e.json()})));case 1:case"end":return r.stop()}}),null,null,null,Promise)}(p,f,a).then((function(){return t.pop()})))}}))))}var cn=B.a.create({root:{padding:20,paddingBottom:100},title:{fontSize:20,marginVertical:10},input:{marginVertical:20,minHeight:100}}),sn=n(51),un=n(145);function dn(e,t){var n=Object(ae.b)(),r=Object(ae.c)((function(n){var r,o;return"post"==e?null==(r=n.posts.posts[t])?void 0:r.replies:null==(o=n.replies.replies[t])?void 0:o.replies})),o=He();function a(){if(o&&(!r||null!==r.next_page))switch(e){case"post":(function(e,t,n){return m.a.async((function(r){for(;;)switch(r.prev=r.next){case 0:return r.abrupt("return",ge(e,"GET","posts/"+t+"/replies?limit=10&include_your=true"+(n?"&page="+n:"")).then((function(e){return e.json()})).then(Re));case 1:case"end":return r.stop()}}),null,null,null,Promise)})(o,t,(null==r?void 0:r.next_page)||void 0).then((function(e){var o,a;n(Me({replies:e[1]})),n(me({id:t,post:{replies:{items:[].concat(ze()((null==r?void 0:r.items)||[]),ze()((null==(o=e[0])?void 0:o.items)||[])),next_page:(null==(a=e[0])?void 0:a.next_page)||null}}}))}));break;case"reply":(function(e,t,n){return m.a.async((function(r){for(;;)switch(r.prev=r.next){case 0:return r.abrupt("return",ge(e,"GET","comments/"+t+"/replies?limit=10&include_your=true&sort=hot"+(n?"&page="+n:"")).then((function(e){return e.json()})).then(Re));case 1:case"end":return r.stop()}}),null,null,null,Promise)})(o,t,(null==r?void 0:r.next_page)||void 0).then((function(e){var o,a;n(Me({replies:e[1]})),n(Ue({id:t,reply:{replies:{items:[].concat(ze()((null==r?void 0:r.items)||[]),ze()((null==(o=e[0])?void 0:o.items)||[])),next_page:(null==(a=e[0])?void 0:a.next_page)||null}}}))}))}}return Object(l.useEffect)((function(){r||"post"!=e||a()}),[!!r]),{replies:r,loadNextPage:a}}function pn(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function mn(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?pn(Object(n),!0).forEach((function(t){o()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):pn(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function fn(e){var t=Object(ae.b)(),n=Object(ae.c)((function(t){return e?t.replies.replies[e]:void 0})),r=He();return Object(l.useEffect)((function(){r&&e&&(n||function(e,t){return m.a.async((function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",ge(e,"GET","comments/"+t,void 0,!0).then((function(e){return e.json()})).then(Le));case 1:case"end":return n.stop()}}),null,null,null,Promise)}(r,e).then((function(e){t(Me({replies:e}))})).catch((function(){return console.log("Reply "+e+" could not be loaded")})))}),[null==n?void 0:n.id]),n&&mn(mn({},n),{},{replies:void 0})}function yn(e){var t=e.parentType,n=e.parentId,r=e.navigation,o=e.layer,a=void 0===o?0:o,i=e.postId,l=e.highlightedReplies,s=void 0===l?[]:l,u=dn(t,n),d=u.replies,p=u.loadNextPage,m=$();if(!He())return null;var f=[m.text,m.red,m.orange,m.yellow,m.green,m.teal,m.blue,m.indigo,m.purple];return d?c.a.createElement(A.a,null,d.items.map((function(e){return c.a.createElement(gn,{replyId:e,layer:a,key:e,navigation:r,layerColors:f,postId:i,highlightedReplies:s})})),null!==d.next_page&&c.a.createElement(C.a,{hitSlop:5,onPress:p},c.a.createElement(Y,{style:{color:m.tint,paddingTop:5,paddingBottom:10}},"More replies ",c.a.createElement(j.a,{name:"chevron-down-outline"}))),null===d.next_page&&0===a&&c.a.createElement(Y,{style:{margin:17,color:m.secondaryText}},d.items.length>0?"No more replies":"No replies yet")):c.a.createElement(Y,null,"Can't find replies")}function gn(e){var t,n=e.replyId,r=e.layer,o=void 0===r?0:r,a=e.navigation,i=e.layerColors,l=e.postId,s=e.highlightedReplies,u=void 0===s?[]:s,p=fn(n),m=dn("reply",n),f=m.replies,y=m.loadNextPage,g=c.a.useState(!0),h=d()(g,2),b=h[0],v=h[1],E=$(),O=He(),w=function(){var e=Object(ae.b)();return[Object(ae.c)((function(e){return e.replies.selectedReply})),function(t){e(Ge(t))}]}(),x=d()(w,2),P=x[0],S=x[1];return O?p?c.a.createElement(A.a,{style:{paddingLeft:0}},c.a.createElement(A.a,{style:{paddingVertical:8,borderTopWidth:.5,borderTopColor:E.secondaryBackground}},c.a.createElement(C.a,{onPress:function(){return S(P!=p.id?p.id:void 0)}},c.a.createElement(A.a,{style:{borderLeftWidth:2,borderColor:i[o%i.length],paddingLeft:15,paddingVertical:3,backgroundColor:u.includes(p.id)?E.secondaryBackground:E.background}},c.a.createElement(A.a,{style:{display:"flex",flexDirection:"row",justifyContent:"space-between",flexWrap:"wrap",marginBottom:5}},c.a.createElement(it,{name:p.author.username,host:p.author.host,local:p.author.local,showHost:"only_foreign",colorize:"only_foreign",style:{fontSize:16,fontWeight:"500"},userId:p.author.id}),c.a.createElement(A.a,{style:{marginRight:15,display:"flex",flexDirection:"row",alignItems:"center"}},c.a.createElement(Y,null,!b&&"...    "),c.a.createElement(j.a,{name:p.your_vote?"heart":"heart-outline",size:14,color:E.text,light:!0}),c.a.createElement(Y,null," "+p.score+"   "),c.a.createElement(ee,{time:p.created}))),b&&!!p.content_html&&c.a.createElement(tt,{contentHtml:p.content_html,contentText:p.content_text})),P==p.id&&c.a.createElement(A.a,{style:hn.buttons},c.a.createElement(Ye,{type:"reply",content:p,hideCount:!0,style:hn.button}),c.a.createElement(C.a,{style:hn.button,onPress:function(){oe(re.a.Medium),a.navigate("Reply",{id:p.id,title:p.author.username,html:p.content_html,type:"reply"})}},c.a.createElement(j.a,{color:E.text,size:20,name:"arrow-undo-outline"})),c.a.createElement(C.a,{style:hn.button,onPress:function(){v((function(e){return!e}))}},c.a.createElement(j.a,{color:((null==(t=p.replies)?void 0:t.items.length)||0)>0?E.text:E.secondaryText,size:20,name:b?"chevron-up-outline":"chevron-down-outline"}))))),f&&f.items.length>0&&(b?c.a.createElement(A.a,{style:{paddingLeft:15}},c.a.createElement(yn,{parentType:"reply",parentId:n,layer:o+1,navigation:a,postId:l,highlightedReplies:u})):c.a.createElement(Y,null,"...")),void 0==f&&c.a.createElement(C.a,{hitSlop:5,onPress:y},c.a.createElement(A.a,{style:{paddingHorizontal:15,paddingBottom:10}},c.a.createElement(Y,{style:{color:E.tint}},"More replies ",c.a.createElement(j.a,{name:"chevron-forward-outline"}))))):c.a.createElement(Y,null,"Failed to load reply"):null}var hn=B.a.create({buttons:{display:"flex",flexDirection:"row",justifyContent:"flex-end",alignItems:"center",paddingHorizontal:15},button:{padding:10,paddingHorizontal:15}});function bn(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function vn(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?bn(Object(n),!0).forEach((function(t){o()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):bn(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function En(e){var t=e.navigation,n=e.route,r=lt(n.params.postId),o=Object(l.useState)(n.params.highlightedReplies),a=d()(o,2),i=a[0],s=a[1],u=$();return r?c.a.createElement(mt.a,null,c.a.createElement(X,{style:vn(vn({},On.item),{},{backgroundColor:u.background})},c.a.createElement(ut,{postId:r.id,navigation:t,showHtmlContent:!0,showAuthor:!0}),c.a.createElement(X,{style:On.actions},c.a.createElement(j.a,{name:"bookmark-outline",size:25,color:u.text}),c.a.createElement(C.a,{hitSlop:5,onPress:function(){oe(re.a.Medium),t.navigate("Reply",{id:r.id,title:r.title,html:r.content_html,type:"post"})}},c.a.createElement(j.a,{name:"arrow-undo-outline",size:25,color:u.text})),c.a.createElement(C.a,{hitSlop:5,onPress:function(){oe(re.a.Medium),un.a.share({message:r.title,url:"https://dev.goldandblack.xyz/p/posts/"+r.id,title:"Hoot"})}},c.a.createElement(j.a,{name:"share-outline",size:25,color:u.text}))),i&&c.a.createElement(C.a,{onPress:function(){return s(void 0)}},c.a.createElement(Y,{style:{color:u.tint,paddingVertical:10}},"Show all replies")),c.a.createElement(yn,{parentType:"post",parentId:r.id,navigation:t,postId:r.id,highlightedReplies:i}),c.a.createElement(X,{style:{height:300}}))):c.a.createElement(Y,null,"No post")}var On=B.a.create({container:{flex:1,marginTop:sn.a.currentHeight||0},item:{marginVertical:0,marginHorizontal:0},title:{fontSize:20,padding:15},contentText:{fontSize:12},link:{paddingVertical:10,paddingHorizontal:15,backgroundColor:"#8884",borderRadius:5,marginHorizontal:15},image:{width:"100%",height:void 0,resizeMode:"contain"},foot:{display:"flex",flexDirection:"row",justifyContent:"space-between",alignItems:"center",width:"100%",padding:15,borderBottomColor:"#8884",borderBottomWidth:2},by:{fontSize:11},actions:{display:"flex",flexDirection:"row",justifyContent:"space-around",alignItems:"center",padding:10}}),wn=n(102);function jn(e){var t=e.navigation;return l.createElement(A.a,{style:xn.container},l.createElement(U.a,{style:xn.title},"This screen doesn't exist."),l.createElement(wn.a,{onPress:function(){return t.replace("Root")},style:xn.link},l.createElement(U.a,{style:xn.linkText},"Go to home screen!")))}var xn=B.a.create({container:{flex:1,backgroundColor:"#fff",alignItems:"center",justifyContent:"center",padding:20},title:{fontSize:20,fontWeight:"bold"},link:{marginTop:15,paddingVertical:15},linkText:{fontSize:14,color:"#2e78b7"}});function Pn(e){var t=e.navigation,n=Object(l.useState)([]),r=d()(n,2),o=r[0],a=r[1],i=Object(l.useState)(!0),s=d()(i,2),u=s[0],p=s[1],f=Object(l.useState)(0),y=d()(f,2),g=y[0],h=y[1],b=He();if(Object(l.useEffect)((function(){null!=b&&b.login&&function(e){return m.a.async((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",ge(e,"GET","users/~me/notifications").then((function(e){return e.json()})).then((function(e){return e.map((function(e){return{unseen:(t=e).unseen,replyId:t.reply.id,origin:t.comment?{type:"reply",id:t.comment}:{type:"post",id:t.post.id},postId:t.post.id};var t}))})));case 1:case"end":return t.stop()}}),null,null,null,Promise)}(b).then(a).then((function(){return p(!1)}))}),[g]),Object(l.useEffect)((function(){return t.addListener("focus",(function(){return h((function(e){return e+1}))}))}),[]),null==b||!b.login)return c.a.createElement(Rt,null);return c.a.createElement(H.a,{style:Tn.container,data:o,renderItem:function(e){var t=e.item;return c.a.createElement(Sn,{item:t})},keyExtractor:function(e,t){return e.replyId+"-"+t},refreshing:u,onRefresh:function(){p(!0),h((function(e){return e+1}))}})}var Sn=function(e){var t=e.item,n=lt(t.postId),r=fn("reply"==t.origin.type?t.origin.id:void 0),o=fn(t.replyId),a=$(),i=Object(_t.p)();return n&&o&&("reply"!==t.origin.type||r)?c.a.createElement(C.a,{style:[Tn.item,{borderBottomColor:a.secondaryBackground}],onPress:function(){var e="reply"===t.origin.type?[t.origin.id,t.replyId]:[t.replyId];i.navigate("Post",{postId:t.postId,highlightedReplies:e})}},c.a.createElement(Y,null,"New reply to your ","post"==t.origin.type?"Post":"Reply"),c.a.createElement(Y,{style:Tn.title},n.title),c.a.createElement(it,{name:n.author.username,host:n.author.host,local:n.author.local,showHost:"only_foreign",colorize:"never",userId:n.author.id}),"reply"===t.origin.type&&r?c.a.createElement(c.a.Fragment,null,c.a.createElement(X,{style:[Tn.level1,{borderColor:a.secondaryText}]},c.a.createElement(it,{name:r.author.username,host:r.author.host,local:r.author.local,showHost:"only_foreign",colorize:"only_foreign",userId:r.author.id}),c.a.createElement(tt,{contentHtml:r.content_html,contentText:r.content_text})),c.a.createElement(X,{style:[Tn.level2,{borderColor:a.tint,backgroundColor:a.secondaryBackground}]},c.a.createElement(it,{name:o.author.username,host:o.author.host,local:o.author.local,showHost:"only_foreign",colorize:"only_foreign"}),c.a.createElement(tt,{contentHtml:o.content_html,contentText:o.content_text}))):c.a.createElement(c.a.Fragment,null,c.a.createElement(X,{style:[Tn.level1,{borderColor:a.tint,backgroundColor:a.secondaryBackground}]},c.a.createElement(it,{name:o.author.username,host:o.author.host,local:o.author.local,showHost:"only_foreign",colorize:"only_foreign"}),c.a.createElement(tt,{contentHtml:o.content_html,contentText:o.content_text}))),c.a.createElement(X,{style:Tn.community},c.a.createElement(it,{name:n.community.name,host:n.community.host,local:n.community.local,showHost:"always",colorize:"never",newLine:!0}))):null},Tn=B.a.create({container:{flex:1},item:{borderBottomWidth:5,padding:15},title:{fontSize:20,marginTop:15},level1:{marginTop:15,borderLeftWidth:2,paddingLeft:15,padding:5},level2:{marginTop:5,marginLeft:15,borderLeftWidth:2,paddingLeft:15,padding:5},name:{fontWeight:"600",marginBottom:3},thin:{fontWeight:"200"},community:{marginTop:15}});function kn(e){var t=e.navigation,n=Object(l.useState)(""),r=d()(n,2),o=r[0],a=r[1],i=Object(l.useState)(""),s=d()(i,2),u=s[0],p=s[1],f=$(),y=He();if(!y)return null;return c.a.createElement(X,{style:Cn.root},c.a.createElement(G.a,{style:[Cn.input,{fontSize:20,color:f.text}],placeholder:"Community Name",placeholderTextColor:f.placeholderText,value:o,onChangeText:a}),o.length>=4?c.a.createElement(c.a.Fragment,null,c.a.createElement(G.a,{style:[Cn.input,{color:f.text}],placeholder:"Description (Optional)",placeholderTextColor:f.placeholderText,value:u,onChangeText:p}),c.a.createElement(Ct.a,{title:"Submit",color:f.tint,onPress:function(){null!=y&&y.login&&function(e,t){return m.a.async((function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",ge(e,"POST","communities",{name:t}).then((function(e){return e.json()})));case 1:case"end":return n.stop()}}),null,null,null,Promise)}(y,o).then((function(e){var n,r;return m.a.async((function(o){for(;;)switch(o.prev=o.next){case 0:if(n=e.community.id,!u){o.next=4;break}return o.next=4,m.a.awrap(we(y,n,u));case 4:return o.next=6,m.a.awrap(Oe(y,n));case 6:return o.next=8,m.a.awrap(ve(y,n));case 8:r=o.sent,t.replace("Community",{community:r});case 10:case"end":return o.stop()}}),null,null,null,Promise)})).catch((function(e){return F.a.alert("Failed to create community",e)}))},accessibilityLabel:"Create new community"})):c.a.createElement(Y,null,o.length>0&&4-o.length))}var Cn=B.a.create({root:{flex:1,alignItems:"flex-start",padding:15,height:"100%",width:"100%"},title:{fontSize:20,fontWeight:"bold"},separator:{marginVertical:30,height:1,width:"80%"},inputContainer:{width:"100%",padding:20},input:{paddingVertical:10,width:"100%",borderRadius:8},item:{paddingHorizontal:20,paddingVertical:10,marginHorizontal:20,marginBottom:1}});function In(e){var t=e.navigation,n=e.route,r=Object(l.useState)(!1),o=d()(r,2),a=o[0],i=o[1],s=Object(l.useState)(""),u=d()(s,2),p=u[0],f=u[1],y=Object(l.useState)(),g=d()(y,2),h=g[0],b=g[1],v=Object(l.useState)(""),E=d()(v,2),O=E[0],w=E[1],j=$();return c.a.createElement(C.a,{style:{flex:1},onPress:function(){return"web"!==I.a.OS&&It.a.dismiss()}},c.a.createElement(zt.a,{style:zn.root,behavior:"padding"},c.a.createElement(C.a,null,c.a.createElement(Y,null,n.params.node)),a?c.a.createElement(c.a.Fragment,null,h?c.a.createElement(c.a.Fragment,null,c.a.createElement(Q,{placeholder:"New Password",style:zn.input,value:O,onChangeText:w,autoCapitalize:"none",secureTextEntry:!0,textContentType:"password",autoCompleteType:"password"}),c.a.createElement(X,{style:zn.actionButtons},c.a.createElement(Ct.a,{title:"Go Back",onPress:function(){return i(!1)},color:j.secondaryTint}),c.a.createElement(Ct.a,{title:"Submit",onPress:function(){return O?h?void(e={apiUrl:"https://"+n.params.node+"/api/unstable"},r=h,o=O,m.a.async((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",ge(e,"POST","forgot_password/keys/"+r+"/reset",{new_password:o},!0));case 1:case"end":return t.stop()}}),null,null,null,Promise)).then((function(){return t.popToTop()})):F.a.alert("No key","Fail. This shouldn't happen"):F.a.alert("Password required");var e,r,o},color:j.tint}))):c.a.createElement(Q,{placeholder:"Key",style:zn.input,onChangeText:function(e){e.length<6||function(e,t){return m.a.async((function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",ge(e,"GET","forgot_password/keys/"+t,void 0,!0));case 1:case"end":return n.stop()}}),null,null,null,Promise)}({apiUrl:"https://"+n.params.node+"/api/unstable"},e).then((function(){return b(e)}))},autoCapitalize:"none"})):c.a.createElement(c.a.Fragment,null,c.a.createElement(Q,{style:zn.input,placeholder:"Email Address",value:p,onChangeText:f,keyboardType:"email-address",textContentType:"emailAddress",autoCompleteType:"email",returnKeyType:"go",autoCapitalize:"none"}),c.a.createElement(Ct.a,{title:"Submit",onPress:function(){if(!p)return F.a.alert("Email address required","An email with a password reset key will be emailed to you");(function(e,t){return m.a.async((function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",ge(e,"POST","forgot_password/keys",{email_address:t},!0));case 1:case"end":return n.stop()}}),null,null,null,Promise)})({apiUrl:"https://"+n.params.node+"/api/unstable"},p).then((function(){i(!0)})).catch((function(e){return F.a.alert("Failed to send reset key",e)}))},color:j.tint}))))}var zn=B.a.create({root:{flex:1,alignItems:"center",justifyContent:"center",padding:30},input:{width:"100%",paddingVertical:10,paddingHorizontal:15,marginTop:15},actionButtons:{display:"flex",width:"100%",flexDirection:"row",justifyContent:"space-around"}});function _n(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Dn(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?_n(Object(n),!0).forEach((function(t){o()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):_n(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function Ln(e){var t=e.navigation,n=e.route.params.community,r=Object(l.useState)(n.description||""),o=d()(r,2),a=o[0],i=o[1],s=$(),u=He();return c.a.createElement(zt.a,{behavior:"ios"===I.a.OS?"padding":"height"},c.a.createElement(C.a,{style:Rn.root,onPress:function(){return"web"!==I.a.OS&&It.a.dismiss()}},c.a.createElement(it,{name:n.name,host:n.host,local:n.local,showHost:"always",newLine:!0,style:Rn.title}),c.a.createElement(Q,{style:Rn.input,multiline:!0,placeholder:"Add a description",value:a,onChangeText:i}),c.a.createElement(Ct.a,{title:"Submit",color:s.tint,onPress:function(){u&&we(u,n.id,a).then((function(){return ve(u,n.id)})).then((function(e){return t.navigate("Community",{community:Dn(Dn({},e),{},{description:a})})})).catch((function(e){return F.a.alert("Failed to edit community",e)}))}})))}var Rn=B.a.create({root:{padding:20,paddingBottom:100},title:{fontSize:20,marginVertical:10},input:{marginVertical:20,minHeight:100}});function Bn(e){var t=e.colorScheme;return c.a.createElement(x.a,{linking:R,theme:"dark"===t?P.a:S.a},c.a.createElement(Vn,null))}var Hn=Object(T.a)();function Vn(){return c.a.createElement(Hn.Navigator,null,c.a.createElement(Hn.Screen,{name:"Root",component:Fn,options:{headerShown:!1}}),c.a.createElement(Hn.Screen,{name:"Web",component:En}),c.a.createElement(Hn.Screen,{name:"Post",component:En}),c.a.createElement(Hn.Screen,{name:"Reply",component:ln}),c.a.createElement(Hn.Screen,{name:"Community",component:tn}),c.a.createElement(Hn.Screen,{name:"NewCommunity",component:kn}),c.a.createElement(Hn.Screen,{name:"EditCommunity",component:Ln}),c.a.createElement(Hn.Screen,{name:"Settings",component:en}),c.a.createElement(Hn.Screen,{name:"ForgotPassword",component:In,options:{title:"Forgot Password"}}),c.a.createElement(Hn.Screen,{name:"NotFound",component:jn,options:{title:"Oops!"}}),c.a.createElement(Hn.Group,{screenOptions:{presentation:"modal"}},c.a.createElement(Hn.Screen,{name:"Modal",component:En})))}var Nn=Object(k.a)();function Fn(e){var t=e.navigation,n=Object(l.useState)("hot"),r=d()(n,2),o=r[0],a=r[1],i=He(),s=E();return c.a.createElement(Nn.Navigator,{initialRouteName:"FeedScreen",screenOptions:{drawerActiveTintColor:_[s].tint,headerTintColor:_[s].text,headerPressColor:_[s].text,drawerType:"permanent",drawerHideStatusBarOnOpen:!0}},c.a.createElement(Nn.Screen,{name:"FeedScreen",component:Ut,initialParams:{sort:o},options:function(e){var t=e.navigation;return{title:"Hoot",drawerIcon:function(e){var t=e.color;return c.a.createElement(Wn,{name:"newspaper-outline",color:t})},headerRight:function(){return c.a.createElement(C.a,{onPress:function(){var e={top:"hot",hot:"new",new:((null==i?void 0:i.apiVersion)||0)<10?"hot":"top"}[o];a(e),t.navigate("FeedScreen",{sort:e})},style:function(e){return{opacity:e.pressed?.5:1}}},c.a.createElement(j.a,{name:{hot:"flame-outline",new:"time-outline",top:"arrow-up-outline"}[o],size:25,color:_[s].tint,style:{marginRight:15}}))}}}}),c.a.createElement(Nn.Screen,{name:"SearchScreen",component:Kt,options:{title:"Communities",drawerIcon:function(e){var t=e.color;return c.a.createElement(Wn,{name:"search-outline",color:t})}}}),c.a.createElement(Nn.Screen,{name:"NewPostScreen",component:Qt,initialParams:{community:void 0},options:{title:"New Post",drawerIcon:function(e){var t=e.color;return c.a.createElement(Wn,{name:"add-outline",color:t,size:40})}}}),c.a.createElement(Nn.Screen,{name:"NotificationScreen",component:Pn,options:{title:"Notifications",drawerIcon:function(e){var t=e.color;return c.a.createElement(Wn,{name:"notifications-outline",color:t})}}}),c.a.createElement(Nn.Screen,{name:"ProfileScreen",component:qt,options:{title:"Profile",drawerIcon:function(e){var t=e.color;return c.a.createElement(Wn,{name:"person-circle-outline",color:t})},headerRight:function(){return c.a.createElement(C.a,{onPress:function(){t.navigate("Settings")},style:function(e){return{opacity:e.pressed?.5:1}}},c.a.createElement(j.a,{name:"settings-outline",size:25,color:_[s].secondaryText,style:{marginRight:15}}))}}}))}function Wn(e){return c.a.createElement(j.a,w()({size:30,style:{marginBottom:-3}},e))}var Mn=Object(ie.a)({reducer:{lotide:St,posts:ye,replies:$e}});function Un(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function An(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Un(Object(n),!0).forEach((function(t){o()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Un(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function Gn(){var e=function(){var e=l.useState(!1),t=d()(e,2),r=t[0],o=t[1];return l.useEffect((function(){m.a.async((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,g.b(),e.next=4,m.a.awrap(y.b(b(b({},f.a.font),{},{"space-mono":n(295)})));case 4:e.next=9;break;case 6:e.prev=6,e.t0=e.catch(0),console.warn(e.t0);case 9:return e.prev=9,o(!0),g.a(),e.finish(9);case 13:case"end":return e.stop()}}),null,null,[[0,6,9,13]],Promise)}),[]),r}(),t=E(),r=He(),o=Object(ae.b)();function u(e){ht(e).then((function(){return a.a.setItem("@lotide_ctx",JSON.stringify(e))})).then((function(){return o(Pt(e))}))}return Object(l.useEffect)((function(){gt().then((function(e){void 0!==e&&o(Pt(e))}))}),[]),Object(l.useEffect)((function(){null!=r&&r.apiUrl&&(Pe(r).then((function(e){if(console.log(r),console.log("version",e.apiVersion),e.apiVersion<8||e.apiVersion>10)throw"Bad version";e.apiVersion!=r.apiVersion&&u(An(An({},r),{},{apiVersion:e.apiVersion}))})).catch((function(e){var t;F.a.alert("Failed to login",e),Et((null==(t=r.login)?void 0:t.user.username)+"@"+r.apiUrl).then((function(){return u({})}))})),r.login&&Ee(r,r.login.user.id).catch((function(){var e;Et((null==(e=r.login)?void 0:e.user.username)+"@"+r.apiUrl).then((function(){return u({})}))})))}),[null==r?void 0:r.apiUrl,null==r?void 0:r.apiVersion]),e?c.a.createElement(s.b,null,c.a.createElement(Bn,{colorScheme:t}),c.a.createElement(i.a,null)):null}t.a=function(){return c.a.createElement(ae.a,{store:Mn},c.a.createElement(Gn,null))}},277:function(e,t,n){e.exports=n(361)},295:function(e,t,n){e.exports=n.p+"./fonts/SpaceMono-Regular.ttf"},311:function(e,t){}},[[277,1,2]]]);
//# sourceMappingURL=app.14be765b.chunk.js.map
(this.webpackJsonp=this.webpackJsonp||[]).push([[0],{211:function(e,t,n){"use strict";n.d(t,"a",(function(){return tn}));var r=n(4),a=n.n(r),o=n(47),i=n(213),l=n(0),c=n.n(l),u=n(318),s=n(3),m=n.n(s),d=n(2),p=n.n(d),f=n(308),y=n(315),h=n(148);function g(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function b(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?g(Object(n),!0).forEach((function(t){m()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):g(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var E=n(99);function v(){return Object(E.a)()}var x=n(40),w=n.n(x),O=n(27),S=n(313),j=n(309),P=n(310),T=n(121),C=n(314),k=n(109),z=n(17),_=n(8),L="web"===_.a.OS?function(){}:n(109).PlatformColor,B={light:"ios"===_.a.OS?I():{tint:"orange",secondaryTint:"purple",text:"#111",secondaryText:"#333",placeholderText:"#444",background:"#fff",secondaryBackground:"#eee",tertiaryBackground:"#ccc",tabIconDefault:"#ccc",tabIconSelected:"orange",red:"red",orange:"orange",yellow:"yellow",green:"green",teal:"eeal",blue:"blue",indigo:"indigo",purple:"purple"},dark:"ios"===_.a.OS?I():{tint:"orange",secondaryTint:"purple",text:"#fff",secondaryText:"#666",placeholderText:"#aaa",background:"#111",secondaryBackground:"#222",tertiaryBackground:"#222",tabIconDefault:"#ccc",tabIconSelected:"orange",red:"red",orange:"orange",yellow:"yellow",green:"green",teal:"eeal",blue:"#68f",indigo:"indigo",purple:"purple"}};function I(){return{tint:L("systemOrange"),secondaryTint:L("systemPurple"),text:L("label"),secondaryText:L("secondaryLabel"),placeholderText:L("placeholderText"),background:L("systemBackground"),secondaryBackground:L("secondarySystemBackground"),tertiaryBackground:L("tertiarySystemBackground"),tabIconDefault:L("secondaryLabel"),tabIconSelected:L("systemOrange"),red:L("systemRed"),orange:L("systemOrange"),yellow:L("systemYellow"),green:L("systemGreen"),teal:L("systemTeal"),blue:L("systemBlue"),indigo:L("systemIndigo"),purple:L("systemPurple")}}var H=n(125),D={prefixes:[H.a("/")],config:{screens:{Root:{screens:{TabOne:{screens:{TabOneScreen:"one"}},TabTwo:{screens:{TabTwoScreen:"two"}}}},Modal:"modal",NotFound:"*"}}},R=n(1),V=n(45),W=n(38),N=n(201),F=n(11),U=n.n(F),A=n(23),M=n(5),G=n(50);function $(){var e=v();return B[e]}var J=["style","secondary","tint"],K=["style"],q=["style","placeholderTextColor"];function Y(e){var t=e.style,n=e.secondary,r=e.tint,a=U()(e,J),o=$(),i=n||r?n&&!r?o.secondaryText:r&&!n?o.tint:o.secondaryTint:o.text;return c.a.createElement(A.a,w()({style:[{color:i},t]},a))}function Q(e){var t=e.style,n=U()(e,K),r=$().background;return c.a.createElement(M.a,w()({style:[{backgroundColor:r},t]},n))}var X=Object(l.forwardRef)((function(e,t){var n=e.style,r=e.placeholderTextColor,a=U()(e,q),o=$(),i={backgroundColor:o.secondaryBackground,paddingHorizontal:10,paddingVertical:5,borderRadius:8,color:o.text};return c.a.createElement(G.a,w()({ref:t,style:[i,n],placeholderTextColor:r||o.placeholderText},a))}));function Z(e){return Object(l.useMemo)((function(){return function(e){var t=Math.round((Date.now()-Date.parse(e))/1e3),n=Math.round(t/60),r=Math.round(n/60),a=Math.round(r/24),o=Math.round(a/7);return n<60&&n+"m"||r<24&&r+"h"||a<7&&a+"d"||o+"w"}(e)}),[e])}function ee(e){var t=Z(e.time);return c.a.createElement(Y,{style:te.root},c.a.createElement(N.a,{name:"time-outline",size:14})," ",t)}var te=R.a.create({root:{}}),ne=n(25),re=n(142),ae=n(89);function oe(e){return p.a.async((function(t){for(;;)switch(t.prev=t.next){case 0:if("web"!==_.a.OS){t.next=2;break}return t.abrupt("return");case 2:return t.next=4,p.a.awrap(re.a(e));case 4:case"end":return t.stop()}}),null,null,null,Promise)}var ie={apiUrl:"https://hoot.goldandblack.xyz/api/unstable",login:void 0},le=Object(l.createContext)({ctx:ie,setContext:function(e){}});function ce(e,t,n,r){var a,o=arguments;return p.a.async((function(i){for(;;)switch(i.prev=i.next){case 0:if(a=o.length>4&&void 0!==o[4]&&o[4],e.apiUrl){i.next=3;break}throw"No API url";case 3:if(a||void 0!=e.login){i.next=5;break}throw"Not logged in";case 5:return i.abrupt("return",fetch(e.apiUrl+"/"+n,{method:t,headers:ue(e),body:void 0!==r?JSON.stringify(r):void 0}).then((function(e){return p.a.async((function(t){for(;;)switch(t.prev=t.next){case 0:if(!e.ok){t.next=4;break}return t.abrupt("return",e);case 4:return t.next=6,p.a.awrap(e.text());case 6:throw t.sent;case 7:case"end":return t.stop()}}),null,null,null,Promise)})).catch((function(r){throw console.error("Lotide Service Error: "+t+" "+e.apiUrl+"/"+n+"\n"+r,e),r})));case 6:case"end":return i.stop()}}),null,null,null,Promise)}function ue(e){return void 0!==e.login?{Authorization:"Bearer "+e.login.token,"Content-Type":"application/json"}:void 0}function se(e){var t,n,r=arguments;return p.a.async((function(a){for(;;)switch(a.prev=a.next){case 0:return t=r.length>1&&void 0!==r[1]&&r[1],n=r.length>2?r[2]:void 0,a.abrupt("return",ce(e,"GET","communities?include_your=true&limit=100"+(t?"&your_follow.accepted=true":"")+(n?"&page="+n:"")).then((function(e){return e.json()})).then((function(e){return e})));case 3:case"end":return a.stop()}}),null,null,null,Promise)}function me(e,t){return p.a.async((function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",ce(e,"GET","communities/"+t+"?include_your=true").then((function(e){return e.json()})));case 1:case"end":return n.stop()}}),null,null,null,Promise)}function de(e,t){return p.a.async((function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",ce(e,"GET","users/"+t,void 0,!0).then((function(e){return e.json()})));case 1:case"end":return n.stop()}}),null,null,null,Promise)}function pe(e,t){return p.a.async((function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",ce(e,"POST","communities/"+t+"/follow",{try_wait_for_accept:!0}).then((function(e){return e.json()})));case 1:case"end":return n.stop()}}),null,null,null,Promise)}function fe(e,t,n){return p.a.async((function(r){for(;;)switch(r.prev=r.next){case 0:return r.abrupt("return",ce(e,"PATCH","communities/"+t,{description:n}));case 1:case"end":return r.stop()}}),null,null,null,Promise)}function ye(e){return p.a.async((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",ce(e,"GET","instance",void 0,!0).then((function(e){return e.json()})));case 1:case"end":return t.stop()}}),null,null,null,Promise)}function he(e,t){return p.a.async((function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",ce(e,"GET","posts/"+t,void 0,!0).then((function(e){return e.json()})));case 1:case"end":return n.stop()}}),null,null,null,Promise)}function ge(e,t){return p.a.async((function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",ce(e,"GET","comments/"+t,void 0,!0).then((function(e){return e.json()})));case 1:case"end":return n.stop()}}),null,null,null,Promise)}function be(e,t,n){return p.a.async((function(r){for(;;)switch(r.prev=r.next){case 0:return r.abrupt("return",ce(e,"GET","posts/"+t+"/replies?limit=10&include_your=true"+(n?"&page="+n:"")).then((function(e){return e.json()})));case 1:case"end":return r.stop()}}),null,null,null,Promise)}function Ee(e,t,n){return p.a.async((function(r){for(;;)switch(r.prev=r.next){case 0:return r.abrupt("return",ce(e,"GET","comments/"+t+"/replies?limit=10&include_your=true"+(n?"&page="+n:"")).then((function(e){return e.json()})));case 1:case"end":return r.stop()}}),null,null,null,Promise)}function ve(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function xe(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ve(Object(n),!0).forEach((function(t){m()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ve(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function we(e){var t=Object(l.useState)(!1),n=a()(t,2),r=n[0],o=n[1],i=$(),u=Object(l.useContext)(le).ctx,s=e.type||"post",m=null!==e.post.your_vote&&void 0!==e.post.your_vote;function d(){oe(ae.a.Light),void 0!==u.login?r?"post"==s?function(e,t){return p.a.async((function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",ce(e,"DELETE","posts/"+t+"/your_vote"));case 1:case"end":return n.stop()}}),null,null,null,Promise)}(u,e.post.id).then((function(){return o(!1)})):function(e,t){return p.a.async((function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",ce(e,"DELETE","comments/"+t+"/your_vote"));case 1:case"end":return n.stop()}}),null,null,null,Promise)}(u,e.post.id).then((function(){return o(!1)})):"post"==s?function(e,t){return p.a.async((function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",ce(e,"PUT","posts/"+t+"/your_vote"));case 1:case"end":return n.stop()}}),null,null,null,Promise)}(u,e.post.id).then((function(){return o(!0)})):function(e,t){return p.a.async((function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",ce(e,"PUT","comments/"+t+"/your_vote"));case 1:case"end":return n.stop()}}),null,null,null,Promise)}(u,e.post.id).then((function(){return o(!0)})):ne.a.alert("Login to like","Leave a like when you login to a community")}Object(l.useEffect)((function(){return o(m)}),[e.post.your_vote]);var f=i.text;r&&(f=i.red);var y=r&&!m,h=!r&&m;return c.a.createElement(z.a,{onPress:function(){return d()},hitSlop:7,style:e.style},c.a.createElement(Q,{style:Oe.root},c.a.createElement(N.a,{name:r?"heart":"heart-outline",color:f,size:25}),!e.hideCount&&c.a.createElement(Y,{style:xe(xe({},Oe.score),{},{color:f})},"  "+(e.post.score+ +y-+h)+"  ")))}var Oe=R.a.create({root:{display:"flex",flexDirection:"row",alignItems:"center"},score:{fontSize:18,minWidth:28}}),Se=n(119),je=n.n(Se),Pe=n(214);function Te(e){var t=$(),n=Object(l.useMemo)((function(){return e.contentHtml||(""===(t=e.contentMarkdown)||void 0===t?void 0:t.replace(/^### (.*$)/gim,"<h3>$1</h3>").replace(/^## (.*$)/gim,"<h2>$1</h2>").replace(/^# (.*$)/gim,"<h1>$1</h1>").replace(/^\> (.*$)/gim,"<blockquote>$1</blockquote>").replace(/\*\*(.*)\*\*/gim,"<b>$1</b>").replace(/\*(.*)\*/gim,"<i>$1</i>").replace(/!\[(.*?)\]\((.*?)\)/gim,"<img alt='$1' src='$2' />").replace(/\[(.*?)\]\((.*?)\)/gim,"<a href='$2'>$1</a>").replace(/\n$/gim,"<br />").trim())||"<p>"+e.contentText+"</p>";var t}),[e.contentHtml,e.contentMarkdown,e.contentText]);return c.a.createElement(Pe.a,{RootComponent:function(e){return c.a.createElement(A.a,e)},value:n.replace(/\n/g,""),renderNode:Ce(t),stylesheet:{a:{color:t.secondaryTint},cite:{fontStyle:"italic"},del:{textDecorationLine:"line-through",textDecorationStyle:"solid"},dfn:{fontStyle:"italic"},ins:{textDecorationLine:"underline"},samp:{fontFamily:"ios"===_.a.OS?"Menlo":"monospace"},small:{fontSize:10}},textComponentProps:{style:{color:t.text}},onLinkLongPress:function(e){return ne.a.alert("Link",e)}})}var Ce=function(e){return function(t,n,r,a,o){if(["iframe","script"].includes(t.name||""))return null;function i(){return o(t.children,a)}switch(t.name){case"abbr":return c.a.createElement(z.a,{key:n,onPress:function(){return ne.a.alert("Abbr.",t.attribs.title)}},c.a.createElement(A.a,{style:{textDecorationLine:"underline",textDecorationStyle:"dotted"}},i()));case"blockquote":return c.a.createElement(A.a,{key:n},c.a.createElement(M.a,{style:{padding:10}},c.a.createElement(M.a,{style:{borderLeftWidth:2,borderColor:e.secondaryText,paddingLeft:10,paddingVertical:5}},i())),"\n");case"details":return c.a.createElement(ke,{key:n},i());case"dl":case"dt":case"dd":return c.a.createElement(A.a,{key:n},i(),"\n");case"figure":return c.a.createElement(M.a,{key:n},i());case"hr":return c.a.createElement(M.a,{key:n,style:{width:200,alignSelf:"stretch",borderBottomWidth:R.a.hairlineWidth||1,borderColor:e.secondaryText}});case"kbd":return c.a.createElement(A.a,{key:n,style:{backgroundColor:e.tertiaryBackground}}," ",i()," ");case"img":return c.a.createElement(A.a,{key:n},"[Image not displayed]");case"li":return c.a.createElement(A.a,{key:n},"\u2022 ",i(),"\n");case"sub":return c.a.createElement(A.a,{key:n,style:{fontSize:10}},i());case"summary":return c.a.createElement(A.a,{key:n},i());case"sup":return c.a.createElement(M.a,{key:n},c.a.createElement(A.a,{style:{fontSize:10}},i()));default:return}}};function ke(e){var t=e.children,n=Object(l.useState)(!1),r=a()(n,2),o=r[0],i=r[1],u=$(),s=t.filter((function(e){return""!==e.props.children.toString().trim()})),m=je()(s),d=m[0],p=m.slice(1);return c.a.createElement(M.a,null,c.a.createElement(z.a,{hitSlop:5,onPress:function(){return i((function(e){return!e}))}},c.a.createElement(A.a,{style:{color:u.secondaryTint}},o?c.a.createElement(O.a,{name:"chevron-down-outline"}):c.a.createElement(O.a,{name:"chevron-forward-outline"}),d)),o&&p)}function ze(e){var t=$(),n=e.colorize||"never",r=e.showHost||"only_foreign",a=function(e,t){return"always"===e||"never"!==e&&!t},o=a(n,e.local),i=a(r,e.local),l=o?{color:e.local?t.blue:t.green}:{};return c.a.createElement(Y,{style:[_e.root,e.style]},c.a.createElement(Y,{style:[_e.name,l,e.styleName]},e.name),i&&c.a.createElement(Y,{style:[_e.host,{color:t.secondaryText},e.styleHost]},e.newLine&&"\n",!e.newLine&&"@",e.host))}var _e=R.a.create({root:{},name:{fontWeight:"500"},host:{fontWeight:"200"}});function Le(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Be(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Le(Object(n),!0).forEach((function(t){m()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Le(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function Ie(e){var t=Object(l.useState)(1),n=a()(t,2),r=n[0],o=n[1],i=Object(l.useMemo)((function(){return!!(t=e.post.href)&&[".png",".jpg",".jpeg",".bmp",".gif",".webp"].some((function(e){return t.endsWith(e)}));var t}),[e.post.href]),u=$(),s=e.post;return c.a.createElement(Q,null,c.a.createElement(Y,{style:He.title},e.post.sticky&&c.a.createElement(c.a.Fragment,null,c.a.createElement(O.a,{name:"pin",size:25,color:u.secondaryTint})," "),e.post.title),e.post.href&&(i?c.a.createElement(W.a,{style:Be(Be({},He.image),{},{aspectRatio:r,backgroundColor:u.secondaryBackground}),source:{uri:e.post.href},onLoad:function(e){return o(Math.max(e.nativeEvent.source.width/e.nativeEvent.source.height,.5))}}):c.a.createElement(z.a,{style:[He.link,{backgroundColor:u.secondaryBackground}],onPress:function(){oe(ae.a.Medium),e.post.href&&Object(H.b)(e.post.href)}},c.a.createElement(Y,null,e.post.href))),e.showHtmlContent&&!!e.post.content_html&&c.a.createElement(Q,{style:{paddingHorizontal:15}},c.a.createElement(Te,{contentHtml:e.post.content_html,contentText:e.post.content_text})),c.a.createElement(Q,{style:He.foot},c.a.createElement(Q,null,c.a.createElement(z.a,{hitSlop:8,onPress:function(){return e.navigation.navigate("Community",{community:e.post.community})}},c.a.createElement(ze,{name:s.community.name,host:s.community.host,local:s.community.local,showHost:"only_foreign",colorize:"never",newLine:!0})),c.a.createElement(Y,{style:He.by},"by ",e.post.author.username),e.showCommunityHost&&c.a.createElement(Y,{style:He.by},"on ",e.post.community.host)),c.a.createElement(Q,null,c.a.createElement(ee,{time:e.post.created})),c.a.createElement(Q,null,c.a.createElement(Y,{style:He.footText},c.a.createElement(O.a,{name:"chatbubble-outline",size:12})," ",e.post.replies_count_total)),c.a.createElement(Q,null,c.a.createElement(we,{post:e.post,isUpvoted:!1}))))}var He=R.a.create({item:{marginVertical:0,marginHorizontal:0},title:{fontSize:20,padding:15},contentText:{fontSize:12},link:{paddingVertical:10,paddingHorizontal:15,borderRadius:5,marginHorizontal:15},image:{width:"100%",height:void 0,resizeMode:"contain"},foot:{display:"flex",flexDirection:"row",justifyContent:"space-between",alignItems:"center",width:"100%",padding:15},footText:{},by:{fontSize:11},score:{fontSize:18},actions:{display:"flex",flexDirection:"row",justifyContent:"space-around",alignItems:"center",padding:10}});var De=n(16),Re=n.n(De);function Ve(e,t,n){var r=Object(l.useState)([]),o=a()(r,2),i=o[0],c=o[1],u=Object(l.useState)(null),s=a()(u,2),m=s[0],d=s[1],f=Object(l.useState)(null),y=a()(f,2),h=y[0],g=y[1],b=Object(l.useState)(void 0),E=a()(b,2),v=E[0],x=E[1],w=Object(l.useState)(0),O=a()(w,2),S=O[0],j=O[1],P=Object(l.useContext)(le).ctx,T=function(e,t){var n=Object(l.useState)(0),r=a()(n,2),o=r[0],i=r[1],c=Object(l.useState)(!0),u=a()(c,2),s=u[0],m=u[1];return Object(l.useEffect)((function(){e((function(){return m(!1)}))}),[o].concat(Re()(t))),[s,function(){i((function(e){return e+1})),m(!0)}]}((function(r){P.login&&void 0===v&&(x(m),function(e,t){var n,r,a,o,i=arguments;return p.a.async((function(l){for(;;)switch(l.prev=l.next){case 0:return n=i.length>2&&void 0!==i[2]?i[2]:"hot",r=i.length>3?i[3]:void 0,a=i.length>4?i[4]:void 0,o=[null===t?"posts?sort="+n:"posts?page="+t+"&sort="+n,"include_your=true",void 0!==r&&"in_your_follows="+r,a&&"community="+a].filter((function(e){return e})).join("&"),l.abrupt("return",ce(e,"GET",o).then((function(e){return e.json()})));case 5:case"end":return l.stop()}}),null,null,null,Promise)}(P,m,e,t,n).then((function(e){c((function(t){return[].concat(Re()(t),Re()(e.items))})),g(e.next_page),x(void 0)})).then((function(){return r()})).catch((function(e){r(),c((function(t){return[].concat(Re()(t),[{id:-1,title:"Lotide error",content_html:"<p>Error: "+e+"</p>",created:"",replies_count_total:0,score:0,sticky:!0,author:{id:-1,username:"Failure",local:!1,host:"hoot-mobile"},community:{id:-1,name:"something-went-wrong",local:!1,host:"hoot-mobile"}}])}))})))}),[S,m]),C=a()(T,2),k=C[0],z=C[1];return Object(l.useEffect)((function(){c([]),d(null),g(null),z()}),[P,e]),[i,k,function(){c([]),d(null),g(null),j((function(e){return e+1})),z()},function(){null!==h&&d(h)}]}var We=n(41),Ne=[{name:"Gold&Black",domain:"hoot.goldandblack.xyz"},{name:"Narwhal.City",domain:"narwhal.city"},{name:"Tide C",domain:"c.tide.tk"},{name:"Exopla",domain:"lotide.exopla.net.eu.org"},{name:"Narwhal.City (Dev)",domain:"dev.narwhal.city"},{name:"Tide B",domain:"b.tide.tk"},{name:"Tide A",domain:"a.tide.tk"}],Fe=function(){return p.a.async((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",o.a.getItem("@lotide_ctx").then((function(e){return null!==e?JSON.parse(e):void 0})));case 1:case"end":return e.stop()}}),null,null,null,Promise)},Ue=function(e){var t;return p.a.async((function(n){for(;;)switch(n.prev=n.next){case 0:if(e.login){n.next=2;break}return n.abrupt("return");case 2:t=e.login.user.username+"@"+e.apiUrl,Ke.store("@lotide_ctx_arr",t,e);case 4:case"end":return n.stop()}}),null,null,null,Promise)},Ae=function(e){return p.a.async((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",Ke.query("@lotide_ctx_arr",e));case 1:case"end":return t.stop()}}),null,null,null,Promise)},Me=function(){return p.a.async((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",Ke.listKeys("@lotide_ctx_arr"));case 1:case"end":return e.stop()}}),null,null,null,Promise)},Ge=function(e){return p.a.async((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",Ke.remove("@lotide_ctx_arr",e));case 1:case"end":return t.stop()}}),null,null,null,Promise)},$e=function(e){var t;return p.a.async((function(n){for(;;)switch(n.prev=n.next){case 0:if(e.login){n.next=2;break}return n.abrupt("return");case 2:t=e.login.user.username+"@"+e.apiUrl,Ke.store("@lotide_ctx_arr",t,{apiUrl:e.apiUrl});case 4:case"end":return n.stop()}}),null,null,null,Promise)},Je=function(){var e;return p.a.async((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,p.a.awrap(o.a.getItem("@lotide_ctx_arr"));case 2:return e=t.sent,t.abrupt("return",e?JSON.parse(e):{});case 4:case"end":return t.stop()}}),null,null,null,Promise)},Ke={store:function(e,t,n){var r,a;return p.a.async((function(i){for(;;)switch(i.prev=i.next){case 0:return i.next=2,p.a.awrap(o.a.getItem(e));case 2:return r=i.sent,a=r?JSON.parse(r):{},a[t]=n,i.next=7,p.a.awrap(o.a.setItem(e,JSON.stringify(a)));case 7:case"end":return i.stop()}}),null,null,null,Promise)},query:function(e,t){var n;return p.a.async((function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,p.a.awrap(o.a.getItem(e));case 2:return n=r.sent,r.abrupt("return",n?JSON.parse(n)[t]:void 0);case 4:case"end":return r.stop()}}),null,null,null,Promise)},listKeys:function(e){var t,n;return p.a.async((function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,p.a.awrap(o.a.getItem(e));case 2:return t=r.sent,n=t?JSON.parse(t):{},r.abrupt("return",Object.keys(n));case 5:case"end":return r.stop()}}),null,null,null,Promise)},remove:function(e,t){var n,r,a;return p.a.async((function(i){for(;;)switch(i.prev=i.next){case 0:return i.next=2,p.a.awrap(o.a.getItem(e));case 2:return n=i.sent,r=n?JSON.parse(n):{},a=r[t],delete r[t],i.next=8,p.a.awrap(o.a.setItem(e,JSON.stringify(r)));case 8:return i.abrupt("return",a);case 9:case"end":return i.stop()}}),null,null,null,Promise)}};function qe(e){var t=Object(l.useState)(""),n=a()(t,2),r=n[0],o=n[1],i=Object(l.useState)(Ne),u=a()(i,2),s=u[0],m=u[1],d=Object(l.useState)([]),p=a()(d,2),f=p[0],y=p[1],h=$(),g=Object(l.useContext)(le);Object(l.useEffect)((function(){Ne.map((function(e,t){return ye({apiUrl:"https://"+e.domain+"/api/unstable"}).then((function(e){m((function(n){return n.map((function(n,r){return t!==r?n:{name:n.name,domain:n.domain,instanceInfo:e}}))}))})).catch((function(){m((function(e){return e.map((function(e,n){return t!==n?e:{name:e.name,domain:e.domain,instanceInfo:null}}))}))}))}))}),[]),Object(l.useEffect)((function(){Je().then((function(e){return Object.entries(e)})).then(y)}),[]);return c.a.createElement(We.a,{contentContainerStyle:Ye.root},c.a.createElement(Y,{style:Ye.title},"Login to continue"),f.length>0&&c.a.createElement(Y,{style:Ye.subtitle},"Select an existing profile"),f.map((function(t){var n=t[0].split("@"),r=a()(n,2),o=r[0],i=r[1],l=!!t[1].login,u=l?h.text:h.secondaryText,s=i.replace("http://","").replace("https://","").split(/[/?#]/)[0];return c.a.createElement(z.a,{key:t[0],onPress:function(){l?g.setContext(t[1]):e.onSelect(s.toLowerCase(),void 0,o)},style:{display:"flex",flexDirection:"row",alignItems:"center"}},c.a.createElement(O.a,{name:l?"lock-open-outline":"lock-closed-outline",color:u,style:{marginRight:10},size:20}),c.a.createElement(ze,{name:o,host:s,local:!0,showHost:"always",newLine:!0,style:{paddingVertical:15,paddingBottom:10},styleName:{color:u}}))})),c.a.createElement(Y,{style:Ye.subtitle},f.length>0?"Or sign into a new acount":"Enter a host or select one below"),c.a.createElement(X,{placeholder:"Host domain",style:{paddingVertical:10,paddingHorizontal:10},value:r,onChangeText:o,onSubmitEditing:function(){return e.onSelect(r.toLowerCase())},keyboardType:"url",returnKeyType:"next"}),s.filter((function(e){return""===r||e.domain.includes(r.toLowerCase())||e.name.toLowerCase().includes(r.toLowerCase())})).map((function(t){return c.a.createElement(Q,{key:t.domain},function(t){var n,r=t.item,a=null==(n=r.instanceInfo)?void 0:n.software.version.startsWith("0.9."),o=a?h.text:h.secondaryText;return c.a.createElement(Q,{style:{borderBottomWidth:R.a.hairlineWidth||1,borderColor:h.secondaryText,paddingVertical:25}},c.a.createElement(z.a,{onPress:function(){return a&&e.onSelect(r.domain,r.name)}},c.a.createElement(ze,{name:r.name,host:r.domain,local:!1,newLine:!0,styleName:{fontSize:24,fontWeight:"300",fontFamily:"ios"===_.a.OS?"Georgia":"serif",color:o}}),r.instanceInfo?c.a.createElement(c.a.Fragment,null,c.a.createElement(Y,{style:{color:h.secondaryText}},r.instanceInfo.software.version,!a&&" - Out of date"),!!r.instanceInfo.description&&c.a.createElement(Y,{style:{color:o}},r.instanceInfo.description)):null===r.instanceInfo?c.a.createElement(Y,{style:{color:o}},"Failed to load info"):c.a.createElement(Y,{style:{color:o}},"Loading...")))}({item:t}))})))}var Ye=R.a.create({root:{padding:20},title:{fontSize:24,marginBottom:10,textAlign:"center"},subtitle:{fontWeight:"300",marginBottom:10,marginTop:15,textAlign:"center"}}),Qe=n(24),Xe=n(34),Ze=n(48),et=n(28);function tt(e){var t=Object(l.useState)(!1),n=a()(t,2),r=n[0],o=n[1],i=Object(l.useState)(e.username||""),u=a()(i,2),s=u[0],m=u[1],d=Object(l.useState)(""),f=a()(d,2),y=f[0],h=f[1],g=Object(l.useState)(""),b=a()(g,2),E=b[0],v=b[1],x=Object(l.useRef)(null),w=Object(l.useRef)(null),O=$(),S=Object(l.useContext)(le),j=Object(et.o)();function P(e){ne.a.alert("Failed to submit",e)}function T(){return s?y?E?void function(e,t,n,r){return p.a.async((function(a){for(;;)switch(a.prev=a.next){case 0:return a.abrupt("return",ce({apiUrl:e},"POST","users",{username:t,password:n,email_address:r,login:!0},!0).then((function(e){return e.json()})));case 1:case"end":return a.stop()}}),null,null,null,Promise)}("https://"+e.domain+"/api/unstable",s,y,E).then((function(t){S.setContext({apiUrl:"https://"+e.domain+"/api/unstable",login:t})})).catch((function(e){ne.a.alert("Failed to register",e),console.error(e)})):P("Please enter an email address"):P("Enter a password"):P("Please enter a username")}function C(){return s?y?void function(e,t,n){return p.a.async((function(r){for(;;)switch(r.prev=r.next){case 0:return r.abrupt("return",ce({apiUrl:e},"POST","logins",{username:t,password:n},!0).then((function(e){return e.json()})));case 1:case"end":return r.stop()}}),null,null,null,Promise)}("https://"+e.domain+"/api/unstable",s,y).then((function(t){S.setContext({apiUrl:"https://"+e.domain+"/api/unstable",login:t})})).catch((function(e){ne.a.alert("Failed to login",e),console.error(e)})):P("Enter a password"):P("Please enter a username")}function k(){r?T():C()}return c.a.createElement(z.a,{style:{flex:1},onPress:function(){return"web"!==_.a.OS&&Xe.a.dismiss()}},c.a.createElement(Ze.a,{style:nt.root,behavior:"padding"},e.hostName?c.a.createElement(z.a,{style:{alignItems:"center"}},c.a.createElement(Y,{style:nt.name},e.hostName),c.a.createElement(Y,{style:[nt.domain,{color:O.secondaryText}]},e.domain)):c.a.createElement(z.a,null,c.a.createElement(Y,{style:{fontSize:24}},e.domain)),c.a.createElement(z.a,{hitSlop:5,onPress:function(){return o((function(e){return!e}))}},c.a.createElement(Y,{style:[nt.loginRegister,{color:O.secondaryText}]},c.a.createElement(Y,{style:{color:r?O.secondaryText:O.secondaryTint}},"Login")," | ",c.a.createElement(Y,{style:{color:r?O.secondaryTint:O.secondaryText}},"Register"))),r&&c.a.createElement(X,{style:nt.input,placeholder:"Email Address",value:E,onChangeText:v,keyboardType:"email-address",textContentType:"emailAddress",autoCompleteType:"email",returnKeyType:"next",onSubmitEditing:function(){var e;return null==(e=x.current)?void 0:e.focus()}}),c.a.createElement(X,{ref:x,style:nt.input,placeholder:"Username",value:s,onChangeText:m,keyboardType:"ascii-capable",textContentType:"username",autoCompleteType:"username",returnKeyType:"next",onSubmitEditing:function(){var e;return null==(e=w.current)?void 0:e.focus()}}),c.a.createElement(X,{ref:w,style:nt.input,placeholder:"Password",value:y,onChangeText:h,secureTextEntry:!0,textContentType:r?"newPassword":"password",autoCompleteType:"password",returnKeyType:"done",onSubmitEditing:k}),!r&&c.a.createElement(z.a,{style:{padding:15},onPress:function(){return j.navigate("ForgotPassword",{node:e.domain})}},c.a.createElement(Y,{secondary:!0},"Forgot Password")),c.a.createElement(Q,{style:nt.actionButtons},c.a.createElement(Qe.a,{title:"Change Host",onPress:e.onGoBack,color:O.secondaryTint}),c.a.createElement(Qe.a,{title:r?"Register":"Login",onPress:k,color:O.tint}))))}var nt=R.a.create({root:{flex:1,alignItems:"center",justifyContent:"center",padding:35},name:{fontSize:50,fontFamily:"ios"===_.a.OS?"Georgia":"serif"},domain:{fontWeight:"300"},loginRegister:{padding:15},input:{width:"100%",marginVertical:5,paddingHorizontal:20,paddingVertical:10},actionButtons:{width:"100%",display:"flex",flexDirection:"row",justifyContent:"space-around"}});function rt(){var e=Object(l.useState)(),t=a()(e,2),n=t[0],r=t[1],o=Object(l.useState)(),i=a()(o,2),u=i[0],s=i[1],m=Object(l.useState)(),d=a()(m,2),p=d[0],f=d[1];return c.a.createElement(Q,{style:at.root},u?c.a.createElement(tt,{hostName:n,domain:u,username:p,onGoBack:function(){return s(void 0)}}):c.a.createElement(qe,{onSelect:function(e,t,n){r(t),s(e),f(n)}}))}var at=R.a.create({root:{width:"100%",height:"100%"},container:{flex:1,alignItems:"center",justifyContent:"center"},input:{width:"100%",marginBottom:20,paddingHorizontal:20,paddingVertical:10},actionButtons:{display:"flex",flexDirection:"row",justifyContent:"space-around",width:"100%"}});function ot(e){var t=e.navigation,n=e.route.params.sort,r=Object(l.useContext)(le).ctx,o=Ve(n,!0),i=a()(o,4),u=i[0],s=i[1],m=i[2],d=i[3];if(!function(e){return!!e.apiUrl&&!!e.login}(r))return c.a.createElement(rt,null);return c.a.createElement(Q,{style:it.container},c.a.createElement(V.a,{data:u,renderItem:function(e){var n=e.item;return c.a.createElement(lt,{post:n,navigation:t})},keyExtractor:function(e,t){return e.id+"-"+t},refreshing:s,onRefresh:m,onEndReachedThreshold:2,onEndReached:d}))}var it=R.a.create({container:{flex:1},item:{marginVertical:0,marginHorizontal:0,borderBottomWidth:8},title:{fontSize:20,padding:15,color:"#eee"},contentText:{fontSize:12},link:{paddingVertical:10,paddingHorizontal:15,backgroundColor:"#8884",borderRadius:5,marginHorizontal:15},image:{width:"100%",height:void 0,resizeMode:"contain"},foot:{display:"flex",flexDirection:"row",justifyContent:"space-between",alignItems:"center",width:"100%",padding:15},footText:{color:"#ccc"},by:{fontSize:11},score:{fontSize:18,color:"#bbb"}}),lt=function(e){var t=e.post,n=e.navigation,r=$();return c.a.createElement(z.a,{onPress:function(){return n.navigate("Post",{post:t})},onLongPress:function(){oe(ae.a.Heavy),console.log(t)}},c.a.createElement(Q,{style:[it.item,{borderBottomColor:r.secondaryBackground}]},c.a.createElement(Ie,{post:t,navigation:n})))};function ct(e){var t,n=Object(l.useState)(),r=a()(n,2),o=r[0],i=r[1],u=Object(l.useState)(""),s=a()(u,2),m=s[0],d=s[1],p=Object(l.useContext)(le).ctx,f=$(),y=e.onlyWhenTyping&&""===m?[]:o?""===m?o.items:o.items.filter((function(e){return e.name.toLowerCase().includes(m.toLowerCase())||e.host.includes(m.toLowerCase())})):[];Object(l.useEffect)((function(){se(p,!1).then(i)}),[null==(t=p.login)?void 0:t.token,e.focusId]);return c.a.createElement(Q,null,c.a.createElement(X,{placeholder:e.placeholder||"Filter communities",value:m,onChangeText:d,style:ut.input}),c.a.createElement(V.a,{data:y,renderItem:function(t){var n,r=t.item;return c.a.createElement(z.a,{onPress:function(){return e.onSelect(r)},style:[ut.item,{borderColor:f.secondaryBackground}]},c.a.createElement(ze,{name:r.name,host:r.host,local:r.local,colorize:"always",newLine:!0}),c.a.createElement(Q,{style:{display:"flex",flexDirection:"row"}},r.you_are_moderator&&c.a.createElement(O.a,{name:"shield-outline",size:20,color:f.secondaryTint}),(null==(n=r.your_follow)?void 0:n.accepted)&&c.a.createElement(O.a,{name:"checkmark",size:20,color:f.secondaryTint,style:{marginLeft:5}})))},keyExtractor:function(e,t){return e.id+"-"+t},contentContainerStyle:ut.list}))}var ut=R.a.create({root:{flex:1,alignItems:"center",justifyContent:"center"},input:{paddingVertical:10,marginHorizontal:20,marginTop:20},list:{padding:20,paddingBottom:100},item:{display:"flex",flexDirection:"row",justifyContent:"space-between",alignItems:"center",height:50,borderBottomWidth:1,paddingHorizontal:20}});function st(e){var t=e.navigation,n=Object(l.useState)(0),r=a()(n,2),o=r[0],i=r[1],u=Object(l.useContext)(le).ctx;return Object(l.useEffect)((function(){return t.addListener("focus",(function(){return i((function(e){return e+1}))}))}),[]),u.login?c.a.createElement(ct,{onSelect:function(e){return t.navigate("Community",{community:e})},focusId:o}):c.a.createElement(rt,null)}function mt(e){var t,n,r,o=e.navigation,i=Object(l.useState)(),u=a()(i,2),s=u[0],m=u[1],d=Object(l.useState)([]),f=a()(d,2),y=f[0],h=f[1],g=Object(l.useState)([]),b=a()(g,2),E=b[0],v=b[1],x=Object(l.useState)(!1),w=a()(x,2),S=w[0],j=w[1],P=Object(l.useState)(0),T=a()(P,2),C=T[0],k=T[1],_=$(),L=Object(l.useContext)(le),B=L.ctx,I=L.setContext;if(Object(l.useEffect)((function(){return o.addListener("focus",(function(){return k((function(e){return e+1}))}))}),[]),Object(l.useEffect)((function(){B.login&&se(B,!0).then((function(e){return v(e.items)}))}),[null==(t=B.login)?void 0:t.user.id,C]),Object(l.useEffect)((function(){var e;void 0!==B.login&&void 0!==B.login.user&&de(B,(null==(e=B.login)?void 0:e.user.id)||0).then(m)}),[null==(n=B.login)?void 0:n.token,C]),Object(l.useEffect)((function(){Me().then((function(e){return h(e)}))}),[B,C]),void 0===B.login)return c.a.createElement(rt,null);return c.a.createElement(We.a,{style:[dt.container,{backgroundColor:_.background}]},c.a.createElement(Q,{style:dt.header},c.a.createElement(Q,null,c.a.createElement(z.a,{hitSlop:10,onPress:function(){return j((function(e){return!e}))}},c.a.createElement(Y,{style:dt.title},(null==s?void 0:s.username)||B.login.user.username,"  ",c.a.createElement(O.a,{name:"pencil-outline",size:20,color:_.secondaryText}))),c.a.createElement(Y,{style:{color:_.secondaryText}},null==s?void 0:s.host),!(null==s||!s.avatar)&&c.a.createElement(Y,null,null==s||null==(r=s.avatar)?void 0:r.url),!(null==s||!s.description)&&c.a.createElement(Y,null,null==s?void 0:s.description)),c.a.createElement(Qe.a,{onPress:function(){ne.a.alert("Log out","Would you like to keep the login profile handy for later?",[{text:"Cancel",style:"cancel"},{text:"Remove",onPress:function(){var e;Ge((null==(e=B.login)?void 0:e.user.username)+"@"+B.apiUrl).then((function(){return function(e){return p.a.async((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",ce(e,"DELETE","logins/~current"));case 1:case"end":return t.stop()}}),null,null,null,Promise)}(B)})).then((function(){return I({})}))}},{text:"Keep",style:"default",onPress:function(){$e(B),I({})}}],{cancelable:!0})},title:"Log Out",color:_.secondaryTint,accessibilityLabel:"Log out of the Hoot network"})),S&&c.a.createElement(Q,{style:dt.editView},c.a.createElement(X,{style:dt.editViewText,placeholder:"New email"}),c.a.createElement(X,{style:dt.editViewText,placeholder:"User bio",multiline:!0}),c.a.createElement(X,{style:dt.editViewText,placeholder:"New password"}),c.a.createElement(X,{style:dt.editViewText,placeholder:"Confirm new password"}),c.a.createElement(Q,{style:dt.editViewActionButtons},c.a.createElement(Qe.a,{onPress:function(){return j(!1)},title:"Cancel",color:_.secondaryTint,accessibilityLabel:"Add profile"}),c.a.createElement(Qe.a,{onPress:function(){return ne.a.alert("unimplemented")},title:"Submit",color:_.tint,accessibilityLabel:"Add profile"}))),c.a.createElement(Qe.a,{onPress:function(){return I({})},title:"Add Profile",color:_.tint,accessibilityLabel:"Add profile"}),y.map((function(e){return[e].concat(Re()(e.split("@")))})).map((function(e){return[e[0],e[1],e[2].replace("http://","").replace("https://","").split(/[/?#]/)[0]]})).map((function(e){return c.a.createElement(z.a,{key:e[0],style:[dt.altProfileButton,{borderColor:_.secondaryBackground}],onPress:function(){Ae(e[0]).then((function(e){void 0!==e&&(I(e),j(!1))}))}},c.a.createElement(ze,{name:e[1],host:e[2],local:!0,showHost:"always",colorize:"never",newLine:!0}))})),c.a.createElement(Q,{style:{paddingTop:10}},c.a.createElement(Qe.a,{onPress:function(){return o.navigate("NewCommunity")},title:"Create Community",color:_.tint,accessibilityLabel:"Create a new community"})),c.a.createElement(Y,{style:dt.followingTitle},"Communities You Follow:"),E.map((function(e){return c.a.createElement(Q,{key:e.id,style:[dt.altProfileButton,{borderColor:_.secondaryBackground}]},c.a.createElement(ze,{name:e.name,host:e.host,local:e.local,showHost:"always",colorize:"always",newLine:!0}))})))}var dt=R.a.create({container:{height:"100%"},header:{display:"flex",flexDirection:"row",justifyContent:"space-between",padding:20},title:{fontSize:20,fontWeight:"bold"},followingTitle:{fontSize:18,fontWeight:"500",padding:20},editView:{margin:20},editViewText:{marginBottom:15,paddingVertical:10,paddingHorizontal:15},editViewActionButtons:{display:"flex",flexDirection:"row",justifyContent:"space-around"},separator:{marginVertical:30,height:1,width:"80%"},inputContainer:{width:"100%",padding:20},input:{height:40,borderWidth:1,paddingVertical:10,paddingHorizontal:20,width:"100%",borderRadius:8},altProfileButton:{marginHorizontal:20,paddingVertical:15,borderBottomWidth:1}}),pt=n(108);function ft(e){var t,n=e.navigation,r=e.route,o=Object(l.useState)(r.params.community),i=a()(o,2),u=i[0],s=i[1],m=Object(l.useState)(""),d=a()(m,2),f=d[0],y=d[1],h=Object(l.useState)(""),g=a()(h,2),b=g[0],E=g[1],v=Object(l.useState)(""),x=a()(v,2),w=x[0],O=x[1],S=$(),j=Object(l.useContext)(le).ctx;if(Object(l.useEffect)((function(){return n.addListener("focus",(function(){return r.params.community?s(r.params.community):null===u?s(void 0):void 0}))}),[u,null==u?void 0:u.id,null==(t=r.params.community)?void 0:t.id]),void 0===j.login)return c.a.createElement(rt,null);if(null===u)return c.a.createElement(ct,{onSelect:s,onlyWhenTyping:!0});return c.a.createElement(Ze.a,{style:{width:"100%",height:"100%"}},c.a.createElement(pt.a,{onPress:function(){return"web"!==_.a.OS&&Xe.a.dismiss()}},c.a.createElement(Q,{style:yt.container},c.a.createElement(z.a,{onPress:function(){return s(null)}},u?c.a.createElement(ze,{name:u.name,host:u.host,local:u.local,colorize:"always",showHost:"always",newLine:!0,style:yt.input}):c.a.createElement(Y,{style:[yt.input,{color:S.secondaryText}]},"Select a Community")),c.a.createElement(G.a,{style:[yt.input,yt.title,{color:S.text}],placeholder:"Add a Title",placeholderTextColor:S.placeholderText,value:f,onChangeText:y}),f.length>=4?c.a.createElement(c.a.Fragment,null,c.a.createElement(G.a,{style:[yt.input,{color:S.text}],placeholder:"Link",placeholderTextColor:S.placeholderText,value:b,onChangeText:E,keyboardType:"url",textContentType:"URL"}),c.a.createElement(X,{style:{marginVertical:20,minHeight:100},multiline:!0,placeholder:"Add post content",value:w,onChangeText:O})):c.a.createElement(Y,{style:{color:S.secondaryText}},f.length>0&&4-f.length),!!u&&f.length>=4&&c.a.createElement(Qe.a,{onPress:function(){u&&function(e,t){return p.a.async((function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",ce(e,"POST","posts",t).then((function(e){return e.json()})));case 1:case"end":return n.stop()}}),null,null,null,Promise)}(j,{community:u.id,title:f,href:b||void 0,content_markdown:w||" "}).then((function(e){he(j,e.id).then((function(e){s(void 0),y(""),E(""),O(""),n.navigate("Post",{post:e})}))})).catch((function(e){return ne.a.alert("Could not submit post",e)}))},title:"Submit",color:S.tint,accessibilityLabel:"Submit new post"}))))}var yt=R.a.create({container:{flex:1,alignItems:"stretch",padding:15,height:"100%",width:"100%"},title:{fontSize:20,fontWeight:"bold"},separator:{marginVertical:30,height:1,width:"80%"},inputContainer:{width:"100%",padding:20},input:{paddingVertical:10,width:"100%",borderRadius:8},item:{paddingHorizontal:20,paddingVertical:10,marginHorizontal:20,marginBottom:1}});function ht(){return c.a.createElement(Q,null,c.a.createElement(Y,null,"Settings screen. It'll be implemented eventually."))}function gt(e){var t,n=e.navigation,r=e.route,o=Object(l.useState)(r.params.community),i=a()(o,2),u=i[0],s=i[1],m=Ve("hot",void 0,u.id),d=a()(m,4),f=d[0],y=d[1],h=d[2],g=d[3],b=Object(l.useState)(0),E=a()(b,2),v=E[0],x=E[1],w=$(),O=Object(l.useContext)(le).ctx;Object(l.useEffect)((function(){me(O,u.id).then(s)}),[r.params.community.id,r.params.community.description,v]);var S=(null==(t=u.your_follow)?void 0:t.accepted)||!1;return c.a.createElement(Q,{style:[bt.root,{backgroundColor:w.background}]},c.a.createElement(Q,{style:[bt.header,{borderBottomColor:w.tertiaryBackground}]},c.a.createElement(Q,null,c.a.createElement(Y,{style:[bt.title]},u.name),c.a.createElement(Y,{style:{color:u.local?w.blue:w.green,fontWeight:"500"}},u.host),""!==u.description&&c.a.createElement(Y,null,"\n",u.description)),c.a.createElement(Q,{style:bt.buttons},c.a.createElement(Qe.a,{onPress:function(){return n.navigate("NewPostScreen",{community:u})},title:"Post",color:w.tint,accessibilityLabel:"Post to this community"}),u.you_are_moderator&&c.a.createElement(Qe.a,{onPress:function(){return n.navigate("EditCommunity",{community:u})},title:"Edit",color:w.tint,accessibilityLabel:"Edit your community community"}),S?c.a.createElement(Qe.a,{onPress:function(){(function(e,t){return p.a.async((function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",ce(e,"POST","communities/"+t+"/unfollow"));case 1:case"end":return n.stop()}}),null,null,null,Promise)})(O,u.id).then((function(){x((function(e){return e+1}))}))},title:"Unfollow",color:w.secondaryTint,accessibilityLabel:"Stop seeing posts from this community"}):c.a.createElement(Qe.a,{onPress:function(){pe(O,u.id).then((function(e){!1===e.accepted&&ne.a.alert("Follow request rejected.","This could be an issue with the node you are connected to."),x((function(e){return e+1}))}))},title:"Follow",color:w.tint,accessibilityLabel:"See posts from this community in your feed"}))),c.a.createElement(V.a,{data:f,renderItem:function(e){var t=e.item;return c.a.createElement(Et,{post:t,navigation:n})},keyExtractor:function(e,t){return e.id+"-"+t},refreshing:y,onRefresh:h,onEndReachedThreshold:2,onEndReached:g}))}var bt=R.a.create({root:{height:"100%"},header:{padding:20,borderBottomWidth:R.a.hairlineWidth||1},title:{fontSize:20},buttons:{paddingTop:10,display:"flex",flexDirection:"row",width:"100%",justifyContent:"space-around",alignItems:"center"},item:{marginVertical:0,marginHorizontal:0,borderBottomWidth:8}}),Et=function(e){var t=e.post,n=e.navigation,r=$();return c.a.createElement(z.a,{onPress:function(){return n.navigate("Post",{post:t})},onLongPress:function(){oe(ae.a.Heavy)}},c.a.createElement(Q,{style:[bt.item,{borderBottomColor:r.secondaryBackground}]},c.a.createElement(Ie,{post:t,navigation:n})))},vt=n(212);function xt(e){var t=e.navigation,n=e.route,r=Object(l.useState)(""),o=a()(r,2),i=o[0],u=o[1],s=Object(l.useRef)(null),m=$(),d=Object(l.useContext)(le).ctx,f=n.params.id,y=n.params.title,h=n.params.html,g=n.params.type;return c.a.createElement(Ze.a,{behavior:"ios"===_.a.OS?"padding":"height"},c.a.createElement(vt.a,{ref:s},c.a.createElement(z.a,{style:wt.root,onPress:function(){return"web"!==_.a.OS&&Xe.a.dismiss()}},c.a.createElement(Y,null,"Reply to ",g),!!y&&c.a.createElement(Y,{style:wt.title},y),h&&c.a.createElement(Te,{contentHtml:h}),c.a.createElement(X,{style:wt.input,multiline:!0,placeholder:"Type your reply",value:i,onChangeText:u,onFocus:function(){s.current&&s.current.scrollToEnd({animated:!0})}}),c.a.createElement(Qe.a,{title:"Submit",color:m.tint,onPress:function(){"post"===g?function(e,t,n){return p.a.async((function(r){for(;;)switch(r.prev=r.next){case 0:return r.abrupt("return",ce(e,"POST","posts/"+t+"/replies",{content_markdown:n}).then((function(e){return e.json()})));case 1:case"end":return r.stop()}}),null,null,null,Promise)}(d,f,i).then((function(){return t.pop()})):function(e,t,n){return p.a.async((function(r){for(;;)switch(r.prev=r.next){case 0:return r.abrupt("return",ce(e,"POST","comments/"+t+"/replies",{content_markdown:n}).then((function(e){return e.json()})));case 1:case"end":return r.stop()}}),null,null,null,Promise)}(d,f,i).then((function(){return t.pop()}))}}))))}var wt=R.a.create({root:{padding:20,paddingBottom:100},title:{fontSize:20,marginVertical:10},input:{marginVertical:20,minHeight:100}}),Ot=n(39),St=n(105),jt=[void 0,function(){}],Pt=c.a.createContext(jt);function Tt(e){var t=e.replies,n=e.navigation,r=e.layer,o=void 0===r?0:r,i=e.postId,u=e.replyId,s=e.highlightedReplies,m=void 0===s?[]:s,d=Object(l.useState)(),p=a()(d,2),f=p[0],y=p[1],h=$(),g=Object(l.useContext)(le).ctx,b=[h.text,h.red,h.orange,h.yellow,h.green,h.teal,h.blue,h.indigo,h.purple];return c.a.createElement(Q,null,t.items.map((function(e){return c.a.createElement(Ct,{reply:e,layer:o,key:e.id,navigation:n,layerColors:b,postId:i,highlightedReplies:m})})),null!==t.next_page&&void 0===f&&(i||u)&&c.a.createElement(z.a,{hitSlop:5,onPress:function(){u?Ee(g,u,t.next_page||void 0).then(y):i&&be(g,i,t.next_page||void 0).then(y)}},c.a.createElement(Y,{style:{color:h.tint,paddingTop:5,paddingBottom:10}},"More replies ",c.a.createElement(O.a,{name:"chevron-down-outline"}))),void 0!==f&&c.a.createElement(Tt,{replies:f,navigation:n,layer:o,postId:i,replyId:u,highlightedReplies:m}),null===t.next_page&&0===o&&c.a.createElement(Y,{style:{margin:17,color:h.secondaryText}},t.items.length>0?"No more replies":"No replies yet"))}function Ct(e){var t,n=e.reply,r=e.layer,o=void 0===r?0:r,i=e.navigation,u=e.layerColors,s=e.postId,m=e.highlightedReplies,d=void 0===m?[]:m,p=Object(l.useState)(),f=a()(p,2),y=f[0],h=f[1],g=c.a.useState(!0),b=a()(g,2),E=b[0],v=b[1],x=$(),w=Object(l.useContext)(le).ctx,S=Object(l.useContext)(Pt),j=a()(S,2),P=j[0],T=j[1];return c.a.createElement(Q,{style:{paddingLeft:0}},c.a.createElement(Q,{style:{paddingVertical:8,borderTopWidth:.5,borderTopColor:x.secondaryBackground}},c.a.createElement(z.a,{onPress:function(){return T(P!=n.id?n.id:void 0)}},c.a.createElement(Q,{style:{borderLeftWidth:2,borderColor:u[o%u.length],paddingLeft:15,paddingVertical:3,backgroundColor:d.includes(n.id)?x.secondaryBackground:x.background}},c.a.createElement(Y,{style:{color:x.text,fontSize:16,marginBottom:5,fontWeight:"500"}},n.author.username,"  ",c.a.createElement(Y,{style:{color:x.text,fontSize:14}},c.a.createElement(O.a,{name:"heart-outline",size:14,color:x.text,light:!0})," ",n.score,"   ",c.a.createElement(ee,{time:n.created}),!E&&"    ...")),E&&!!n.content_html&&c.a.createElement(Te,{contentHtml:n.content_html,contentText:n.content_text})),P==n.id&&c.a.createElement(Q,{style:kt.buttons},c.a.createElement(we,{type:"reply",post:n,isUpvoted:!1,hideCount:!0,style:kt.button}),c.a.createElement(z.a,{style:kt.button,onPress:function(){oe(ae.a.Medium),i.navigate("Reply",{id:n.id,title:n.author.username,html:n.content_html,type:"reply"})}},c.a.createElement(O.a,{color:x.text,size:20,name:"arrow-undo-outline"})),c.a.createElement(z.a,{style:kt.button,onPress:function(){v((function(e){return!e}))}},c.a.createElement(O.a,{color:((null==(t=n.replies)?void 0:t.items.length)||0)>0?x.text:x.secondaryText,size:20,name:E?"chevron-up-outline":"chevron-down-outline"}))))),null!==n.replies?n.replies.items.length>0&&(E?c.a.createElement(Q,{style:{paddingLeft:15}},c.a.createElement(Tt,{replies:n.replies,layer:o+1,navigation:i,postId:s,replyId:n.id,highlightedReplies:d})):c.a.createElement(Y,null,"...")):void 0===y&&c.a.createElement(z.a,{hitSlop:5,onPress:function(){Ee(w,n.id).then(h)}},c.a.createElement(Q,{style:{paddingHorizontal:15,paddingBottom:10}},c.a.createElement(Y,{style:{color:x.tint}},"More replies ",c.a.createElement(O.a,{name:"chevron-forward-outline"})))),void 0!==y&&c.a.createElement(Q,{style:{paddingLeft:15}},c.a.createElement(Tt,{replies:y,navigation:i,layer:o+1,postId:s,replyId:n.id})))}var kt=R.a.create({buttons:{display:"flex",flexDirection:"row",justifyContent:"flex-end",alignItems:"center",paddingHorizontal:15},button:{padding:10,paddingHorizontal:15}});function zt(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function _t(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?zt(Object(n),!0).forEach((function(t){m()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):zt(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function Lt(e){var t=e.navigation,n=e.route,r=n.params.post,o=Object(l.useState)(n.params.highlightedReplies),i=a()(o,2),u=i[0],s=i[1],m=Object(l.useState)(0),d=a()(m,2),f=d[0],y=d[1],h=Object(l.useState)(),g=a()(h,2),b=g[0],E=g[1],v=function(e,t,n,r){var o=Object(l.useState)({items:[]}),i=a()(o,2),c=i[0],u=i[1];return Object(l.useEffect)((function(){r?ge(e,r).then((function(t){return p.a.async((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,p.a.awrap(Ee(e,t.id));case 2:t.replies=n.sent,u({items:[t],next_page:null});case 4:case"end":return n.stop()}}),null,null,null,Promise)})):be(e,t).then((function(e){u(e)}))}),n),c}(Object(l.useContext)(le).ctx,r.id,[f,null==u?void 0:u.join(",")],null==u?void 0:u[0]),x=$();return Object(l.useEffect)((function(){return t.addListener("focus",(function(){return y((function(e){return e+1}))}))}),[]),c.a.createElement(We.a,null,c.a.createElement(Q,{style:_t(_t({},Bt.item),{},{backgroundColor:x.background})},c.a.createElement(Ie,{post:r,navigation:t,showHtmlContent:!0,showCommunityHost:!0}),c.a.createElement(Q,{style:Bt.actions},c.a.createElement(O.a,{name:"bookmark-outline",size:25,color:x.text}),c.a.createElement(z.a,{hitSlop:5,onPress:function(){oe(ae.a.Medium),t.navigate("Reply",{id:r.id,title:r.title,html:r.content_html,type:"post"})}},c.a.createElement(O.a,{name:"arrow-undo-outline",size:25,color:x.text})),c.a.createElement(z.a,{hitSlop:5,onPress:function(){oe(ae.a.Medium),St.a.share({message:r.title,url:"https://dev.goldandblack.xyz/p/posts/"+r.id,title:"Hoot"})}},c.a.createElement(O.a,{name:"share-outline",size:25,color:x.text}))),u&&c.a.createElement(z.a,{onPress:function(){return s(void 0)}},c.a.createElement(Y,{style:{color:x.tint,paddingVertical:10}},"Show all replies")),c.a.createElement(Pt.Provider,{value:[b,E]},c.a.createElement(Tt,{replies:v,navigation:t,postId:r.id,highlightedReplies:u})),c.a.createElement(Q,{style:{height:300}})))}var Bt=R.a.create({container:{flex:1,marginTop:Ot.a.currentHeight||0},item:{marginVertical:0,marginHorizontal:0},title:{fontSize:20,padding:15},contentText:{fontSize:12},link:{paddingVertical:10,paddingHorizontal:15,backgroundColor:"#8884",borderRadius:5,marginHorizontal:15},image:{width:"100%",height:void 0,resizeMode:"contain"},foot:{display:"flex",flexDirection:"row",justifyContent:"space-between",alignItems:"center",width:"100%",padding:15,borderBottomColor:"#8884",borderBottomWidth:2},by:{fontSize:11},actions:{display:"flex",flexDirection:"row",justifyContent:"space-around",alignItems:"center",padding:10}}),It=n(71);function Ht(e){var t=e.navigation;return l.createElement(M.a,{style:Dt.container},l.createElement(A.a,{style:Dt.title},"This screen doesn't exist."),l.createElement(It.a,{onPress:function(){return t.replace("Root")},style:Dt.link},l.createElement(A.a,{style:Dt.linkText},"Go to home screen!")))}var Dt=R.a.create({container:{flex:1,backgroundColor:"#fff",alignItems:"center",justifyContent:"center",padding:20},title:{fontSize:20,fontWeight:"bold"},link:{marginTop:15,paddingVertical:15},linkText:{fontSize:14,color:"#2e78b7"}});function Rt(e,t){var n;return p.a.async((function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,p.a.awrap(ge(e,t));case 2:return n=r.sent,r.abrupt("return",{type:"comment",id:t,content_text:n.content_text,content_html:n.content_html,author:n.author});case 4:case"end":return r.stop()}}),null,null,null,Promise)}function Vt(e){return p.a.async((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",{type:"post",id:e.id,content_text:e.title,author:e.author});case 1:case"end":return t.stop()}}),null,null,null,Promise)}function Wt(e){var t=e.navigation,n=Object(l.useState)([]),r=a()(n,2),o=r[0],i=r[1],u=Object(l.useState)(!0),s=a()(u,2),m=s[0],d=s[1],f=Object(l.useState)(0),y=a()(f,2),h=y[0],g=y[1],b=$(),E=Object(l.useContext)(le).ctx;if(Object(l.useEffect)((function(){E.login&&function(e){return p.a.async((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",ce(e,"GET","users/~me/notifications").then((function(e){return e.json()})));case 1:case"end":return t.stop()}}),null,null,null,Promise)}(E).then((function(e){var t=e.map((function(e){return function(e,t){var n,r,a;return p.a.async((function(o){for(;;)switch(o.prev=o.next){case 0:if(n=he(e,t.post.id),!t.comment){o.next=5;break}o.t0=Rt(e,t.comment),o.next=10;break;case 5:return o.t1=Vt,o.next=8,p.a.awrap(n);case 8:o.t2=o.sent,o.t0=(0,o.t1)(o.t2);case 10:return r=o.t0,o.next=13,p.a.awrap(ge(e,t.reply.id));case 13:return a=o.sent,o.t3=t.unseen,o.t4={id:a.id,content_text:a.content_text,content_html:a.content_html,author:a.author},o.next=18,p.a.awrap(r);case 18:return o.t5=o.sent,o.next=21,p.a.awrap(n);case 21:return o.t6=o.sent,o.abrupt("return",{unseen:o.t3,reply:o.t4,origin:o.t5,post:o.t6});case 23:case"end":return o.stop()}}),null,null,null,Promise)}(E,e)}));Promise.all(t).then(i).then((function(){return d(!1)}))}))}),[h]),Object(l.useEffect)((function(){return t.addListener("focus",(function(){return g((function(e){return e+1}))}))}),[]),!E.login)return c.a.createElement(rt,null);return c.a.createElement(V.a,{style:Nt.container,data:o,renderItem:function(e){var n=e.item;return c.a.createElement(z.a,{style:[Nt.item,{borderColor:b.secondaryBackground}],onPress:function(){var e="comment"===n.origin.type?[n.origin.id,n.reply.id]:[n.reply.id];t.navigate("Post",{post:n.post,highlightedReplies:e})}},c.a.createElement(Y,{style:Nt.name},n.post.author.username),c.a.createElement(Y,{style:Nt.title},n.post.title),c.a.createElement(Y,null,"In"," ",c.a.createElement(ze,{name:n.post.community.name,host:n.post.community.host,local:n.post.community.local,showHost:"always",colorize:"never"})),"comment"===n.origin.type?c.a.createElement(c.a.Fragment,null,c.a.createElement(Q,{style:[Nt.level1,{borderColor:b.secondaryText}]},c.a.createElement(Y,{style:Nt.name},n.origin.author.username),c.a.createElement(Te,{contentHtml:n.origin.content_html,contentText:n.origin.content_text})),c.a.createElement(Q,{style:[Nt.level2,{borderColor:b.tint}]},c.a.createElement(Y,{style:Nt.name},n.reply.author.username),c.a.createElement(Te,{contentHtml:n.reply.content_html,contentText:n.reply.content_text}))):c.a.createElement(c.a.Fragment,null,c.a.createElement(Q,{style:[Nt.level1,{borderColor:b.tint}]},c.a.createElement(Y,{style:Nt.name},n.reply.author.username),c.a.createElement(Te,{contentHtml:n.reply.content_html,contentText:n.reply.content_text}))))},keyExtractor:function(e,t){return e.reply.id+"-"+t},refreshing:m,onRefresh:function(){d(!0),g((function(e){return e+1}))}})}var Nt=R.a.create({container:{flex:1},item:{borderBottomWidth:5,padding:15},title:{fontSize:20,fontWeight:"bold"},level1:{marginTop:5,borderLeftWidth:2,paddingLeft:15,padding:5},level2:{marginTop:5,marginLeft:15,borderLeftWidth:2,paddingLeft:15,padding:5},name:{fontWeight:"600",marginBottom:3},thin:{fontWeight:"200"}});function Ft(e){var t=e.navigation,n=Object(l.useState)(""),r=a()(n,2),o=r[0],i=r[1],u=Object(l.useState)(""),s=a()(u,2),m=s[0],d=s[1],f=$(),y=Object(l.useContext)(le).ctx;return c.a.createElement(Q,{style:Ut.root},c.a.createElement(G.a,{style:[Ut.input,{fontSize:20,color:f.text}],placeholder:"Community Name",value:o,onChangeText:i}),o.length>=4?c.a.createElement(c.a.Fragment,null,c.a.createElement(G.a,{style:[Ut.input,{color:f.text}],placeholder:"Description (Optional)",value:m,onChangeText:d}),c.a.createElement(Qe.a,{title:"Submit",color:f.tint,onPress:function(){(function(e,t){return p.a.async((function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",ce(e,"POST","communities",{name:t}).then((function(e){return e.json()})));case 1:case"end":return n.stop()}}),null,null,null,Promise)})(y,o).then((function(e){var n,r;return p.a.async((function(a){for(;;)switch(a.prev=a.next){case 0:if(n=e.community.id,!m){a.next=4;break}return a.next=4,p.a.awrap(fe(y,n,m));case 4:return a.next=6,p.a.awrap(pe(y,n));case 6:return a.next=8,p.a.awrap(me(y,n));case 8:r=a.sent,t.replace("Community",{community:r});case 10:case"end":return a.stop()}}),null,null,null,Promise)})).catch((function(e){return ne.a.alert("Failed to create community",e)}))},accessibilityLabel:"Create new community"})):c.a.createElement(Y,null,o.length>0&&4-o.length))}var Ut=R.a.create({root:{flex:1,alignItems:"flex-start",padding:15,height:"100%",width:"100%"},title:{fontSize:20,fontWeight:"bold"},separator:{marginVertical:30,height:1,width:"80%"},inputContainer:{width:"100%",padding:20},input:{paddingVertical:10,width:"100%",borderRadius:8},item:{paddingHorizontal:20,paddingVertical:10,marginHorizontal:20,marginBottom:1}});function At(e){var t=e.navigation,n=e.route,r=Object(l.useState)(!1),o=a()(r,2),i=o[0],u=o[1],s=Object(l.useState)(""),m=a()(s,2),d=m[0],f=m[1],y=Object(l.useState)(),h=a()(y,2),g=h[0],b=h[1],E=Object(l.useState)(""),v=a()(E,2),x=v[0],w=v[1],O=$();return c.a.createElement(z.a,{style:{flex:1},onPress:function(){return"web"!==_.a.OS&&Xe.a.dismiss()}},c.a.createElement(Ze.a,{style:Mt.root,behavior:"padding"},c.a.createElement(z.a,null,c.a.createElement(Y,null,n.params.node)),i?c.a.createElement(c.a.Fragment,null,g?c.a.createElement(c.a.Fragment,null,c.a.createElement(X,{placeholder:"New Password",style:Mt.input,value:x,onChangeText:w,autoCapitalize:"none",secureTextEntry:!0,textContentType:"password",autoCompleteType:"password"}),c.a.createElement(Q,{style:Mt.actionButtons},c.a.createElement(Qe.a,{title:"Go Back",onPress:function(){return u(!1)},color:O.secondaryTint}),c.a.createElement(Qe.a,{title:"Submit",onPress:function(){return x?g?void(e={apiUrl:"https://"+n.params.node+"/api/unstable"},r=g,a=x,p.a.async((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",ce(e,"POST","forgot_password/keys/"+r+"/reset",{new_password:a},!0));case 1:case"end":return t.stop()}}),null,null,null,Promise)).then((function(){return t.popToTop()})):ne.a.alert("No key","Fail. This shouldn't happen"):ne.a.alert("Password required");var e,r,a},color:O.tint}))):c.a.createElement(X,{placeholder:"Key",style:Mt.input,onChangeText:function(e){e.length<6||function(e,t){return p.a.async((function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",ce(e,"GET","forgot_password/keys/"+t,void 0,!0));case 1:case"end":return n.stop()}}),null,null,null,Promise)}({apiUrl:"https://"+n.params.node+"/api/unstable"},e).then((function(){return b(e)}))},autoCapitalize:"none"})):c.a.createElement(c.a.Fragment,null,c.a.createElement(X,{style:Mt.input,placeholder:"Email Address",value:d,onChangeText:f,keyboardType:"email-address",textContentType:"emailAddress",autoCompleteType:"email",returnKeyType:"go",autoCapitalize:"none"}),c.a.createElement(Qe.a,{title:"Submit",onPress:function(){if(!d)return ne.a.alert("Email address required","An email with a password reset key will be emailed to you");(function(e,t){return p.a.async((function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",ce(e,"POST","forgot_password/keys",{email_address:t},!0));case 1:case"end":return n.stop()}}),null,null,null,Promise)})({apiUrl:"https://"+n.params.node+"/api/unstable"},d).then((function(){u(!0)})).catch((function(e){return ne.a.alert("Failed to send reset key",e)}))},color:O.tint}))))}var Mt=R.a.create({root:{flex:1,alignItems:"center",justifyContent:"center",padding:30},input:{width:"100%",paddingVertical:10,paddingHorizontal:15,marginTop:15},actionButtons:{display:"flex",width:"100%",flexDirection:"row",justifyContent:"space-around"}});function Gt(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function $t(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Gt(Object(n),!0).forEach((function(t){m()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Gt(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function Jt(e){var t=e.navigation,n=e.route.params.community,r=Object(l.useState)(n.description||""),o=a()(r,2),i=o[0],u=o[1],s=$(),m=Object(l.useContext)(le).ctx;return c.a.createElement(Ze.a,{behavior:"ios"===_.a.OS?"padding":"height"},c.a.createElement(z.a,{style:Kt.root,onPress:function(){return"web"!==_.a.OS&&Xe.a.dismiss()}},c.a.createElement(ze,{name:n.name,host:n.host,local:n.local,showHost:"always",newLine:!0,style:Kt.title}),c.a.createElement(X,{style:Kt.input,multiline:!0,placeholder:"Add a description",value:i,onChangeText:u}),c.a.createElement(Qe.a,{title:"Submit",color:s.tint,onPress:function(){fe(m,n.id,i).then((function(){return me(m,n.id)})).then((function(e){return t.navigate("Community",{community:$t($t({},e),{},{description:i})})})).catch((function(e){return ne.a.alert("Failed to edit community",e)}))}})))}var Kt=R.a.create({root:{padding:20,paddingBottom:100},title:{fontSize:20,marginVertical:10},input:{marginVertical:20,minHeight:100}});function qt(e){var t=e.colorScheme;return c.a.createElement(j.a,{linking:D,theme:"dark"===t?P.a:T.a},c.a.createElement(Qt,null))}var Yt=Object(C.a)();function Qt(){return c.a.createElement(Yt.Navigator,null,c.a.createElement(Yt.Screen,{name:"Root",component:Zt,options:{headerShown:!1}}),c.a.createElement(Yt.Screen,{name:"Web",component:Lt}),c.a.createElement(Yt.Screen,{name:"Post",component:Lt}),c.a.createElement(Yt.Screen,{name:"Reply",component:xt}),c.a.createElement(Yt.Screen,{name:"Community",component:gt}),c.a.createElement(Yt.Screen,{name:"NewCommunity",component:Ft}),c.a.createElement(Yt.Screen,{name:"EditCommunity",component:Jt}),c.a.createElement(Yt.Screen,{name:"Settings",component:ht}),c.a.createElement(Yt.Screen,{name:"ForgotPassword",component:At,options:{title:"Forgot Password"}}),c.a.createElement(Yt.Screen,{name:"NotFound",component:Ht,options:{title:"Oops!"}}),c.a.createElement(Yt.Group,{screenOptions:{presentation:"modal"}},c.a.createElement(Yt.Screen,{name:"Modal",component:Lt})))}var Xt=Object(S.a)();function Zt(e){var t=e.navigation,n=Object(l.useState)("hot"),r=a()(n,2),o=r[0],i=r[1],u=v();return c.a.createElement(Xt.Navigator,{initialRouteName:"FeedScreen",screenOptions:{tabBarActiveTintColor:B[u].tint,tabBarShowLabel:!1}},c.a.createElement(Xt.Screen,{name:"FeedScreen",component:ot,initialParams:{sort:o},options:function(e){var t=e.navigation;return{title:"Hoot",tabBarIcon:function(e){var t=e.color;return c.a.createElement(en,{name:"newspaper-outline",color:t})},headerRight:function(){return c.a.createElement(z.a,{onPress:function(){k.ActionSheetIOS.showActionSheetWithOptions({options:["Cancel","Hot","New"],title:"Sort by:",cancelButtonIndex:0},(function(e){var n=[o,"hot","new"][e];i(n),t.navigate("FeedScreen",{sort:n})}))},style:function(e){return{opacity:e.pressed?.5:1}}},c.a.createElement(O.a,{name:{hot:"flame-outline",new:"time-outline"}[o],size:25,color:B[u].tint,style:{marginRight:15}}))}}}}),c.a.createElement(Xt.Screen,{name:"SearchScreen",component:st,options:{title:"Communities",tabBarIcon:function(e){var t=e.color;return c.a.createElement(en,{name:"search-outline",color:t})}}}),c.a.createElement(Xt.Screen,{name:"NewPostScreen",component:ft,initialParams:{community:void 0},options:{title:"New Post",tabBarIcon:function(e){var t=e.color;return c.a.createElement(en,{name:"add-outline",color:t,size:40})}}}),c.a.createElement(Xt.Screen,{name:"NotificationScreen",component:Wt,options:{title:"Notifications",tabBarIcon:function(e){var t=e.color;return c.a.createElement(en,{name:"notifications-outline",color:t})}}}),c.a.createElement(Xt.Screen,{name:"ProfileScreen",component:mt,options:{title:"Profile",tabBarIcon:function(e){var t=e.color;return c.a.createElement(en,{name:"person-circle-outline",color:t})},headerLeft:function(){return c.a.createElement(z.a,{onPress:function(){t.navigate("Settings")},style:function(e){return{opacity:e.pressed?.5:1}}},c.a.createElement(O.a,{name:"cog-outline",size:25,color:B[u].secondaryText,style:{marginLeft:15}}))}}}))}function en(e){return c.a.createElement(O.a,w()({size:30,style:{marginBottom:-3}},e))}function tn(){var e=function(){var e=l.useState(!1),t=a()(e,2),r=t[0],o=t[1];return l.useEffect((function(){p.a.async((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,h.b(),e.next=4,p.a.awrap(y.b(b(b({},f.a.font),{},{"space-mono":n(238)})));case 4:e.next=9;break;case 6:e.prev=6,e.t0=e.catch(0),console.warn(e.t0);case 9:return e.prev=9,o(!0),h.a(),e.finish(9);case 13:case"end":return e.stop()}}),null,null,[[0,6,9,13]],Promise)}),[]),r}(),t=v(),r=Object(l.useState)(ie),s=a()(r,2),m=s[0],d=s[1];function g(e){Ue(e).then((function(){return o.a.setItem("@lotide_ctx",JSON.stringify(e))})).then((function(){return d(e)}))}return Object(l.useEffect)((function(){Fe().then((function(e){void 0!==e&&d(e)}))}),[]),Object(l.useEffect)((function(){m.apiUrl&&(ye(m).then((function(e){if(console.log(e),!e.software.version.startsWith("0.9."))throw"Bad version"})).catch((function(){var e;Ge((null==(e=m.login)?void 0:e.user.username)+"@"+m.apiUrl).then((function(){return g({})}))})),m.login&&de(m,m.login.user.id).catch((function(){var e;Ge((null==(e=m.login)?void 0:e.user.username)+"@"+m.apiUrl).then((function(){return g({})}))})))}),[m]),e?c.a.createElement(le.Provider,{value:{ctx:m,setContext:function(e){return g(e)}}},c.a.createElement(u.b,null,c.a.createElement(qt,{colorScheme:t}),c.a.createElement(i.a,null))):null}},219:function(e,t,n){e.exports=n(302)},238:function(e,t,n){e.exports=n.p+"./fonts/SpaceMono-Regular.ttf"},254:function(e,t){}},[[219,1,2]]]);
//# sourceMappingURL=app.282213ad.chunk.js.map
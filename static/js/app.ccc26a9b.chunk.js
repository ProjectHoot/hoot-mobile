(this.webpackJsonp=this.webpackJsonp||[]).push([[0],{214:function(e,t,n){"use strict";n.d(t,"a",(function(){return mn}));var r=n(3),a=n.n(r),o=n(47),i=n(216),l=n(0),c=n.n(l),s=n(321),u=n(4),m=n.n(u),d=n(2),p=n.n(d),f=n(311),y=n(318),h=n(153);function g(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function b(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?g(Object(n),!0).forEach((function(t){m()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):g(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var E=n(101);function v(){return Object(E.a)()}var x=n(41),w=n.n(x),O=n(24),S=n(316),j=n(312),P=n(313),T=n(125),C=n(317),k=n(113),z=n(16),L=n(8),_="web"===L.a.OS?function(){}:n(113).PlatformColor,I={light:"ios"===L.a.OS?B():{tint:"orange",secondaryTint:"purple",text:"#111",secondaryText:"#333",placeholderText:"#444",background:"#fff",secondaryBackground:"#eee",tertiaryBackground:"#ccc",tabIconDefault:"#ccc",tabIconSelected:"orange",red:"red",orange:"orange",yellow:"yellow",green:"green",teal:"eeal",blue:"blue",indigo:"indigo",purple:"purple"},dark:"ios"===L.a.OS?B():{tint:"orange",secondaryTint:"purple",text:"#fff",secondaryText:"#666",placeholderText:"#aaa",background:"#111",secondaryBackground:"#222",tertiaryBackground:"#222",tabIconDefault:"#ccc",tabIconSelected:"orange",red:"red",orange:"orange",yellow:"yellow",green:"green",teal:"eeal",blue:"#68f",indigo:"indigo",purple:"purple"}};function B(){return{tint:_("systemOrange"),secondaryTint:_("systemPurple"),text:_("label"),secondaryText:_("secondaryLabel"),placeholderText:_("placeholderText"),background:_("systemBackground"),secondaryBackground:_("secondarySystemBackground"),tertiaryBackground:_("tertiarySystemBackground"),tabIconDefault:_("secondaryLabel"),tabIconSelected:_("systemOrange"),red:_("systemRed"),orange:_("systemOrange"),yellow:_("systemYellow"),green:_("systemGreen"),teal:_("systemTeal"),blue:_("systemBlue"),indigo:_("systemIndigo"),purple:_("systemPurple")}}var H=n(129),R={prefixes:[H.a("/")],config:{screens:{Root:{screens:{TabOne:{screens:{TabOneScreen:"one"}},TabTwo:{screens:{TabTwoScreen:"two"}}}},Modal:"modal",NotFound:"*"}}},D=n(1),V=n(45),W=n(39),N=n(205),F=n(25),U=n(11),A=n.n(U),M=n(23),G=n(5),$=n(50);function J(){var e=v();return I[e]}var K=["style","secondary","tint"],q=["style"],Y=["style","placeholderTextColor"];function X(e){var t=e.style,n=e.secondary,r=e.tint,a=A()(e,K),o=J(),i=n||r?n&&!r?o.secondaryText:r&&!n?o.tint:o.secondaryTint:o.text;return c.a.createElement(M.a,w()({style:[{color:i},t]},a))}function Q(e){var t=e.style,n=A()(e,q),r=J().background;return c.a.createElement(G.a,w()({style:[{backgroundColor:r},t]},n))}var Z=Object(l.forwardRef)((function(e,t){var n=e.style,r=e.placeholderTextColor,a=A()(e,Y),o=J(),i={backgroundColor:o.secondaryBackground,paddingHorizontal:10,paddingVertical:5,borderRadius:8,color:o.text};return c.a.createElement($.a,w()({ref:t,style:[i,n],placeholderTextColor:r||o.placeholderText},a))}));function ee(e){return Object(l.useMemo)((function(){return function(e){var t=Math.round((Date.now()-Date.parse(e))/1e3),n=Math.round(t/60),r=Math.round(n/60),a=Math.round(r/24),o=Math.round(a/7),i=Math.round(a/30.4),l=Math.round(a/365);return n<60&&n+"min"||r<24&&r+"h"||a<7&&a+"d"||o<5&&o+"w"||i<12&&i+"mo"||l+"y"}(e)}),[e])}function te(e){var t=ee(e.time);return c.a.createElement(z.a,{hitSlop:8,onPress:function(){return F.a.alert("Date posted",e.time)}},c.a.createElement(X,{style:ne.root},c.a.createElement(N.a,{name:"time-outline",size:14})," ",t))}var ne=D.a.create({root:{}}),re=n(147),ae=n(89);function oe(e){return p.a.async((function(t){for(;;)switch(t.prev=t.next){case 0:if("web"!==L.a.OS){t.next=2;break}return t.abrupt("return");case 2:return t.next=4,p.a.awrap(re.a(e));case 4:case"end":return t.stop()}}),null,null,null,Promise)}var ie={apiUrl:"https://hoot.goldandblack.xyz/api/unstable",login:void 0},le=Object(l.createContext)({ctx:ie,setContext:function(e){}}),ce=n(99),se=n(130),ue=Object(se.b)({name:"vote",initialState:{post:{},reply:{}},reducers:{setVote:function(e,t){var n=t.payload;e[n.type][n.id]=n.vote}}}),me=ue.actions.setVote,de=ue.reducer;function pe(e,t,n,r){var a,o=arguments;return p.a.async((function(i){for(;;)switch(i.prev=i.next){case 0:if(a=o.length>4&&void 0!==o[4]&&o[4],e.apiUrl){i.next=3;break}throw"No API url";case 3:if(a||void 0!=e.login){i.next=5;break}throw"Not logged in";case 5:return i.abrupt("return",fetch(e.apiUrl+"/"+n,{method:t,headers:fe(e),body:void 0!==r?JSON.stringify(r):void 0}).then((function(e){return p.a.async((function(t){for(;;)switch(t.prev=t.next){case 0:if(!e.ok){t.next=4;break}return t.abrupt("return",e);case 4:return t.next=6,p.a.awrap(e.text());case 6:throw t.sent;case 7:case"end":return t.stop()}}),null,null,null,Promise)})).catch((function(r){throw console.error("Lotide Service Error: "+t+" "+e.apiUrl+"/"+n+"\n"+r,e),r})));case 6:case"end":return i.stop()}}),null,null,null,Promise)}function fe(e){return void 0!==e.login?{Authorization:"Bearer "+e.login.token,"Content-Type":"application/json"}:void 0}function ye(e){var t,n,r=arguments;return p.a.async((function(a){for(;;)switch(a.prev=a.next){case 0:return t=r.length>1&&void 0!==r[1]&&r[1],n=r.length>2?r[2]:void 0,a.abrupt("return",pe(e,"GET","communities?include_your=true&limit=100"+(t?"&your_follow.accepted=true":"")+(n?"&page="+n:"")).then((function(e){return e.json()})).then((function(e){return e})));case 3:case"end":return a.stop()}}),null,null,null,Promise)}function he(e,t){return p.a.async((function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",pe(e,"GET","communities/"+t+"?include_your=true").then((function(e){return e.json()})));case 1:case"end":return n.stop()}}),null,null,null,Promise)}function ge(e,t){return p.a.async((function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",pe(e,"GET","users/"+t,void 0,!0).then((function(e){return e.json()})));case 1:case"end":return n.stop()}}),null,null,null,Promise)}function be(e,t){return p.a.async((function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",pe(e,"POST","communities/"+t+"/follow",{try_wait_for_accept:!0}).then((function(e){return e.json()})));case 1:case"end":return n.stop()}}),null,null,null,Promise)}function Ee(e,t,n){return p.a.async((function(r){for(;;)switch(r.prev=r.next){case 0:return r.abrupt("return",pe(e,"PATCH","communities/"+t,{description:n}));case 1:case"end":return r.stop()}}),null,null,null,Promise)}function ve(e){return p.a.async((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",pe(e,"GET","instance",void 0,!0).then((function(e){return e.json()})));case 1:case"end":return t.stop()}}),null,null,null,Promise)}function xe(e,t){return p.a.async((function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",pe(e,"GET","posts/"+t,void 0,!0).then((function(e){return e.json()})));case 1:case"end":return n.stop()}}),null,null,null,Promise)}function we(e,t){return p.a.async((function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",pe(e,"GET","comments/"+t,void 0,!0).then((function(e){return e.json()})));case 1:case"end":return n.stop()}}),null,null,null,Promise)}function Oe(e,t,n){return p.a.async((function(r){for(;;)switch(r.prev=r.next){case 0:return r.abrupt("return",pe(e,"GET","posts/"+t+"/replies?limit=10&include_your=true"+(n?"&page="+n:"")).then((function(e){return e.json()})));case 1:case"end":return r.stop()}}),null,null,null,Promise)}function Se(e,t,n){return p.a.async((function(r){for(;;)switch(r.prev=r.next){case 0:return r.abrupt("return",pe(e,"GET","comments/"+t+"/replies?limit=10&include_your=true&sort=hot"+(n?"&page="+n:"")).then((function(e){return e.json()})));case 1:case"end":return r.stop()}}),null,null,null,Promise)}function je(e,t){var n=null!==t.your_vote&&void 0!==t.your_vote,r=Object(ce.c)((function(n){return n.vote[e][t.id]})),a=Object(ce.b)(),o=Object(l.useContext)(le).ctx;Object(l.useEffect)((function(){void 0===r&&c(n)}),[n]);var i=!!r;function c(n){a(me({type:e,id:t.id,vote:n}))}var s=i&&!n,u=!i&&n;return{isUpvoted:i,score:t.score+ +s-+u,addVote:function(){"post"==e?function(e,t){return p.a.async((function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",pe(e,"PUT","posts/"+t+"/your_vote"));case 1:case"end":return n.stop()}}),null,null,null,Promise)}(o,t.id).then((function(){return c(!0)})):function(e,t){return p.a.async((function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",pe(e,"PUT","comments/"+t+"/your_vote"));case 1:case"end":return n.stop()}}),null,null,null,Promise)}(o,t.id).then((function(){return c(!0)}))},removeVote:function(){"post"==e?function(e,t){return p.a.async((function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",pe(e,"DELETE","posts/"+t+"/your_vote"));case 1:case"end":return n.stop()}}),null,null,null,Promise)}(o,t.id).then((function(){return c(!1)})):function(e,t){return p.a.async((function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",pe(e,"DELETE","comments/"+t+"/your_vote"));case 1:case"end":return n.stop()}}),null,null,null,Promise)}(o,t.id).then((function(){return c(!1)}))}}}function Pe(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Te(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Pe(Object(n),!0).forEach((function(t){m()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Pe(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function Ce(e){var t=J(),n=Object(l.useContext)(le).ctx,r=je(e.type,e.content),a=r.isUpvoted,o=r.score,i=r.addVote,s=r.removeVote;var u=a?t.red:t.text;return c.a.createElement(z.a,{onPress:function(){return oe(ae.a.Light),void(void 0!==n.login?a?s():i():F.a.alert("Login to like","Leave a like when you login to a community"))},hitSlop:7,style:e.style},c.a.createElement(Q,{style:ke.root},c.a.createElement(N.a,{name:a?"heart":"heart-outline",color:u,size:25}),!e.hideCount&&c.a.createElement(X,{style:Te(Te({},ke.score),{},{color:u})},"  "+o+"  ")))}var ke=D.a.create({root:{display:"flex",flexDirection:"row",alignItems:"center"},score:{fontSize:18,minWidth:28}}),ze=n(123),Le=n.n(ze),_e=n(217);function Ie(e){var t=J(),n=Object(l.useMemo)((function(){return e.contentHtml||(""===(t=e.contentMarkdown)||void 0===t?void 0:t.replace(/^### (.*$)/gim,"<h3>$1</h3>").replace(/^## (.*$)/gim,"<h2>$1</h2>").replace(/^# (.*$)/gim,"<h1>$1</h1>").replace(/^\> (.*$)/gim,"<blockquote>$1</blockquote>").replace(/\*\*(.*)\*\*/gim,"<b>$1</b>").replace(/\*(.*)\*/gim,"<i>$1</i>").replace(/!\[(.*?)\]\((.*?)\)/gim,"<img alt='$1' src='$2' />").replace(/\[(.*?)\]\((.*?)\)/gim,"<a href='$2'>$1</a>").replace(/\n$/gim,"<br />").trim())||"<p>"+e.contentText+"</p>";var t}),[e.contentHtml,e.contentMarkdown,e.contentText]);return c.a.createElement(_e.a,{RootComponent:function(e){return c.a.createElement(M.a,e)},value:n.replace(/\n/g,""),renderNode:Be(t),stylesheet:{a:{color:t.secondaryTint},cite:{fontStyle:"italic"},del:{textDecorationLine:"line-through",textDecorationStyle:"solid"},dfn:{fontStyle:"italic"},ins:{textDecorationLine:"underline"},samp:{fontFamily:"ios"===L.a.OS?"Menlo":"monospace"},small:{fontSize:10}},textComponentProps:{style:{color:t.text}},onLinkLongPress:function(e){return F.a.alert("Link",e)}})}var Be=function(e){return function(t,n,r,a,o){if(["iframe","script"].includes(t.name||""))return null;function i(){return o(t.children,a)}switch(t.name){case"abbr":return c.a.createElement(z.a,{key:n,onPress:function(){return F.a.alert("Abbr.",t.attribs.title)}},c.a.createElement(M.a,{style:{textDecorationLine:"underline",textDecorationStyle:"dotted"}},i()));case"blockquote":return c.a.createElement(M.a,{key:n},c.a.createElement(G.a,{style:{padding:10}},c.a.createElement(G.a,{style:{borderLeftWidth:2,borderColor:e.secondaryText,paddingLeft:10,paddingVertical:5}},i())),"\n");case"details":return c.a.createElement(He,{key:n},i());case"dl":case"dt":case"dd":return c.a.createElement(M.a,{key:n},i(),"\n");case"figure":return c.a.createElement(G.a,{key:n},i());case"hr":return c.a.createElement(G.a,{key:n,style:{width:200,alignSelf:"stretch",borderBottomWidth:D.a.hairlineWidth||1,borderColor:e.secondaryText}});case"kbd":return c.a.createElement(M.a,{key:n,style:{backgroundColor:e.tertiaryBackground}}," ",i()," ");case"img":return c.a.createElement(M.a,{key:n},"[Image not displayed]");case"li":return c.a.createElement(M.a,{key:n},"\u2022 ",i(),"\n");case"sub":return c.a.createElement(M.a,{key:n,style:{fontSize:10}},i());case"summary":return c.a.createElement(M.a,{key:n},i());case"sup":return c.a.createElement(G.a,{key:n},c.a.createElement(M.a,{style:{fontSize:10}},i()));default:return}}};function He(e){var t=e.children,n=Object(l.useState)(!1),r=a()(n,2),o=r[0],i=r[1],s=J(),u=t.filter((function(e){return""!==e.props.children.toString().trim()})),m=Le()(u),d=m[0],p=m.slice(1);return c.a.createElement(G.a,null,c.a.createElement(z.a,{hitSlop:5,onPress:function(){return i((function(e){return!e}))}},c.a.createElement(M.a,{style:{color:s.secondaryTint}},o?c.a.createElement(O.a,{name:"chevron-down-outline"}):c.a.createElement(O.a,{name:"chevron-forward-outline"}),d)),o&&p)}var Re=D.a.create({root:{},name:{fontWeight:"500"},host:{fontWeight:"200"}}),De=c.a.memo((function(e){var t=J(),n=e.colorize||"never",r=e.showHost||"only_foreign",a=function(e,t){return"always"===e||"never"!==e&&!t},o=a(n,e.local),i=a(r,e.local),l=o?{color:e.local?t.blue:t.green}:{};return c.a.createElement(X,{style:[Re.root,e.style]},c.a.createElement(X,{style:[Re.name,l,e.styleName]},e.name),i&&c.a.createElement(X,{style:[Re.host,{color:t.secondaryText},e.styleHost]},e.newLine&&"\n",!e.newLine&&"@",e.host))}));function Ve(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function We(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Ve(Object(n),!0).forEach((function(t){m()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Ve(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function Ne(e){var t=Object(l.useState)(1),n=a()(t,2),r=n[0],o=n[1],i=Object(l.useMemo)((function(){return!!(t=e.post.href)&&[".png",".jpg",".jpeg",".bmp",".gif",".webp"].some((function(e){return t.endsWith(e)}));var t}),[e.post.href]),s=J(),u=e.post;return c.a.createElement(Q,null,c.a.createElement(X,{style:Fe.title},e.post.sticky&&c.a.createElement(c.a.Fragment,null,c.a.createElement(O.a,{name:"pin",size:25,color:s.secondaryTint})," "),e.post.title),e.post.href&&(i?c.a.createElement(W.a,{style:We(We({},Fe.image),{},{aspectRatio:r,backgroundColor:s.secondaryBackground}),source:{uri:e.post.href},onLoad:function(e){return o(Math.max(e.nativeEvent.source.width/e.nativeEvent.source.height,.5))}}):c.a.createElement(z.a,{style:[Fe.link,{backgroundColor:s.secondaryBackground}],onPress:function(){oe(ae.a.Medium),e.post.href&&Object(H.b)(e.post.href)}},c.a.createElement(X,null,e.post.href))),e.showHtmlContent&&!!e.post.content_html&&c.a.createElement(Q,{style:{padding:15}},c.a.createElement(Ie,{contentHtml:e.post.content_html,contentText:e.post.content_text})),e.showAuthor&&c.a.createElement(Q,{style:{display:"flex",flexDirection:"row",alignItems:"center",paddingHorizontal:15,paddingTop:15}},c.a.createElement(X,{style:Fe.by},"by","   "),c.a.createElement(De,{name:u.author.username,host:u.author.host,local:u.author.local,showHost:"only_foreign",colorize:"always",newLine:!0})),c.a.createElement(Q,{style:Fe.foot},c.a.createElement(z.a,{hitSlop:8,onPress:function(){return e.navigation.navigate("Community",{community:e.post.community})},style:[Fe.footItem,{display:"flex",flexDirection:"row",alignItems:"center"}]},e.showAuthor&&c.a.createElement(X,{style:Fe.by},"in","   "),c.a.createElement(De,{name:u.community.name,host:u.community.host,local:u.community.local,showHost:"only_foreign",colorize:e.showAuthor?"always":"never",newLine:!0})),c.a.createElement(Q,{style:{flex:1}}),c.a.createElement(Q,{style:Fe.footItem},c.a.createElement(te,{time:e.post.created})),c.a.createElement(Q,{style:Fe.footItem},c.a.createElement(X,{style:Fe.footText},c.a.createElement(O.a,{name:"chatbubble-outline",size:12})," ",e.post.replies_count_total)),c.a.createElement(Q,{style:Fe.footItem},c.a.createElement(Ce,{type:"post",content:u}))))}var Fe=D.a.create({item:{marginVertical:0,marginHorizontal:0},title:{fontSize:20,padding:15},contentText:{fontSize:12},link:{paddingVertical:10,paddingHorizontal:15,borderRadius:5,marginHorizontal:15},image:{width:"100%",height:void 0,resizeMode:"contain"},foot:{display:"flex",flexDirection:"row",justifyContent:"space-between",alignItems:"center",width:"100%"},footText:{},footItem:{padding:15},by:{fontSize:11},score:{fontSize:18},actions:{display:"flex",flexDirection:"row",justifyContent:"space-around",alignItems:"center",padding:10}});var Ue=n(17),Ae=n.n(Ue);function Me(e,t,n){var r=Object(l.useState)([]),o=a()(r,2),i=o[0],c=o[1],s=Object(l.useState)(null),u=a()(s,2),m=u[0],d=u[1],f=Object(l.useState)(null),y=a()(f,2),h=y[0],g=y[1],b=Object(l.useState)(void 0),E=a()(b,2),v=E[0],x=E[1],w=Object(l.useState)(0),O=a()(w,2),S=O[0],j=O[1],P=Object(l.useContext)(le).ctx,T=function(e,t){var n=Object(l.useState)(0),r=a()(n,2),o=r[0],i=r[1],c=Object(l.useState)(!0),s=a()(c,2),u=s[0],m=s[1];return Object(l.useEffect)((function(){e((function(){return m(!1)}))}),[o].concat(Ae()(t))),[u,function(){i((function(e){return e+1})),m(!0)}]}((function(r){P.login&&void 0===v&&(x(m),function(e,t){var n,r,a,o,i=arguments;return p.a.async((function(l){for(;;)switch(l.prev=l.next){case 0:return n=i.length>2&&void 0!==i[2]?i[2]:"hot",r=i.length>3?i[3]:void 0,a=i.length>4?i[4]:void 0,o=[null===t?"posts?sort="+n:"posts?page="+t+"&sort="+n,"include_your=true",void 0!==r&&"in_your_follows="+r,a&&"community="+a].filter((function(e){return e})).join("&"),l.abrupt("return",pe(e,"GET",o).then((function(e){return e.json()})));case 5:case"end":return l.stop()}}),null,null,null,Promise)}(P,m,e,t,n).then((function(e){c((function(t){return[].concat(Ae()(t),Ae()(e.items))})),g(e.next_page),x(void 0)})).then((function(){return r()})).catch((function(e){r(),c((function(t){return[].concat(Ae()(t),[{id:-1,title:"Lotide error",content_html:"<p>Error: "+e+"</p>",created:"",replies_count_total:0,score:0,sticky:!0,author:{id:-1,username:"Failure",local:!1,host:"hoot-mobile"},community:{id:-1,name:"something-went-wrong",local:!1,host:"hoot-mobile"}}])}))})))}),[S,m]),C=a()(T,2),k=C[0],z=C[1];return Object(l.useEffect)((function(){c([]),d(null),g(null),z()}),[P,e]),[i,k,function(){c([]),d(null),g(null),j((function(e){return e+1})),z()},function(){null!==h&&d(h)}]}var Ge=n(37),$e=[{name:"Gold&Black",domain:"hoot.goldandblack.xyz"},{name:"Narwhal.City",domain:"narwhal.city"},{name:"FBXL",domain:"lotide.fbxl.net"},{name:"Tide C",domain:"c.tide.tk"},{name:"Exopla",domain:"lotide.exopla.net.eu.org"},{name:"Narwhal.City (Dev)",domain:"dev.narwhal.city"},{name:"Tide B",domain:"b.tide.tk"},{name:"Tide A",domain:"a.tide.tk"}],Je=function(){return p.a.async((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",o.a.getItem("@lotide_ctx").then((function(e){return null!==e?JSON.parse(e):void 0})));case 1:case"end":return e.stop()}}),null,null,null,Promise)},Ke=function(e){var t;return p.a.async((function(n){for(;;)switch(n.prev=n.next){case 0:if(e.login){n.next=2;break}return n.abrupt("return");case 2:t=e.login.user.username+"@"+e.apiUrl,et.store("@lotide_ctx_arr",t,e);case 4:case"end":return n.stop()}}),null,null,null,Promise)},qe=function(e){return p.a.async((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",et.query("@lotide_ctx_arr",e));case 1:case"end":return t.stop()}}),null,null,null,Promise)},Ye=function(){return p.a.async((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",et.listKeys("@lotide_ctx_arr"));case 1:case"end":return e.stop()}}),null,null,null,Promise)},Xe=function(e){return p.a.async((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",et.remove("@lotide_ctx_arr",e));case 1:case"end":return t.stop()}}),null,null,null,Promise)},Qe=function(e){var t;return p.a.async((function(n){for(;;)switch(n.prev=n.next){case 0:if(e.login){n.next=2;break}return n.abrupt("return");case 2:t=e.login.user.username+"@"+e.apiUrl,et.store("@lotide_ctx_arr",t,{apiUrl:e.apiUrl});case 4:case"end":return n.stop()}}),null,null,null,Promise)},Ze=function(){var e;return p.a.async((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,p.a.awrap(o.a.getItem("@lotide_ctx_arr"));case 2:return e=t.sent,t.abrupt("return",e?JSON.parse(e):{});case 4:case"end":return t.stop()}}),null,null,null,Promise)},et={store:function(e,t,n){var r,a;return p.a.async((function(i){for(;;)switch(i.prev=i.next){case 0:return i.next=2,p.a.awrap(o.a.getItem(e));case 2:return r=i.sent,a=r?JSON.parse(r):{},a[t]=n,i.next=7,p.a.awrap(o.a.setItem(e,JSON.stringify(a)));case 7:case"end":return i.stop()}}),null,null,null,Promise)},query:function(e,t){var n;return p.a.async((function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,p.a.awrap(o.a.getItem(e));case 2:return n=r.sent,r.abrupt("return",n?JSON.parse(n)[t]:void 0);case 4:case"end":return r.stop()}}),null,null,null,Promise)},listKeys:function(e){var t,n;return p.a.async((function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,p.a.awrap(o.a.getItem(e));case 2:return t=r.sent,n=t?JSON.parse(t):{},r.abrupt("return",Object.keys(n));case 5:case"end":return r.stop()}}),null,null,null,Promise)},remove:function(e,t){var n,r,a;return p.a.async((function(i){for(;;)switch(i.prev=i.next){case 0:return i.next=2,p.a.awrap(o.a.getItem(e));case 2:return n=i.sent,r=n?JSON.parse(n):{},a=r[t],delete r[t],i.next=8,p.a.awrap(o.a.setItem(e,JSON.stringify(r)));case 8:return i.abrupt("return",a);case 9:case"end":return i.stop()}}),null,null,null,Promise)}};function tt(e){var t=Object(l.useState)(""),n=a()(t,2),r=n[0],o=n[1],i=Object(l.useState)($e),s=a()(i,2),u=s[0],m=s[1],d=Object(l.useState)([]),p=a()(d,2),f=p[0],y=p[1],h=J(),g=Object(l.useContext)(le);Object(l.useEffect)((function(){$e.map((function(e,t){return ve({apiUrl:"https://"+e.domain+"/api/unstable"}).then((function(e){m((function(n){return n.map((function(n,r){return t!==r?n:{name:n.name,domain:n.domain,instanceInfo:e}}))}))})).catch((function(){m((function(e){return e.map((function(e,n){return t!==n?e:{name:e.name,domain:e.domain,instanceInfo:null}}))}))}))}))}),[]),Object(l.useEffect)((function(){Ze().then((function(e){return Object.entries(e)})).then(y)}),[]);return c.a.createElement(Ge.a,{contentContainerStyle:nt.root},c.a.createElement(X,{style:nt.title},"Login to continue"),f.length>0&&c.a.createElement(X,{style:nt.subtitle},"Select an existing profile"),f.map((function(t){var n,r=t[0].split("@"),o=a()(r,2),i=o[0],l=o[1],s=!!t[1].login,u=s?h.text:h.secondaryText,m=l.replace("http://","").replace("https://","").split(/[/?#]/)[0],d=null==(n=$e.find((function(e){return e.domain==m})))?void 0:n.name;return c.a.createElement(z.a,{key:t[0],onPress:function(){s?g.setContext(t[1]):e.onSelect(m.toLowerCase(),void 0,i)},style:{display:"flex",flexDirection:"row",alignItems:"center"}},c.a.createElement(O.a,{name:s?"lock-open-outline":"lock-closed-outline",color:u,style:{marginRight:10},size:20}),c.a.createElement(De,{name:i,host:m,local:!0,showHost:"always",newLine:!0,style:{paddingVertical:15,paddingBottom:10},styleName:{color:u}}),c.a.createElement(Q,{style:{flex:1}}),c.a.createElement(X,{style:{fontSize:16,color:u,fontFamily:"ios"===L.a.OS?"Georgia":"serif"}},d))})),c.a.createElement(X,{style:nt.subtitle},f.length>0?"Or sign into a new acount":"Enter a host or select one below"),c.a.createElement(Z,{placeholder:"Host domain",style:{paddingVertical:10,paddingHorizontal:10},value:r,onChangeText:o,onSubmitEditing:function(){return e.onSelect(r.toLowerCase())},keyboardType:"url",returnKeyType:"next"}),u.filter((function(e){return""===r||e.domain.includes(r.toLowerCase())||e.name.toLowerCase().includes(r.toLowerCase())})).map((function(t){return c.a.createElement(Q,{key:t.domain},function(t){var n,r=t.item,a=null==(n=r.instanceInfo)?void 0:n.software.version.startsWith("0.9."),o=a?h.text:h.secondaryText;return c.a.createElement(Q,{style:{borderBottomWidth:D.a.hairlineWidth||1,borderColor:h.secondaryText,paddingVertical:25}},c.a.createElement(z.a,{onPress:function(){return a&&e.onSelect(r.domain,r.name)}},c.a.createElement(De,{name:r.name,host:r.domain,local:!1,newLine:!0,styleName:{fontSize:24,fontWeight:"300",fontFamily:"ios"===L.a.OS?"Georgia":"serif",color:o}}),r.instanceInfo?c.a.createElement(c.a.Fragment,null,c.a.createElement(X,{style:{color:h.secondaryText}},r.instanceInfo.software.version,!a&&" - Out of date"),!!r.instanceInfo.description&&c.a.createElement(X,{style:{color:o}},r.instanceInfo.description)):null===r.instanceInfo?c.a.createElement(X,{style:{color:o}},"Failed to load info"):c.a.createElement(X,{style:{color:o}},"Loading...")))}({item:t}))})))}var nt=D.a.create({root:{padding:20},title:{fontSize:24,marginBottom:10,textAlign:"center"},subtitle:{fontWeight:"300",marginBottom:10,marginTop:15,textAlign:"center"}}),rt=n(26),at=n(34),ot=n(48),it=n(28);function lt(e){var t=Object(l.useState)(!1),n=a()(t,2),r=n[0],o=n[1],i=Object(l.useState)(e.username||""),s=a()(i,2),u=s[0],m=s[1],d=Object(l.useState)(""),f=a()(d,2),y=f[0],h=f[1],g=Object(l.useState)(""),b=a()(g,2),E=b[0],v=b[1],x=Object(l.useRef)(null),w=Object(l.useRef)(null),O=J(),S=Object(l.useContext)(le),j=Object(it.o)();function P(e){F.a.alert("Failed to submit",e)}function T(){return u?y?E?void function(e,t,n,r){return p.a.async((function(a){for(;;)switch(a.prev=a.next){case 0:return a.abrupt("return",pe({apiUrl:e},"POST","users",{username:t,password:n,email_address:r,login:!0},!0).then((function(e){return e.json()})));case 1:case"end":return a.stop()}}),null,null,null,Promise)}("https://"+e.domain+"/api/unstable",u,y,E).then((function(t){S.setContext({apiUrl:"https://"+e.domain+"/api/unstable",login:t})})).catch((function(e){F.a.alert("Failed to register",e),console.error(e)})):P("Please enter an email address"):P("Enter a password"):P("Please enter a username")}function C(){return u?y?void function(e,t,n){return p.a.async((function(r){for(;;)switch(r.prev=r.next){case 0:return r.abrupt("return",pe({apiUrl:e},"POST","logins",{username:t,password:n},!0).then((function(e){return e.json()})));case 1:case"end":return r.stop()}}),null,null,null,Promise)}("https://"+e.domain+"/api/unstable",u,y).then((function(t){S.setContext({apiUrl:"https://"+e.domain+"/api/unstable",login:t})})).catch((function(e){F.a.alert("Failed to login",e),console.error(e)})):P("Enter a password"):P("Please enter a username")}function k(){r?T():C()}return c.a.createElement(z.a,{style:{flex:1},onPress:function(){return"web"!==L.a.OS&&at.a.dismiss()}},c.a.createElement(ot.a,{style:ct.root,behavior:"padding"},e.hostName?c.a.createElement(z.a,{style:{alignItems:"center"}},c.a.createElement(X,{style:ct.name},e.hostName),c.a.createElement(X,{style:[ct.domain,{color:O.secondaryText}]},e.domain)):c.a.createElement(z.a,null,c.a.createElement(X,{style:{fontSize:24}},e.domain)),c.a.createElement(z.a,{hitSlop:5,onPress:function(){return o((function(e){return!e}))}},c.a.createElement(X,{style:[ct.loginRegister,{color:O.secondaryText}]},c.a.createElement(X,{style:{color:r?O.secondaryText:O.secondaryTint}},"Login")," | ",c.a.createElement(X,{style:{color:r?O.secondaryTint:O.secondaryText}},"Register"))),r&&c.a.createElement(Z,{style:ct.input,placeholder:"Email Address",value:E,onChangeText:v,keyboardType:"email-address",textContentType:"emailAddress",autoCompleteType:"email",returnKeyType:"next",onSubmitEditing:function(){var e;return null==(e=x.current)?void 0:e.focus()}}),c.a.createElement(Z,{ref:x,style:ct.input,placeholder:"Username",value:u,onChangeText:m,keyboardType:"ascii-capable",textContentType:"username",autoCompleteType:"username",returnKeyType:"next",onSubmitEditing:function(){var e;return null==(e=w.current)?void 0:e.focus()}}),c.a.createElement(Z,{ref:w,style:ct.input,placeholder:"Password",value:y,onChangeText:h,secureTextEntry:!0,textContentType:r?"newPassword":"password",autoCompleteType:"password",returnKeyType:"done",onSubmitEditing:k}),!r&&c.a.createElement(z.a,{style:{padding:15},onPress:function(){return j.navigate("ForgotPassword",{node:e.domain})}},c.a.createElement(X,{secondary:!0},"Forgot Password")),c.a.createElement(Q,{style:ct.actionButtons},c.a.createElement(rt.a,{title:"Change Host",onPress:e.onGoBack,color:O.secondaryTint}),c.a.createElement(rt.a,{title:r?"Register":"Login",onPress:k,color:O.tint}))))}var ct=D.a.create({root:{flex:1,alignItems:"center",justifyContent:"center",padding:35},name:{fontSize:50,fontFamily:"ios"===L.a.OS?"Georgia":"serif"},domain:{fontWeight:"300"},loginRegister:{padding:15},input:{width:"100%",marginVertical:5,paddingHorizontal:20,paddingVertical:10},actionButtons:{width:"100%",display:"flex",flexDirection:"row",justifyContent:"space-around"}});function st(){var e=Object(l.useState)(),t=a()(e,2),n=t[0],r=t[1],o=Object(l.useState)(),i=a()(o,2),s=i[0],u=i[1],m=Object(l.useState)(),d=a()(m,2),p=d[0],f=d[1];return c.a.createElement(Q,{style:ut.root},s?c.a.createElement(lt,{hostName:n,domain:s,username:p,onGoBack:function(){return u(void 0)}}):c.a.createElement(tt,{onSelect:function(e,t,n){r(t),u(e),f(n)}}))}var ut=D.a.create({root:{width:"100%",height:"100%"},container:{flex:1,alignItems:"center",justifyContent:"center"},input:{width:"100%",marginBottom:20,paddingHorizontal:20,paddingVertical:10},actionButtons:{display:"flex",flexDirection:"row",justifyContent:"space-around",width:"100%"}}),mt=n(111);function dt(e){if("ios"!==L.a.OS)return c.a.createElement(c.a.Fragment,null,e.children);var t=e.distanceToActivate||60,n=Object(l.useState)(!1),r=a()(n,2),o=r[0],i=r[1],s=Object(l.useState)(0),u=a()(s,2),m=u[0],d=u[1],p=Object(l.useState)(!1),f=a()(p,2),y=f[0],h=f[1],g=Object(l.useState)(!1),b=a()(g,2),E=b[0],v=b[1],x=Object(l.useState)(!1),w=a()(x,2),S=w[0],j=w[1],P=Object(mt.a)(),T=Object(l.useRef)(null);return Object(l.useEffect)((function(){m<0&&!y?(oe(ae.a.Light),h(!0)):m>=0&&y&&(h(!1),o||(j(!0),e.onLeftSide())),m>=2*t&&!E?(oe(ae.a.Light),v(!0)):m<2*t&&E&&(v(!1),o||(j(!0),e.onRightSide())),m==t&&(null==e.onReturnToCenter||e.onReturnToCenter(),v(!1),h(!1),j(!1))}),[m]),c.a.createElement(Ge.a,{ref:T,horizontal:!0,snapToOffsets:[t,t+P.width],snapToStart:!1,snapToEnd:!1,onScrollBeginDrag:function(){return i(!0)},onScrollEndDrag:function(){var e;null==(e=T.current)||e.scrollTo({x:t}),i(!1)},contentOffset:{x:t,y:0},onScroll:function(e){var t,n,r=null==e||null==(t=e.nativeEvent)||null==(n=t.contentOffset)?void 0:n.x;d(r)},scrollEventThrottle:100,showsHorizontalScrollIndicator:!1,style:{backgroundColor:e.backgroundColor},overScrollMode:"always"},c.a.createElement(G.a,{style:{width:t,display:"flex",justifyContent:"center",alignItems:"center"}},c.a.createElement(O.a,{name:e.iconLeftSide[+y||+S],color:e.colorLeftSide,size:25})),c.a.createElement(G.a,{style:{width:P.width}},e.children),c.a.createElement(G.a,{style:{width:t,display:"flex",justifyContent:"center",alignItems:"center"}},c.a.createElement(O.a,{name:e.iconRightSide[+E||+S],color:e.colorRightSide,size:25})))}function pt(e){var t=e.navigation,n=e.route.params.sort,r=Object(l.useContext)(le).ctx,o=Me(n,!0),i=a()(o,4),s=i[0],u=i[1],m=i[2],d=i[3];if(!function(e){return!!e.apiUrl&&!!e.login}(r))return c.a.createElement(st,null);return c.a.createElement(Q,{style:ft.container},c.a.createElement(V.a,{data:s,renderItem:function(e){var n=e.item;return c.a.createElement(yt,{post:n,navigation:t})},keyExtractor:function(e,t){return e.id+"-"+t},refreshing:u,onRefresh:m,onEndReachedThreshold:2,onEndReached:d}))}var ft=D.a.create({container:{flex:1},item:{marginVertical:0,marginHorizontal:0,borderBottomWidth:8},title:{fontSize:20,padding:15,color:"#eee"},contentText:{fontSize:12},link:{paddingVertical:10,paddingHorizontal:15,backgroundColor:"#8884",borderRadius:5,marginHorizontal:15},image:{width:"100%",height:void 0,resizeMode:"contain"},foot:{display:"flex",flexDirection:"row",justifyContent:"space-between",alignItems:"center",width:"100%",padding:15},footText:{color:"#ccc"},by:{fontSize:11},score:{fontSize:18,color:"#bbb"}}),yt=function(e){var t=e.post,n=e.navigation,r=je("post",t),o=r.isUpvoted,i=r.addVote,s=r.removeVote,u=Object(l.useState)(!1),m=a()(u,2),d=m[0],p=m[1],f=J();return c.a.createElement(dt,{iconLeftSide:o!==d?["heart-dislike","heart-dislike-outline"]:["heart-outline","heart"],iconRightSide:["arrow-undo-outline","arrow-undo"],colorLeftSide:f.red,colorRightSide:f.blue,onLeftSide:function(){o?s():i(),p(!0)},onRightSide:function(){n.navigate("Reply",{id:t.id,title:t.title,html:t.content_html,type:"post"})},onReturnToCenter:function(){return p(!1)},backgroundColor:f.secondaryBackground},c.a.createElement(z.a,{style:{width:"100%"},onPress:function(){return n.navigate("Post",{post:t})},onLongPress:function(){oe(ae.a.Heavy),console.log(t)}},c.a.createElement(Q,{style:[ft.item,{borderBottomColor:f.secondaryBackground}]},c.a.createElement(Ne,{post:t,navigation:n}))))};function ht(e){var t,n=Object(l.useState)(),r=a()(n,2),o=r[0],i=r[1],s=Object(l.useState)(""),u=a()(s,2),m=u[0],d=u[1],p=Object(l.useContext)(le).ctx,f=J(),y=e.onlyWhenTyping&&""===m?[]:o?""===m?o.items:o.items.filter((function(e){return e.name.toLowerCase().includes(m.toLowerCase())||e.host.includes(m.toLowerCase())})):[];Object(l.useEffect)((function(){ye(p,!1).then(i)}),[null==(t=p.login)?void 0:t.token,e.focusId]);return c.a.createElement(Q,null,c.a.createElement(Z,{placeholder:e.placeholder||"Filter communities",value:m,onChangeText:d,style:gt.input}),c.a.createElement(V.a,{data:y,renderItem:function(t){var n,r=t.item;return c.a.createElement(z.a,{onPress:function(){return e.onSelect(r)},style:[gt.item,{borderColor:f.secondaryBackground}]},c.a.createElement(De,{name:r.name,host:r.host,local:r.local,colorize:"always",newLine:!0}),c.a.createElement(Q,{style:{display:"flex",flexDirection:"row"}},r.you_are_moderator&&c.a.createElement(O.a,{name:"shield-outline",size:20,color:f.secondaryTint}),(null==(n=r.your_follow)?void 0:n.accepted)&&c.a.createElement(O.a,{name:"checkmark",size:20,color:f.secondaryTint,style:{marginLeft:5}})))},keyExtractor:function(e,t){return e.id+"-"+t},contentContainerStyle:gt.list}))}var gt=D.a.create({root:{flex:1,alignItems:"center",justifyContent:"center"},input:{paddingVertical:10,marginHorizontal:20,marginTop:20},list:{padding:20,paddingBottom:100},item:{display:"flex",flexDirection:"row",justifyContent:"space-between",alignItems:"center",height:50,borderBottomWidth:1,paddingHorizontal:20}});function bt(e){var t=e.navigation,n=Object(l.useState)(0),r=a()(n,2),o=r[0],i=r[1],s=Object(l.useContext)(le).ctx;return Object(l.useEffect)((function(){return t.addListener("focus",(function(){return i((function(e){return e+1}))}))}),[]),s.login?c.a.createElement(ht,{onSelect:function(e){return t.navigate("Community",{community:e})},focusId:o}):c.a.createElement(st,null)}function Et(e){var t,n,r,o=e.navigation,i=Object(l.useState)(),s=a()(i,2),u=s[0],m=s[1],d=Object(l.useState)([]),f=a()(d,2),y=f[0],h=f[1],g=Object(l.useState)([]),b=a()(g,2),E=b[0],v=b[1],x=Object(l.useState)(!1),w=a()(x,2),S=w[0],j=w[1],P=Object(l.useState)(0),T=a()(P,2),C=T[0],k=T[1],L=J(),_=Object(l.useContext)(le),I=_.ctx,B=_.setContext;if(Object(l.useEffect)((function(){return o.addListener("focus",(function(){return k((function(e){return e+1}))}))}),[]),Object(l.useEffect)((function(){I.login&&ye(I,!0).then((function(e){return v(e.items)}))}),[null==(t=I.login)?void 0:t.user.id,C]),Object(l.useEffect)((function(){var e;void 0!==I.login&&void 0!==I.login.user&&ge(I,(null==(e=I.login)?void 0:e.user.id)||0).then(m)}),[null==(n=I.login)?void 0:n.token,C]),Object(l.useEffect)((function(){Ye().then((function(e){return h(e)}))}),[I,C]),void 0===I.login)return c.a.createElement(st,null);return c.a.createElement(Ge.a,{style:[vt.container,{backgroundColor:L.background}]},c.a.createElement(Q,{style:vt.header},c.a.createElement(Q,null,c.a.createElement(z.a,{hitSlop:10,onPress:function(){return j((function(e){return!e}))}},c.a.createElement(X,{style:vt.title},(null==u?void 0:u.username)||I.login.user.username,"  ",c.a.createElement(O.a,{name:"pencil-outline",size:20,color:L.secondaryText}))),c.a.createElement(X,{style:{color:L.secondaryText}},null==u?void 0:u.host),!(null==u||!u.avatar)&&c.a.createElement(X,null,null==u||null==(r=u.avatar)?void 0:r.url),!(null==u||!u.description)&&c.a.createElement(X,null,null==u?void 0:u.description)),c.a.createElement(rt.a,{onPress:function(){F.a.alert("Log out","Would you like to keep the login profile handy for later?",[{text:"Cancel",style:"cancel"},{text:"Remove",onPress:function(){var e;Xe((null==(e=I.login)?void 0:e.user.username)+"@"+I.apiUrl).then((function(){return function(e){return p.a.async((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",pe(e,"DELETE","logins/~current"));case 1:case"end":return t.stop()}}),null,null,null,Promise)}(I)})).then((function(){return B({})}))}},{text:"Keep",style:"default",onPress:function(){Qe(I),B({})}}],{cancelable:!0})},title:"Log Out",color:L.secondaryTint,accessibilityLabel:"Log out of the Hoot network"})),S&&c.a.createElement(Q,{style:vt.editView},c.a.createElement(Z,{style:vt.editViewText,placeholder:"New email"}),c.a.createElement(Z,{style:vt.editViewText,placeholder:"User bio",multiline:!0}),c.a.createElement(Z,{style:vt.editViewText,placeholder:"New password"}),c.a.createElement(Z,{style:vt.editViewText,placeholder:"Confirm new password"}),c.a.createElement(Q,{style:vt.editViewActionButtons},c.a.createElement(rt.a,{onPress:function(){return j(!1)},title:"Cancel",color:L.secondaryTint,accessibilityLabel:"Add profile"}),c.a.createElement(rt.a,{onPress:function(){return F.a.alert("unimplemented")},title:"Submit",color:L.tint,accessibilityLabel:"Add profile"}))),c.a.createElement(rt.a,{onPress:function(){return B({})},title:"Add Profile",color:L.tint,accessibilityLabel:"Add profile"}),y.map((function(e){return[e].concat(Ae()(e.split("@")))})).map((function(e){return[e[0],e[1],e[2].replace("http://","").replace("https://","").split(/[/?#]/)[0]]})).map((function(e){return c.a.createElement(z.a,{key:e[0],style:[vt.altProfileButton,{borderColor:L.secondaryBackground}],onPress:function(){qe(e[0]).then((function(e){void 0!==e&&(B(e),j(!1))}))}},c.a.createElement(De,{name:e[1],host:e[2],local:!0,showHost:"always",colorize:"never",newLine:!0}))})),c.a.createElement(Q,{style:{paddingTop:10}},c.a.createElement(rt.a,{onPress:function(){return o.navigate("NewCommunity")},title:"Create Community",color:L.tint,accessibilityLabel:"Create a new community"})),c.a.createElement(X,{style:vt.followingTitle},"Communities You Follow:"),E.map((function(e){return c.a.createElement(Q,{key:e.id,style:[vt.altProfileButton,{borderColor:L.secondaryBackground}]},c.a.createElement(De,{name:e.name,host:e.host,local:e.local,showHost:"always",colorize:"always",newLine:!0}))})))}var vt=D.a.create({container:{height:"100%"},header:{display:"flex",flexDirection:"row",justifyContent:"space-between",padding:20},title:{fontSize:20,fontWeight:"bold"},followingTitle:{fontSize:18,fontWeight:"500",padding:20},editView:{margin:20},editViewText:{marginBottom:15,paddingVertical:10,paddingHorizontal:15},editViewActionButtons:{display:"flex",flexDirection:"row",justifyContent:"space-around"},separator:{marginVertical:30,height:1,width:"80%"},inputContainer:{width:"100%",padding:20},input:{height:40,borderWidth:1,paddingVertical:10,paddingHorizontal:20,width:"100%",borderRadius:8},altProfileButton:{marginHorizontal:20,paddingVertical:15,borderBottomWidth:1}}),xt=n(110);function wt(e){var t,n=e.navigation,r=e.route,o=Object(l.useState)(r.params.community),i=a()(o,2),s=i[0],u=i[1],m=Object(l.useState)(""),d=a()(m,2),f=d[0],y=d[1],h=Object(l.useState)(""),g=a()(h,2),b=g[0],E=g[1],v=Object(l.useState)(""),x=a()(v,2),w=x[0],O=x[1],S=J(),j=Object(l.useContext)(le).ctx;if(Object(l.useEffect)((function(){return n.addListener("focus",(function(){return r.params.community?u(r.params.community):null===s?u(void 0):void 0}))}),[s,null==s?void 0:s.id,null==(t=r.params.community)?void 0:t.id]),void 0===j.login)return c.a.createElement(st,null);if(null===s)return c.a.createElement(ht,{onSelect:u,onlyWhenTyping:!0});return c.a.createElement(ot.a,{style:{width:"100%",height:"100%"}},c.a.createElement(xt.a,{onPress:function(){return"web"!==L.a.OS&&at.a.dismiss()}},c.a.createElement(Q,{style:Ot.container},c.a.createElement(z.a,{onPress:function(){return u(null)}},s?c.a.createElement(De,{name:s.name,host:s.host,local:s.local,colorize:"always",showHost:"always",newLine:!0,style:Ot.input}):c.a.createElement(X,{style:[Ot.input,{color:S.secondaryText}]},"Select a Community")),c.a.createElement($.a,{style:[Ot.input,Ot.title,{color:S.text}],placeholder:"Add a Title",placeholderTextColor:S.placeholderText,value:f,onChangeText:y}),f.length>=4?c.a.createElement(c.a.Fragment,null,c.a.createElement($.a,{style:[Ot.input,{color:S.text}],placeholder:"Link",placeholderTextColor:S.placeholderText,value:b,onChangeText:E,keyboardType:"url",textContentType:"URL"}),c.a.createElement(Z,{style:{marginVertical:20,minHeight:100},multiline:!0,placeholder:"Add post content",value:w,onChangeText:O})):c.a.createElement(X,{style:{color:S.secondaryText}},f.length>0&&4-f.length),!!s&&f.length>=4&&c.a.createElement(rt.a,{onPress:function(){s&&function(e,t){return p.a.async((function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",pe(e,"POST","posts",t).then((function(e){return e.json()})));case 1:case"end":return n.stop()}}),null,null,null,Promise)}(j,{community:s.id,title:f,href:b||void 0,content_markdown:w||" "}).then((function(e){xe(j,e.id).then((function(e){u(void 0),y(""),E(""),O(""),n.navigate("Post",{post:e})}))})).catch((function(e){return F.a.alert("Could not submit post",e)}))},title:"Submit",color:S.tint,accessibilityLabel:"Submit new post"}))))}var Ot=D.a.create({container:{flex:1,alignItems:"stretch",padding:15,height:"100%",width:"100%"},title:{fontSize:20,fontWeight:"bold"},separator:{marginVertical:30,height:1,width:"80%"},inputContainer:{width:"100%",padding:20},input:{paddingVertical:10,width:"100%",borderRadius:8},item:{paddingHorizontal:20,paddingVertical:10,marginHorizontal:20,marginBottom:1}});function St(){return c.a.createElement(Q,null,c.a.createElement(X,null,"Settings screen. It'll be implemented eventually."))}function jt(e){var t,n=e.navigation,r=e.route,o=Object(l.useState)(r.params.community),i=a()(o,2),s=i[0],u=i[1],m=Me("hot",void 0,s.id),d=a()(m,4),f=d[0],y=d[1],h=d[2],g=d[3],b=Object(l.useState)(0),E=a()(b,2),v=E[0],x=E[1],w=J(),O=Object(l.useContext)(le).ctx;Object(l.useEffect)((function(){he(O,s.id).then(u)}),[r.params.community.id,r.params.community.description,v]);var S=(null==(t=s.your_follow)?void 0:t.accepted)||!1;return c.a.createElement(Q,{style:[Pt.root,{backgroundColor:w.background}]},c.a.createElement(Q,{style:[Pt.header,{borderBottomColor:w.tertiaryBackground}]},c.a.createElement(Q,null,c.a.createElement(X,{style:[Pt.title]},s.name),c.a.createElement(X,{style:{color:s.local?w.blue:w.green,fontWeight:"500"}},s.host),""!==s.description&&c.a.createElement(X,null,"\n",s.description)),c.a.createElement(Q,{style:Pt.buttons},c.a.createElement(rt.a,{onPress:function(){return n.navigate("NewPostScreen",{community:s})},title:"Post",color:w.tint,accessibilityLabel:"Post to this community"}),s.you_are_moderator&&c.a.createElement(rt.a,{onPress:function(){return n.navigate("EditCommunity",{community:s})},title:"Edit",color:w.tint,accessibilityLabel:"Edit your community community"}),S?c.a.createElement(rt.a,{onPress:function(){(function(e,t){return p.a.async((function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",pe(e,"POST","communities/"+t+"/unfollow"));case 1:case"end":return n.stop()}}),null,null,null,Promise)})(O,s.id).then((function(){x((function(e){return e+1}))}))},title:"Unfollow",color:w.secondaryTint,accessibilityLabel:"Stop seeing posts from this community"}):c.a.createElement(rt.a,{onPress:function(){be(O,s.id).then((function(e){!1===e.accepted&&F.a.alert("Follow request rejected.","This could be an issue with the node you are connected to."),x((function(e){return e+1}))}))},title:"Follow",color:w.tint,accessibilityLabel:"See posts from this community in your feed"}))),c.a.createElement(V.a,{data:f,renderItem:function(e){var t=e.item;return c.a.createElement(Tt,{post:t,navigation:n})},keyExtractor:function(e,t){return e.id+"-"+t},refreshing:y,onRefresh:h,onEndReachedThreshold:2,onEndReached:g}))}var Pt=D.a.create({root:{height:"100%"},header:{padding:20,borderBottomWidth:D.a.hairlineWidth||1},title:{fontSize:20},buttons:{paddingTop:10,display:"flex",flexDirection:"row",width:"100%",justifyContent:"space-around",alignItems:"center"},item:{marginVertical:0,marginHorizontal:0,borderBottomWidth:8}}),Tt=function(e){var t=e.post,n=e.navigation,r=J();return c.a.createElement(z.a,{onPress:function(){return n.navigate("Post",{post:t})},onLongPress:function(){oe(ae.a.Heavy)}},c.a.createElement(Q,{style:[Pt.item,{borderBottomColor:r.secondaryBackground}]},c.a.createElement(Ne,{post:t,navigation:n})))},Ct=n(215);function kt(e){var t=e.navigation,n=e.route,r=Object(l.useState)(""),o=a()(r,2),i=o[0],s=o[1],u=Object(l.useRef)(null),m=J(),d=Object(l.useContext)(le).ctx,f=n.params.id,y=n.params.title,h=n.params.html,g=n.params.type;return c.a.createElement(ot.a,{behavior:"ios"===L.a.OS?"padding":"height"},c.a.createElement(Ct.a,{ref:u},c.a.createElement(z.a,{style:zt.root,onPress:function(){return"web"!==L.a.OS&&at.a.dismiss()}},c.a.createElement(X,null,"Reply to ",g),!!y&&c.a.createElement(X,{style:zt.title},y),h&&c.a.createElement(Ie,{contentHtml:h}),c.a.createElement(Z,{style:zt.input,multiline:!0,placeholder:"Type your reply",value:i,onChangeText:s,onFocus:function(){u.current&&u.current.scrollToEnd({animated:!0})}}),c.a.createElement(rt.a,{title:"Submit",color:m.tint,onPress:function(){"post"===g?function(e,t,n){return p.a.async((function(r){for(;;)switch(r.prev=r.next){case 0:return r.abrupt("return",pe(e,"POST","posts/"+t+"/replies",{content_markdown:n}).then((function(e){return e.json()})));case 1:case"end":return r.stop()}}),null,null,null,Promise)}(d,f,i).then((function(){return t.pop()})):function(e,t,n){return p.a.async((function(r){for(;;)switch(r.prev=r.next){case 0:return r.abrupt("return",pe(e,"POST","comments/"+t+"/replies",{content_markdown:n}).then((function(e){return e.json()})));case 1:case"end":return r.stop()}}),null,null,null,Promise)}(d,f,i).then((function(){return t.pop()}))}}))))}var zt=D.a.create({root:{padding:20,paddingBottom:100},title:{fontSize:20,marginVertical:10},input:{marginVertical:20,minHeight:100}}),Lt=n(40),_t=n(107),It=[void 0,function(){}],Bt=c.a.createContext(It);function Ht(e){var t=e.replies,n=e.navigation,r=e.layer,o=void 0===r?0:r,i=e.postId,s=e.replyId,u=e.highlightedReplies,m=void 0===u?[]:u,d=Object(l.useState)(),p=a()(d,2),f=p[0],y=p[1],h=J(),g=Object(l.useContext)(le).ctx,b=[h.text,h.red,h.orange,h.yellow,h.green,h.teal,h.blue,h.indigo,h.purple];return c.a.createElement(Q,null,t.items.map((function(e){return c.a.createElement(Rt,{reply:e,layer:o,key:e.id,navigation:n,layerColors:b,postId:i,highlightedReplies:m})})),null!==t.next_page&&void 0===f&&(i||s)&&c.a.createElement(z.a,{hitSlop:5,onPress:function(){s?Se(g,s,t.next_page||void 0).then(y):i&&Oe(g,i,t.next_page||void 0).then(y)}},c.a.createElement(X,{style:{color:h.tint,paddingTop:5,paddingBottom:10}},"More replies ",c.a.createElement(O.a,{name:"chevron-down-outline"}))),void 0!==f&&c.a.createElement(Ht,{replies:f,navigation:n,layer:o,postId:i,replyId:s,highlightedReplies:m}),null===t.next_page&&0===o&&c.a.createElement(X,{style:{margin:17,color:h.secondaryText}},t.items.length>0?"No more replies":"No replies yet"))}function Rt(e){var t,n=e.reply,r=e.layer,o=void 0===r?0:r,i=e.navigation,s=e.layerColors,u=e.postId,m=e.highlightedReplies,d=void 0===m?[]:m,p=Object(l.useState)(),f=a()(p,2),y=f[0],h=f[1],g=c.a.useState(!0),b=a()(g,2),E=b[0],v=b[1],x=J(),w=Object(l.useContext)(le).ctx,S=Object(l.useContext)(Bt),j=a()(S,2),P=j[0],T=j[1];return c.a.createElement(Q,{style:{paddingLeft:0}},c.a.createElement(Q,{style:{paddingVertical:8,borderTopWidth:.5,borderTopColor:x.secondaryBackground}},c.a.createElement(z.a,{onPress:function(){return T(P!=n.id?n.id:void 0)}},c.a.createElement(Q,{style:{borderLeftWidth:2,borderColor:s[o%s.length],paddingLeft:15,paddingVertical:3,backgroundColor:d.includes(n.id)?x.secondaryBackground:x.background}},c.a.createElement(Q,{style:{display:"flex",flexDirection:"row",justifyContent:"space-between",flexWrap:"wrap",marginBottom:5}},c.a.createElement(De,{name:n.author.username,host:n.author.host,local:n.author.local,showHost:"only_foreign",colorize:"only_foreign",style:{fontSize:16,fontWeight:"500"}}),c.a.createElement(Q,{style:{marginRight:15,display:"flex",flexDirection:"row",alignItems:"center"}},c.a.createElement(X,null,!E&&"...    "),c.a.createElement(O.a,{name:"heart-outline",size:14,color:x.text,light:!0}),c.a.createElement(X,null," "+n.score+"   "),c.a.createElement(te,{time:n.created}))),E&&!!n.content_html&&c.a.createElement(Ie,{contentHtml:n.content_html,contentText:n.content_text})),P==n.id&&c.a.createElement(Q,{style:Dt.buttons},c.a.createElement(Ce,{type:"reply",post:n,isUpvoted:!1,hideCount:!0,style:Dt.button}),c.a.createElement(z.a,{style:Dt.button,onPress:function(){oe(ae.a.Medium),i.navigate("Reply",{id:n.id,title:n.author.username,html:n.content_html,type:"reply"})}},c.a.createElement(O.a,{color:x.text,size:20,name:"arrow-undo-outline"})),c.a.createElement(z.a,{style:Dt.button,onPress:function(){v((function(e){return!e}))}},c.a.createElement(O.a,{color:((null==(t=n.replies)?void 0:t.items.length)||0)>0?x.text:x.secondaryText,size:20,name:E?"chevron-up-outline":"chevron-down-outline"}))))),null!==n.replies?n.replies.items.length>0&&(E?c.a.createElement(Q,{style:{paddingLeft:15}},c.a.createElement(Ht,{replies:n.replies,layer:o+1,navigation:i,postId:u,replyId:n.id,highlightedReplies:d})):c.a.createElement(X,null,"...")):void 0===y&&c.a.createElement(z.a,{hitSlop:5,onPress:function(){Se(w,n.id).then(h)}},c.a.createElement(Q,{style:{paddingHorizontal:15,paddingBottom:10}},c.a.createElement(X,{style:{color:x.tint}},"More replies ",c.a.createElement(O.a,{name:"chevron-forward-outline"})))),void 0!==y&&c.a.createElement(Q,{style:{paddingLeft:15}},c.a.createElement(Ht,{replies:y,navigation:i,layer:o+1,postId:u,replyId:n.id})))}var Dt=D.a.create({buttons:{display:"flex",flexDirection:"row",justifyContent:"flex-end",alignItems:"center",paddingHorizontal:15},button:{padding:10,paddingHorizontal:15}});function Vt(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Wt(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Vt(Object(n),!0).forEach((function(t){m()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Vt(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function Nt(e){var t=e.navigation,n=e.route,r=n.params.post,o=Object(l.useState)(n.params.highlightedReplies),i=a()(o,2),s=i[0],u=i[1],m=Object(l.useState)(0),d=a()(m,2),f=d[0],y=d[1],h=Object(l.useState)(),g=a()(h,2),b=g[0],E=g[1],v=function(e,t,n,r){var o=Object(l.useState)({items:[]}),i=a()(o,2),c=i[0],s=i[1];return Object(l.useEffect)((function(){r?we(e,r).then((function(t){return p.a.async((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,p.a.awrap(Se(e,t.id));case 2:t.replies=n.sent,s({items:[t],next_page:null});case 4:case"end":return n.stop()}}),null,null,null,Promise)})):Oe(e,t).then((function(e){s(e)}))}),n),c}(Object(l.useContext)(le).ctx,r.id,[f,null==s?void 0:s.join(",")],null==s?void 0:s[0]),x=J();return Object(l.useEffect)((function(){return t.addListener("focus",(function(){return y((function(e){return e+1}))}))}),[]),c.a.createElement(Ge.a,null,c.a.createElement(Q,{style:Wt(Wt({},Ft.item),{},{backgroundColor:x.background})},c.a.createElement(Ne,{post:r,navigation:t,showHtmlContent:!0,showAuthor:!0}),c.a.createElement(Q,{style:Ft.actions},c.a.createElement(O.a,{name:"bookmark-outline",size:25,color:x.text}),c.a.createElement(z.a,{hitSlop:5,onPress:function(){oe(ae.a.Medium),t.navigate("Reply",{id:r.id,title:r.title,html:r.content_html,type:"post"})}},c.a.createElement(O.a,{name:"arrow-undo-outline",size:25,color:x.text})),c.a.createElement(z.a,{hitSlop:5,onPress:function(){oe(ae.a.Medium),_t.a.share({message:r.title,url:"https://dev.goldandblack.xyz/p/posts/"+r.id,title:"Hoot"})}},c.a.createElement(O.a,{name:"share-outline",size:25,color:x.text}))),s&&c.a.createElement(z.a,{onPress:function(){return u(void 0)}},c.a.createElement(X,{style:{color:x.tint,paddingVertical:10}},"Show all replies")),c.a.createElement(Bt.Provider,{value:[b,E]},c.a.createElement(Ht,{replies:v,navigation:t,postId:r.id,highlightedReplies:s})),c.a.createElement(Q,{style:{height:300}})))}var Ft=D.a.create({container:{flex:1,marginTop:Lt.a.currentHeight||0},item:{marginVertical:0,marginHorizontal:0},title:{fontSize:20,padding:15},contentText:{fontSize:12},link:{paddingVertical:10,paddingHorizontal:15,backgroundColor:"#8884",borderRadius:5,marginHorizontal:15},image:{width:"100%",height:void 0,resizeMode:"contain"},foot:{display:"flex",flexDirection:"row",justifyContent:"space-between",alignItems:"center",width:"100%",padding:15,borderBottomColor:"#8884",borderBottomWidth:2},by:{fontSize:11},actions:{display:"flex",flexDirection:"row",justifyContent:"space-around",alignItems:"center",padding:10}}),Ut=n(71);function At(e){var t=e.navigation;return l.createElement(G.a,{style:Mt.container},l.createElement(M.a,{style:Mt.title},"This screen doesn't exist."),l.createElement(Ut.a,{onPress:function(){return t.replace("Root")},style:Mt.link},l.createElement(M.a,{style:Mt.linkText},"Go to home screen!")))}var Mt=D.a.create({container:{flex:1,backgroundColor:"#fff",alignItems:"center",justifyContent:"center",padding:20},title:{fontSize:20,fontWeight:"bold"},link:{marginTop:15,paddingVertical:15},linkText:{fontSize:14,color:"#2e78b7"}});function Gt(e,t){var n;return p.a.async((function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,p.a.awrap(we(e,t));case 2:return n=r.sent,r.abrupt("return",{type:"comment",id:t,content_text:n.content_text,content_html:n.content_html,author:n.author});case 4:case"end":return r.stop()}}),null,null,null,Promise)}function $t(e){return p.a.async((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",{type:"post",id:e.id,content_text:e.title,author:e.author});case 1:case"end":return t.stop()}}),null,null,null,Promise)}function Jt(e){var t=e.navigation,n=Object(l.useState)([]),r=a()(n,2),o=r[0],i=r[1],s=Object(l.useState)(!0),u=a()(s,2),m=u[0],d=u[1],f=Object(l.useState)(0),y=a()(f,2),h=y[0],g=y[1],b=J(),E=Object(l.useContext)(le).ctx;if(Object(l.useEffect)((function(){E.login&&function(e){return p.a.async((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",pe(e,"GET","users/~me/notifications").then((function(e){return e.json()})));case 1:case"end":return t.stop()}}),null,null,null,Promise)}(E).then((function(e){var t=e.map((function(e){return function(e,t){var n,r,a;return p.a.async((function(o){for(;;)switch(o.prev=o.next){case 0:if(n=xe(e,t.post.id),!t.comment){o.next=5;break}o.t0=Gt(e,t.comment),o.next=10;break;case 5:return o.t1=$t,o.next=8,p.a.awrap(n);case 8:o.t2=o.sent,o.t0=(0,o.t1)(o.t2);case 10:return r=o.t0,o.next=13,p.a.awrap(we(e,t.reply.id));case 13:return a=o.sent,o.t3=t.unseen,o.t4={id:a.id,content_text:a.content_text,content_html:a.content_html,author:a.author},o.next=18,p.a.awrap(r);case 18:return o.t5=o.sent,o.next=21,p.a.awrap(n);case 21:return o.t6=o.sent,o.abrupt("return",{unseen:o.t3,reply:o.t4,origin:o.t5,post:o.t6});case 23:case"end":return o.stop()}}),null,null,null,Promise)}(E,e)}));Promise.all(t).then(i).then((function(){return d(!1)}))}))}),[h]),Object(l.useEffect)((function(){return t.addListener("focus",(function(){return g((function(e){return e+1}))}))}),[]),!E.login)return c.a.createElement(st,null);return c.a.createElement(V.a,{style:Kt.container,data:o,renderItem:function(e){var n=e.item;return c.a.createElement(z.a,{style:[Kt.item,{borderColor:b.secondaryBackground}],onPress:function(){var e="comment"===n.origin.type?[n.origin.id,n.reply.id]:[n.reply.id];t.navigate("Post",{post:n.post,highlightedReplies:e})}},c.a.createElement(X,{style:Kt.name},n.post.author.username),c.a.createElement(X,{style:Kt.title},n.post.title),c.a.createElement(X,null,"In"," ",c.a.createElement(De,{name:n.post.community.name,host:n.post.community.host,local:n.post.community.local,showHost:"always",colorize:"never"})),"comment"===n.origin.type?c.a.createElement(c.a.Fragment,null,c.a.createElement(Q,{style:[Kt.level1,{borderColor:b.secondaryText}]},c.a.createElement(X,{style:Kt.name},n.origin.author.username),c.a.createElement(Ie,{contentHtml:n.origin.content_html,contentText:n.origin.content_text})),c.a.createElement(Q,{style:[Kt.level2,{borderColor:b.tint}]},c.a.createElement(X,{style:Kt.name},n.reply.author.username),c.a.createElement(Ie,{contentHtml:n.reply.content_html,contentText:n.reply.content_text}))):c.a.createElement(c.a.Fragment,null,c.a.createElement(Q,{style:[Kt.level1,{borderColor:b.tint}]},c.a.createElement(X,{style:Kt.name},n.reply.author.username),c.a.createElement(Ie,{contentHtml:n.reply.content_html,contentText:n.reply.content_text}))))},keyExtractor:function(e,t){return e.reply.id+"-"+t},refreshing:m,onRefresh:function(){d(!0),g((function(e){return e+1}))}})}var Kt=D.a.create({container:{flex:1},item:{borderBottomWidth:5,padding:15},title:{fontSize:20,fontWeight:"bold"},level1:{marginTop:5,borderLeftWidth:2,paddingLeft:15,padding:5},level2:{marginTop:5,marginLeft:15,borderLeftWidth:2,paddingLeft:15,padding:5},name:{fontWeight:"600",marginBottom:3},thin:{fontWeight:"200"}});function qt(e){var t=e.navigation,n=Object(l.useState)(""),r=a()(n,2),o=r[0],i=r[1],s=Object(l.useState)(""),u=a()(s,2),m=u[0],d=u[1],f=J(),y=Object(l.useContext)(le).ctx;return c.a.createElement(Q,{style:Yt.root},c.a.createElement($.a,{style:[Yt.input,{fontSize:20,color:f.text}],placeholder:"Community Name",value:o,onChangeText:i}),o.length>=4?c.a.createElement(c.a.Fragment,null,c.a.createElement($.a,{style:[Yt.input,{color:f.text}],placeholder:"Description (Optional)",value:m,onChangeText:d}),c.a.createElement(rt.a,{title:"Submit",color:f.tint,onPress:function(){(function(e,t){return p.a.async((function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",pe(e,"POST","communities",{name:t}).then((function(e){return e.json()})));case 1:case"end":return n.stop()}}),null,null,null,Promise)})(y,o).then((function(e){var n,r;return p.a.async((function(a){for(;;)switch(a.prev=a.next){case 0:if(n=e.community.id,!m){a.next=4;break}return a.next=4,p.a.awrap(Ee(y,n,m));case 4:return a.next=6,p.a.awrap(be(y,n));case 6:return a.next=8,p.a.awrap(he(y,n));case 8:r=a.sent,t.replace("Community",{community:r});case 10:case"end":return a.stop()}}),null,null,null,Promise)})).catch((function(e){return F.a.alert("Failed to create community",e)}))},accessibilityLabel:"Create new community"})):c.a.createElement(X,null,o.length>0&&4-o.length))}var Yt=D.a.create({root:{flex:1,alignItems:"flex-start",padding:15,height:"100%",width:"100%"},title:{fontSize:20,fontWeight:"bold"},separator:{marginVertical:30,height:1,width:"80%"},inputContainer:{width:"100%",padding:20},input:{paddingVertical:10,width:"100%",borderRadius:8},item:{paddingHorizontal:20,paddingVertical:10,marginHorizontal:20,marginBottom:1}});function Xt(e){var t=e.navigation,n=e.route,r=Object(l.useState)(!1),o=a()(r,2),i=o[0],s=o[1],u=Object(l.useState)(""),m=a()(u,2),d=m[0],f=m[1],y=Object(l.useState)(),h=a()(y,2),g=h[0],b=h[1],E=Object(l.useState)(""),v=a()(E,2),x=v[0],w=v[1],O=J();return c.a.createElement(z.a,{style:{flex:1},onPress:function(){return"web"!==L.a.OS&&at.a.dismiss()}},c.a.createElement(ot.a,{style:Qt.root,behavior:"padding"},c.a.createElement(z.a,null,c.a.createElement(X,null,n.params.node)),i?c.a.createElement(c.a.Fragment,null,g?c.a.createElement(c.a.Fragment,null,c.a.createElement(Z,{placeholder:"New Password",style:Qt.input,value:x,onChangeText:w,autoCapitalize:"none",secureTextEntry:!0,textContentType:"password",autoCompleteType:"password"}),c.a.createElement(Q,{style:Qt.actionButtons},c.a.createElement(rt.a,{title:"Go Back",onPress:function(){return s(!1)},color:O.secondaryTint}),c.a.createElement(rt.a,{title:"Submit",onPress:function(){return x?g?void(e={apiUrl:"https://"+n.params.node+"/api/unstable"},r=g,a=x,p.a.async((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",pe(e,"POST","forgot_password/keys/"+r+"/reset",{new_password:a},!0));case 1:case"end":return t.stop()}}),null,null,null,Promise)).then((function(){return t.popToTop()})):F.a.alert("No key","Fail. This shouldn't happen"):F.a.alert("Password required");var e,r,a},color:O.tint}))):c.a.createElement(Z,{placeholder:"Key",style:Qt.input,onChangeText:function(e){e.length<6||function(e,t){return p.a.async((function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",pe(e,"GET","forgot_password/keys/"+t,void 0,!0));case 1:case"end":return n.stop()}}),null,null,null,Promise)}({apiUrl:"https://"+n.params.node+"/api/unstable"},e).then((function(){return b(e)}))},autoCapitalize:"none"})):c.a.createElement(c.a.Fragment,null,c.a.createElement(Z,{style:Qt.input,placeholder:"Email Address",value:d,onChangeText:f,keyboardType:"email-address",textContentType:"emailAddress",autoCompleteType:"email",returnKeyType:"go",autoCapitalize:"none"}),c.a.createElement(rt.a,{title:"Submit",onPress:function(){if(!d)return F.a.alert("Email address required","An email with a password reset key will be emailed to you");(function(e,t){return p.a.async((function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",pe(e,"POST","forgot_password/keys",{email_address:t},!0));case 1:case"end":return n.stop()}}),null,null,null,Promise)})({apiUrl:"https://"+n.params.node+"/api/unstable"},d).then((function(){s(!0)})).catch((function(e){return F.a.alert("Failed to send reset key",e)}))},color:O.tint}))))}var Qt=D.a.create({root:{flex:1,alignItems:"center",justifyContent:"center",padding:30},input:{width:"100%",paddingVertical:10,paddingHorizontal:15,marginTop:15},actionButtons:{display:"flex",width:"100%",flexDirection:"row",justifyContent:"space-around"}});function Zt(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function en(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Zt(Object(n),!0).forEach((function(t){m()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Zt(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function tn(e){var t=e.navigation,n=e.route.params.community,r=Object(l.useState)(n.description||""),o=a()(r,2),i=o[0],s=o[1],u=J(),m=Object(l.useContext)(le).ctx;return c.a.createElement(ot.a,{behavior:"ios"===L.a.OS?"padding":"height"},c.a.createElement(z.a,{style:nn.root,onPress:function(){return"web"!==L.a.OS&&at.a.dismiss()}},c.a.createElement(De,{name:n.name,host:n.host,local:n.local,showHost:"always",newLine:!0,style:nn.title}),c.a.createElement(Z,{style:nn.input,multiline:!0,placeholder:"Add a description",value:i,onChangeText:s}),c.a.createElement(rt.a,{title:"Submit",color:u.tint,onPress:function(){Ee(m,n.id,i).then((function(){return he(m,n.id)})).then((function(e){return t.navigate("Community",{community:en(en({},e),{},{description:i})})})).catch((function(e){return F.a.alert("Failed to edit community",e)}))}})))}var nn=D.a.create({root:{padding:20,paddingBottom:100},title:{fontSize:20,marginVertical:10},input:{marginVertical:20,minHeight:100}});function rn(e){var t=e.colorScheme;return c.a.createElement(j.a,{linking:R,theme:"dark"===t?P.a:T.a},c.a.createElement(on,null))}var an=Object(C.a)();function on(){return c.a.createElement(an.Navigator,null,c.a.createElement(an.Screen,{name:"Root",component:cn,options:{headerShown:!1}}),c.a.createElement(an.Screen,{name:"Web",component:Nt}),c.a.createElement(an.Screen,{name:"Post",component:Nt}),c.a.createElement(an.Screen,{name:"Reply",component:kt}),c.a.createElement(an.Screen,{name:"Community",component:jt}),c.a.createElement(an.Screen,{name:"NewCommunity",component:qt}),c.a.createElement(an.Screen,{name:"EditCommunity",component:tn}),c.a.createElement(an.Screen,{name:"Settings",component:St}),c.a.createElement(an.Screen,{name:"ForgotPassword",component:Xt,options:{title:"Forgot Password"}}),c.a.createElement(an.Screen,{name:"NotFound",component:At,options:{title:"Oops!"}}),c.a.createElement(an.Group,{screenOptions:{presentation:"modal"}},c.a.createElement(an.Screen,{name:"Modal",component:Nt})))}var ln=Object(S.a)();function cn(e){var t=e.navigation,n=Object(l.useState)("hot"),r=a()(n,2),o=r[0],i=r[1],s=v();return c.a.createElement(ln.Navigator,{initialRouteName:"FeedScreen",screenOptions:{tabBarActiveTintColor:I[s].tint,tabBarShowLabel:!1}},c.a.createElement(ln.Screen,{name:"FeedScreen",component:pt,initialParams:{sort:o},options:function(e){var t=e.navigation;return{title:"Hoot",tabBarIcon:function(e){var t=e.color;return c.a.createElement(sn,{name:"newspaper-outline",color:t})},headerRight:function(){return c.a.createElement(z.a,{onPress:function(){k.ActionSheetIOS.showActionSheetWithOptions({options:["Cancel","Hot","New"],title:"Sort by:",cancelButtonIndex:0},(function(e){var n=[o,"hot","new"][e];i(n),t.navigate("FeedScreen",{sort:n})}))},style:function(e){return{opacity:e.pressed?.5:1}}},c.a.createElement(O.a,{name:{hot:"flame-outline",new:"time-outline"}[o],size:25,color:I[s].tint,style:{marginRight:15}}))}}}}),c.a.createElement(ln.Screen,{name:"SearchScreen",component:bt,options:{title:"Communities",tabBarIcon:function(e){var t=e.color;return c.a.createElement(sn,{name:"search-outline",color:t})}}}),c.a.createElement(ln.Screen,{name:"NewPostScreen",component:wt,initialParams:{community:void 0},options:{title:"New Post",tabBarIcon:function(e){var t=e.color;return c.a.createElement(sn,{name:"add-outline",color:t,size:40})}}}),c.a.createElement(ln.Screen,{name:"NotificationScreen",component:Jt,options:{title:"Notifications",tabBarIcon:function(e){var t=e.color;return c.a.createElement(sn,{name:"notifications-outline",color:t})}}}),c.a.createElement(ln.Screen,{name:"ProfileScreen",component:Et,options:{title:"Profile",tabBarIcon:function(e){var t=e.color;return c.a.createElement(sn,{name:"person-circle-outline",color:t})},headerLeft:function(){return c.a.createElement(z.a,{onPress:function(){t.navigate("Settings")},style:function(e){return{opacity:e.pressed?.5:1}}},c.a.createElement(O.a,{name:"cog-outline",size:25,color:I[s].secondaryText,style:{marginLeft:15}}))}}}))}function sn(e){return c.a.createElement(O.a,w()({size:30,style:{marginBottom:-3}},e))}var un=Object(se.a)({reducer:{vote:de}});function mn(){var e=function(){var e=l.useState(!1),t=a()(e,2),r=t[0],o=t[1];return l.useEffect((function(){p.a.async((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,h.b(),e.next=4,p.a.awrap(y.b(b(b({},f.a.font),{},{"space-mono":n(241)})));case 4:e.next=9;break;case 6:e.prev=6,e.t0=e.catch(0),console.warn(e.t0);case 9:return e.prev=9,o(!0),h.a(),e.finish(9);case 13:case"end":return e.stop()}}),null,null,[[0,6,9,13]],Promise)}),[]),r}(),t=v(),r=Object(l.useState)(ie),u=a()(r,2),m=u[0],d=u[1];function g(e){Ke(e).then((function(){return o.a.setItem("@lotide_ctx",JSON.stringify(e))})).then((function(){return d(e)}))}return Object(l.useEffect)((function(){Je().then((function(e){void 0!==e&&d(e)}))}),[]),Object(l.useEffect)((function(){m.apiUrl&&(ve(m).then((function(e){if(console.log(e),!e.software.version.startsWith("0.9."))throw"Bad version"})).catch((function(){var e;Xe((null==(e=m.login)?void 0:e.user.username)+"@"+m.apiUrl).then((function(){return g({})}))})),m.login&&ge(m,m.login.user.id).catch((function(){var e;Xe((null==(e=m.login)?void 0:e.user.username)+"@"+m.apiUrl).then((function(){return g({})}))})))}),[m]),e?c.a.createElement(ce.a,{store:un},c.a.createElement(le.Provider,{value:{ctx:m,setContext:function(e){return g(e)}}},c.a.createElement(s.b,null,c.a.createElement(rn,{colorScheme:t}),c.a.createElement(i.a,null)))):null}},222:function(e,t,n){e.exports=n(305)},241:function(e,t,n){e.exports=n.p+"./fonts/SpaceMono-Regular.ttf"},257:function(e,t){}},[[222,1,2]]]);
//# sourceMappingURL=app.ccc26a9b.chunk.js.map